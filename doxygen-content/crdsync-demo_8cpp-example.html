<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ADK-Programmers-Guides: crdsync-demo.cpp</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="verifone.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="verifonelogo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ADK-Programmers-Guides
   &#160;<span id="projectnumber">5.0.3-CD1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('crdsync-demo_8cpp-example.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">crdsync-demo.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>This is an example how to use ADK-CRD-SYNC</p>
<div class="fragment"><div class="line"><span class="comment">/****************************************************************************</span></div>
<div class="line"><span class="comment"> *  Product:     ADK-CRD-SYNC</span></div>
<div class="line"><span class="comment"> *  Company:     VeriFone</span></div>
<div class="line"><span class="comment"> *  Author:      GSS R&amp;D Germany</span></div>
<div class="line"><span class="comment"> *  Content:     Terminal Test Application</span></div>
<div class="line"><span class="comment"> ****************************************************************************/</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;string.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdarg.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;signal.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &quot;pthread.h&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="crdsync_8h.html">crdsync.h</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define UNUSED(x) (void) x</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define MENU &quot;ADK-CRD-SYNC testapp:\n\</span></div>
<div class="line"><span class="preprocessor">1 Open\n\</span></div>
<div class="line"><span class="preprocessor">2 IsCardPresent\n\</span></div>
<div class="line"><span class="preprocessor">3 PowerUp AT24C01SC\n\</span></div>
<div class="line"><span class="preprocessor">4 PowerUp AT24C02SC\n\</span></div>
<div class="line"><span class="preprocessor">5 PowerUp AT24C04SC\n\</span></div>
<div class="line"><span class="preprocessor">6 PowerUp AT24C08SC\n\</span></div>
<div class="line"><span class="preprocessor">7 PowerUp AT24C10SC\n\</span></div>
<div class="line"><span class="preprocessor">8 PowerUp ST14C02SC\n\</span></div>
<div class="line"><span class="preprocessor">9 WriteData 12345678\n\</span></div>
<div class="line"><span class="preprocessor">a WriteData 99999999\n\</span></div>
<div class="line"><span class="preprocessor">b ReadData\n\</span></div>
<div class="line"><span class="preprocessor">c PowerDown\n\</span></div>
<div class="line"><span class="preprocessor">d Close\n\</span></div>
<div class="line"><span class="preprocessor">0 Exit\n\n&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define TRACE(str) printf(&quot;%s&quot;, str);</span></div>
<div class="line"><span class="preprocessor">#define sleep_ms(a) usleep(1000*a);</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define CRDSYNC_DBG(format, ...) { trace(&quot;CRD-SYNC-TEST: &quot;); trace(format, ## __VA_ARGS__); trace(&quot;\n&quot;); }</span></div>
<div class="line"><span class="preprocessor">#define CRDSYNC_DBG_BYTES(format, data, len, ...) { int i; trace(&quot;CRD-SYNC-TEST: &quot;); trace(format, ## __VA_ARGS__); for (i = 0; i &lt; len; i++) trace(&quot;%02x &quot;, data[i]); trace(&quot;\n&quot;); }</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> pthread_mutex_t traceMutex = PTHREAD_MUTEX_INITIALIZER;</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> trace(<span class="keyword">const</span> <span class="keywordtype">char</span> *format, ...);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *return_table[] = {</div>
<div class="line">        <span class="stringliteral">&quot;CRDSYNC_Success&quot;</span>,</div>
<div class="line">        <span class="stringliteral">&quot;CRDSYNC_Failure&quot;</span>,</div>
<div class="line">        <span class="stringliteral">&quot;CRDSYNC_Error_Power_Action&quot;</span>,</div>
<div class="line">        <span class="stringliteral">&quot;CRDSYNC_Error_Not_Supported&quot;</span>,</div>
<div class="line">        <span class="stringliteral">&quot;CRDSYNC_Error_BadParam&quot;</span>,</div>
<div class="line">        <span class="stringliteral">&quot;CRDSYNC_Error_Protocol&quot;</span></div>
<div class="line">};</div>
<div class="line"><span class="keyword">static</span> <span class="keyword">const</span> <span class="keywordtype">char</span> *mapReturn(<a class="code" href="crdsync_8h.html#af21f57a16d031a8c4583bf2a77834301">CRDSYNC_RET</a> r)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordflow">if</span>(r &lt; 0 || (<span class="keywordtype">unsigned</span>)r &gt;= <span class="keyword">sizeof</span>(return_table)/<span class="keyword">sizeof</span>(<span class="keywordtype">char</span>*))</div>
<div class="line">        <span class="keywordflow">return</span> <span class="stringliteral">&quot;unknown&quot;</span>;</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">        <span class="keywordflow">return</span> return_table[r];</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> callbackfunctionAtExit(<span class="keywordtype">int</span> signal)</div>
<div class="line">{</div>
<div class="line">    signal = 0;</div>
<div class="line">    exit(signal);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> traceCallback(<span class="keyword">const</span> <span class="keywordtype">char</span> *<a name="a0"></a><a class="code" href="namespacevficom_1_1cmdparam_1_1in_1_1ussd__write.html#aa2ad567d2728772e7ce46242b9f5e83a">str</a>, <span class="keywordtype">void</span> *data)</div>
<div class="line">{</div>
<div class="line">    UNUSED(data);</div>
<div class="line">    trace(<span class="stringliteral">&quot;ADK-CRD-SYNC: &quot;</span>);</div>
<div class="line">    trace(<a class="code" href="namespacevficom_1_1cmdparam_1_1in_1_1ussd__write.html#aa2ad567d2728772e7ce46242b9f5e83a">str</a>);</div>
<div class="line">    trace(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a name="a1"></a><a class="code" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div>
<div class="line">{</div>
<div class="line">    <a class="code" href="crdsync_8h.html#af21f57a16d031a8c4583bf2a77834301">CRDSYNC_RET</a> ret;</div>
<div class="line">    <span class="keywordtype">int</span> key = 0xFF;</div>
<div class="line">    <span class="keywordtype">int</span> c;</div>
<div class="line"> </div>
<div class="line">    UNUSED(argc);</div>
<div class="line">    UNUSED(argv);</div>
<div class="line"> </div>
<div class="line">    signal(SIGTERM, callbackfunctionAtExit);</div>
<div class="line">    <a name="a2"></a><a class="code" href="crdsync_8h.html#a3d9902893c6348c09d6d70f20b0a13b2">crdSync_SetTraceCallback</a>(traceCallback,NULL);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">char</span> vers[64];</div>
<div class="line">    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> len = <span class="keyword">sizeof</span>(vers);</div>
<div class="line">    <a name="a3"></a><a class="code" href="crdsync_8h.html#aad6e42b9b4a77a320b963da0d9ebd455">crdSync_Version</a>(vers,len);</div>
<div class="line">    CRDSYNC_DBG(<span class="stringliteral">&quot;CRD-SYNC library version: %s&quot;</span>,vers);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">while</span> (key != 0)</div>
<div class="line">    {</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> AtrBuf[256];</div>
<div class="line">        <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> AtrLen = 255;</div>
<div class="line">        printf(<span class="stringliteral">&quot;\n\n%s&quot;</span>, MENU);</div>
<div class="line">        c = getc(stdin);</div>
<div class="line">        printf(<span class="stringliteral">&quot;\n\n&quot;</span>);</div>
<div class="line">        key = c - <span class="charliteral">&#39;1&#39;</span> + 1;</div>
<div class="line">        <span class="keywordflow">while</span> (c != <span class="charliteral">&#39;\n&#39;</span> &amp;&amp; c != EOF)</div>
<div class="line">            c = getc(stdin);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> ((key &gt;= 1 &amp;&amp; key &lt;= 9) || (key &gt; 48 &amp;&amp; key &lt; 53))</div>
<div class="line">        {</div>
<div class="line">            <span class="keywordflow">switch</span> (key) {</div>
<div class="line">                <span class="keywordflow">case</span> 0x01:</div>
<div class="line">                    ret = <a name="a4"></a><a class="code" href="crdsync_8h.html#af2e8b408142c3fdf772936352aaec87a">crdSync_Open</a>(0);</div>
<div class="line">                    CRDSYNC_DBG(<span class="stringliteral">&quot;Open(0): %d (%s)&quot;</span>, ret, mapReturn(ret));</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> 0x02:</div>
<div class="line">                    ret = <a name="a5"></a><a class="code" href="crdsync_8h.html#a0337406ca951ed912c718448567f0c86">crdSync_IsCardPresent</a>();</div>
<div class="line">                    CRDSYNC_DBG(<span class="stringliteral">&quot;crdSync_IsCardPresent(): %d (%s)&quot;</span>, ret, mapReturn(ret));</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> 0x03:</div>
<div class="line">                    ret = <a name="a6"></a><a class="code" href="crdsync_8h.html#a54f538cdfe50976653de0ed7550a716b">crdSync_PowerUp</a>(<a name="a7"></a><a class="code" href="crdsync_8h.html#a0498c6b5a79796abfb55dc0b9b2037c2">CRDSYNC_CARDTYPE_AT24C01SC</a>, AtrBuf, &amp;AtrLen);</div>
<div class="line">                    CRDSYNC_DBG(<span class="stringliteral">&quot;crdSync_PowerUp(CRDSYNC_CARDTYPE_AT24C01SC): %d (%s)&quot;</span>, ret, mapReturn(ret));</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> 0x04:</div>
<div class="line">                    ret = <a class="code" href="crdsync_8h.html#a54f538cdfe50976653de0ed7550a716b">crdSync_PowerUp</a>(<a name="a8"></a><a class="code" href="crdsync_8h.html#a0275ae827d5612fc02a2390754ab1ce6">CRDSYNC_CARDTYPE_AT24C02SC</a>, AtrBuf, &amp;AtrLen);</div>
<div class="line">                    CRDSYNC_DBG(<span class="stringliteral">&quot;crdSync_PowerUp(CRDSYNC_CARDTYPE_AT24C02SC): %d (%s)&quot;</span>, ret, mapReturn(ret));</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> 0x05:</div>
<div class="line">                    ret = <a class="code" href="crdsync_8h.html#a54f538cdfe50976653de0ed7550a716b">crdSync_PowerUp</a>(<a name="a9"></a><a class="code" href="crdsync_8h.html#aedf79d2acabae0e89c9f627faeed61e2">CRDSYNC_CARDTYPE_AT24C04SC</a>, AtrBuf, &amp;AtrLen);</div>
<div class="line">                    CRDSYNC_DBG(<span class="stringliteral">&quot;crdSync_PowerUp(CRDSYNC_CARDTYPE_AT24C04SC): %d (%s)&quot;</span>, ret, mapReturn(ret));</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> 0x06:</div>
<div class="line">                    ret = <a class="code" href="crdsync_8h.html#a54f538cdfe50976653de0ed7550a716b">crdSync_PowerUp</a>(<a name="a10"></a><a class="code" href="crdsync_8h.html#abc73a9cc90b40c139244436baefd48b7">CRDSYNC_CARDTYPE_AT24C08SC</a>, AtrBuf, &amp;AtrLen);</div>
<div class="line">                    CRDSYNC_DBG(<span class="stringliteral">&quot;crdSync_PowerUp(CRDSYNC_CARDTYPE_AT24C08SC): %d (%s)&quot;</span>, ret, mapReturn(ret));</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> 0x07:</div>
<div class="line">                    ret = <a class="code" href="crdsync_8h.html#a54f538cdfe50976653de0ed7550a716b">crdSync_PowerUp</a>(<a name="a11"></a><a class="code" href="crdsync_8h.html#a101ac06486cf501d08af0213a9f91674">CRDSYNC_CARDTYPE_AT24C16SC</a>, AtrBuf, &amp;AtrLen);</div>
<div class="line">                    CRDSYNC_DBG(<span class="stringliteral">&quot;crdSync_PowerUp(CRDSYNC_CARDTYPE_AT24C16SC): %d (%s)&quot;</span>, ret, mapReturn(ret));</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> 0x08:</div>
<div class="line">                    ret = <a class="code" href="crdsync_8h.html#a54f538cdfe50976653de0ed7550a716b">crdSync_PowerUp</a>(<a name="a12"></a><a class="code" href="crdsync_8h.html#a80ebd75ac4813946bf8dec804f90078a">CRDSYNC_CARDTYPE_ST14C02SC</a>, AtrBuf, &amp;AtrLen);</div>
<div class="line">                    CRDSYNC_DBG(<span class="stringliteral">&quot;crdSync_PowerUp(CRDSYNC_CARDTYPE_ST14C02SC): %d (%s)&quot;</span>, ret, mapReturn(ret));</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                <span class="keywordflow">case</span> 0x09:</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> TxBuf[]=<span class="stringliteral">&quot;12345678&quot;</span>;</div>
<div class="line">                    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> TxLen = <span class="keyword">sizeof</span>(TxBuf);</div>
<div class="line">                    ret = <a name="a13"></a><a class="code" href="crdsync_8h.html#a74d8a2a3fedd23009bdbb24d34883b86">crdSync_WriteData</a>(32,TxBuf,TxLen);</div>
<div class="line">                    CRDSYNC_DBG(<span class="stringliteral">&quot;crdSync_WriteData(12345678): %d (%s)&quot;</span>, ret, mapReturn(ret));</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">case</span> 49:</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> TxBuf[]=<span class="stringliteral">&quot;99999999&quot;</span>;</div>
<div class="line">                    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> TxLen = <span class="keyword">sizeof</span>(TxBuf);</div>
<div class="line">                    ret = <a class="code" href="crdsync_8h.html#a74d8a2a3fedd23009bdbb24d34883b86">crdSync_WriteData</a>(32,TxBuf,TxLen);</div>
<div class="line">                    CRDSYNC_DBG(<span class="stringliteral">&quot;crdSync_WriteData(99999999): %d (%s)&quot;</span>, ret, mapReturn(ret));</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">case</span> 50:</div>
<div class="line">                {</div>
<div class="line">                    <span class="keywordtype">unsigned</span> <span class="keywordtype">char</span> RxBuf[64]={0};</div>
<div class="line">                    <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> RxLen = <span class="keyword">sizeof</span>(RxBuf);</div>
<div class="line">                    ret = <a name="a14"></a><a class="code" href="crdsync_8h.html#afbd3dd4039b9bf6429ed7ea88d90826d">crdSync_ReadData</a>(32,RxBuf,RxLen);</div>
<div class="line">                    CRDSYNC_DBG(<span class="stringliteral">&quot;crdSync_ReadData(): %d (%s)&quot;</span>, ret, mapReturn(ret));</div>
<div class="line">                    CRDSYNC_DBG_BYTES(<span class="stringliteral">&quot;Read Data: &quot;</span>,RxBuf,RxLen);</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">case</span> 51:</div>
<div class="line">                {</div>
<div class="line">                    ret = <a name="a15"></a><a class="code" href="crdsync_8h.html#aa210b9d21f89580090da29bf7b9de69d">crdSync_PowerDown</a>();</div>
<div class="line">                    CRDSYNC_DBG(<span class="stringliteral">&quot;crdSync_PowerDown(): %d (%s)&quot;</span>, ret, mapReturn(ret));</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">case</span> 52:</div>
<div class="line">                {</div>
<div class="line">                    ret = <a name="a16"></a><a class="code" href="crdsync_8h.html#a6f7218a5eddce4c7a642d1c020192934">crdSync_Close</a>(0);</div>
<div class="line">                    CRDSYNC_DBG(<span class="stringliteral">&quot;crdSync_Close(): %d (%s)&quot;</span>, ret, mapReturn(ret));</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">default</span>:</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">void</span> trace(<span class="keyword">const</span> <span class="keywordtype">char</span> *format, ...)</div>
<div class="line">{</div>
<div class="line">    <span class="keywordtype">int</span> <a name="a17"></a><a class="code" href="namespacevficom_1_1cmdparam_1_1in_1_1ping.html#ae0d180616fe53dddd61f70c62526b0db">size</a> = 128;</div>
<div class="line">    <span class="keywordtype">int</span> len = 0;</div>
<div class="line">    <span class="keywordtype">char</span> *buf = NULL;</div>
<div class="line">    <span class="keywordtype">char</span> *bufr = NULL;</div>
<div class="line">    va_list arg;</div>
<div class="line">    <span class="keywordtype">char</span> save;</div>
<div class="line">    <span class="keywordtype">char</span> *ptr;</div>
<div class="line"> </div>
<div class="line">    pthread_mutex_lock(&amp;traceMutex);</div>
<div class="line"> </div>
<div class="line">    buf = (<span class="keywordtype">char</span> *) malloc(<a class="code" href="namespacevficom_1_1cmdparam_1_1in_1_1ping.html#ae0d180616fe53dddd61f70c62526b0db">size</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (buf)</div>
<div class="line">    {</div>
<div class="line">        va_start(arg, format);</div>
<div class="line">        len = vsnprintf(buf, <a class="code" href="namespacevficom_1_1cmdparam_1_1in_1_1ping.html#ae0d180616fe53dddd61f70c62526b0db">size</a>, format, arg);</div>
<div class="line">        <span class="keywordflow">if</span> (len &gt;= <a class="code" href="namespacevficom_1_1cmdparam_1_1in_1_1ping.html#ae0d180616fe53dddd61f70c62526b0db">size</a>)</div>
<div class="line">        {</div>
<div class="line">            <a class="code" href="namespacevficom_1_1cmdparam_1_1in_1_1ping.html#ae0d180616fe53dddd61f70c62526b0db">size</a> = len + 1;</div>
<div class="line">            bufr = (<span class="keywordtype">char</span> *) realloc(buf, <a class="code" href="namespacevficom_1_1cmdparam_1_1in_1_1ping.html#ae0d180616fe53dddd61f70c62526b0db">size</a>);</div>
<div class="line">            <span class="keywordflow">if</span> (bufr)</div>
<div class="line">            {</div>
<div class="line">                buf = bufr;</div>
<div class="line">                len = vsnprintf(buf, <a class="code" href="namespacevficom_1_1cmdparam_1_1in_1_1ping.html#ae0d180616fe53dddd61f70c62526b0db">size</a>, format, arg);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">else</span></div>
<div class="line">            {</div>
<div class="line">                free(buf);</div>
<div class="line">                buf = NULL;</div>
<div class="line">            }</div>
<div class="line">        }</div>
<div class="line">        va_end(arg);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (buf)</div>
<div class="line">    {</div>
<div class="line">        ptr = buf;</div>
<div class="line">        <span class="keywordflow">while</span> (len &gt; 99)</div>
<div class="line">        {</div>
<div class="line">            save = ptr[99];</div>
<div class="line">            ptr[99] = <span class="charliteral">&#39;\0&#39;</span>;</div>
<div class="line">            TRACE(ptr);</div>
<div class="line">            ptr[99] = save;</div>
<div class="line">            ptr += 99;</div>
<div class="line">            len -= 99;</div>
<div class="line">        }</div>
<div class="line">        TRACE(ptr);</div>
<div class="line">        free(buf);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    pthread_mutex_unlock(&amp;traceMutex);</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="acrdsync_8h_html_a74d8a2a3fedd23009bdbb24d34883b86"><div class="ttname"><a href="crdsync_8h.html#a74d8a2a3fedd23009bdbb24d34883b86">crdSync_WriteData</a></div><div class="ttdeci">CRDSYNC_RET crdSync_WriteData(int MemoryAddress, const unsigned char TxBuf[], unsigned short TxLen)</div><div class="ttdoc">Write data to the synchronous card  .</div></div>
<div class="ttc" id="acrdsync_8h_html_af21f57a16d031a8c4583bf2a77834301"><div class="ttname"><a href="crdsync_8h.html#af21f57a16d031a8c4583bf2a77834301">CRDSYNC_RET</a></div><div class="ttdeci">int CRDSYNC_RET</div><div class="ttdoc">Response code type definition.</div><div class="ttdef"><b>Definition:</b> crdsync.h:14</div></div>
<div class="ttc" id="acrdsync_8h_html_aa210b9d21f89580090da29bf7b9de69d"><div class="ttname"><a href="crdsync_8h.html#aa210b9d21f89580090da29bf7b9de69d">crdSync_PowerDown</a></div><div class="ttdeci">CRDSYNC_RET crdSync_PowerDown()</div><div class="ttdoc">Power down the synchronous card  .</div></div>
<div class="ttc" id="acrdsync_8h_html_abc73a9cc90b40c139244436baefd48b7"><div class="ttname"><a href="crdsync_8h.html#abc73a9cc90b40c139244436baefd48b7">CRDSYNC_CARDTYPE_AT24C08SC</a></div><div class="ttdeci">#define CRDSYNC_CARDTYPE_AT24C08SC</div><div class="ttdoc">Atmel AT24C08SC.</div><div class="ttdef"><b>Definition:</b> crdsync.h:34</div></div>
<div class="ttc" id="acrdsync_8h_html_a0498c6b5a79796abfb55dc0b9b2037c2"><div class="ttname"><a href="crdsync_8h.html#a0498c6b5a79796abfb55dc0b9b2037c2">CRDSYNC_CARDTYPE_AT24C01SC</a></div><div class="ttdeci">#define CRDSYNC_CARDTYPE_AT24C01SC</div><div class="ttdoc">Atmel AT24C01SC.</div><div class="ttdef"><b>Definition:</b> crdsync.h:31</div></div>
<div class="ttc" id="acrdsync_8h_html_a0337406ca951ed912c718448567f0c86"><div class="ttname"><a href="crdsync_8h.html#a0337406ca951ed912c718448567f0c86">crdSync_IsCardPresent</a></div><div class="ttdeci">CRDSYNC_RET crdSync_IsCardPresent()</div><div class="ttdoc">Check if a card is inserted in the full-sized card reader.  .</div></div>
<div class="ttc" id="acrdsync_8h_html_aad6e42b9b4a77a320b963da0d9ebd455"><div class="ttname"><a href="crdsync_8h.html#aad6e42b9b4a77a320b963da0d9ebd455">crdSync_Version</a></div><div class="ttdeci">void crdSync_Version(char *version, unsigned char len)</div></div>
<div class="ttc" id="acrdsync_8h_html_a6f7218a5eddce4c7a642d1c020192934"><div class="ttname"><a href="crdsync_8h.html#a6f7218a5eddce4c7a642d1c020192934">crdSync_Close</a></div><div class="ttdeci">CRDSYNC_RET crdSync_Close(unsigned Options)</div><div class="ttdoc">Close the synchronous card driver  .</div></div>
<div class="ttc" id="acrdsync_8h_html"><div class="ttname"><a href="crdsync_8h.html">crdsync.h</a></div></div>
<div class="ttc" id="acrdsync_8h_html_a101ac06486cf501d08af0213a9f91674"><div class="ttname"><a href="crdsync_8h.html#a101ac06486cf501d08af0213a9f91674">CRDSYNC_CARDTYPE_AT24C16SC</a></div><div class="ttdeci">#define CRDSYNC_CARDTYPE_AT24C16SC</div><div class="ttdoc">Atmel AT24C16SC.</div><div class="ttdef"><b>Definition:</b> crdsync.h:35</div></div>
<div class="ttc" id="anamespacevficom_1_1cmdparam_1_1in_1_1ussd__write_html_aa2ad567d2728772e7ce46242b9f5e83a"><div class="ttname"><a href="namespacevficom_1_1cmdparam_1_1in_1_1ussd__write.html#aa2ad567d2728772e7ce46242b9f5e83a">vficom::cmdparam::in::ussd_write::str</a></div><div class="ttdeci">const COM3_DllSpec char str[]</div><div class="ttdoc">string, optional</div></div>
<div class="ttc" id="acrdsync_8h_html_a0275ae827d5612fc02a2390754ab1ce6"><div class="ttname"><a href="crdsync_8h.html#a0275ae827d5612fc02a2390754ab1ce6">CRDSYNC_CARDTYPE_AT24C02SC</a></div><div class="ttdeci">#define CRDSYNC_CARDTYPE_AT24C02SC</div><div class="ttdoc">Atmel AT24C02SC.</div><div class="ttdef"><b>Definition:</b> crdsync.h:32</div></div>
<div class="ttc" id="acrdsync_8h_html_afbd3dd4039b9bf6429ed7ea88d90826d"><div class="ttname"><a href="crdsync_8h.html#afbd3dd4039b9bf6429ed7ea88d90826d">crdSync_ReadData</a></div><div class="ttdeci">CRDSYNC_RET crdSync_ReadData(int MemoryAddress, unsigned char RxBuf[], unsigned short RxLen)</div><div class="ttdoc">Read data from the synchronous card  .</div></div>
<div class="ttc" id="acrdsync_8h_html_aedf79d2acabae0e89c9f627faeed61e2"><div class="ttname"><a href="crdsync_8h.html#aedf79d2acabae0e89c9f627faeed61e2">CRDSYNC_CARDTYPE_AT24C04SC</a></div><div class="ttdeci">#define CRDSYNC_CARDTYPE_AT24C04SC</div><div class="ttdoc">Atmel AT24C04SC.</div><div class="ttdef"><b>Definition:</b> crdsync.h:33</div></div>
<div class="ttc" id="acrdsync_8h_html_af2e8b408142c3fdf772936352aaec87a"><div class="ttname"><a href="crdsync_8h.html#af2e8b408142c3fdf772936352aaec87a">crdSync_Open</a></div><div class="ttdeci">CRDSYNC_RET crdSync_Open(unsigned Options)</div><div class="ttdoc">Open the synchronous card driver  .</div></div>
<div class="ttc" id="acrdsync_8h_html_a54f538cdfe50976653de0ed7550a716b"><div class="ttname"><a href="crdsync_8h.html#a54f538cdfe50976653de0ed7550a716b">crdSync_PowerUp</a></div><div class="ttdeci">CRDSYNC_RET crdSync_PowerUp(int CardType, unsigned char AtrBuf[], unsigned char *AtrLen)</div><div class="ttdoc">Power up the synchronous card  .</div></div>
<div class="ttc" id="acrdsync_8h_html_a3d9902893c6348c09d6d70f20b0a13b2"><div class="ttname"><a href="crdsync_8h.html#a3d9902893c6348c09d6d70f20b0a13b2">crdSync_SetTraceCallback</a></div><div class="ttdeci">void crdSync_SetTraceCallback(CRDSYNC_TraceCallback cbf, void *cb_data)</div></div>
<div class="ttc" id="acrdsync_8h_html_a80ebd75ac4813946bf8dec804f90078a"><div class="ttname"><a href="crdsync_8h.html#a80ebd75ac4813946bf8dec804f90078a">CRDSYNC_CARDTYPE_ST14C02SC</a></div><div class="ttdeci">#define CRDSYNC_CARDTYPE_ST14C02SC</div><div class="ttdoc">STMicro ST14C02SC.</div><div class="ttdef"><b>Definition:</b> crdsync.h:36</div></div>
<div class="ttc" id="anamespacevficom_1_1cmdparam_1_1in_1_1ping_html_ae0d180616fe53dddd61f70c62526b0db"><div class="ttname"><a href="namespacevficom_1_1cmdparam_1_1in_1_1ping.html#ae0d180616fe53dddd61f70c62526b0db">vficom::cmdparam::in::ping::size</a></div><div class="ttdeci">const COM3_DllSpec char size[]</div><div class="ttdoc">integer - [optional] use &quot;size&quot; as number of data bytes to be sent, default 56</div></div>
<div class="ttc" id="amain_8cpp_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> main.cpp:1237</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Jun 16 2025 16:03:56 for ADK-Programmers-Guides by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
