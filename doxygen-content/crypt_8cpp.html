<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ADK-Programmers-Guides: sdi/src/crypt.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="verifone.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="verifonelogo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ADK-Programmers-Guides
   &#160;<span id="projectnumber">5.0.3-CD1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('crypt_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">crypt.cpp File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;stdio.h&gt;</code><br />
<code>#include &quot;<a class="el" href="crypt_8h_source.html">crypt.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="libsec_8h_source.html">sec/libsec.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sys_8h_source.html">sys.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="__logf_8h_source.html">_logf.h</a>&quot;</code><br />
<code>#include &lt;vector&gt;</code><br />
<code>#include &lt;string&gt;</code><br />
<code>#include &quot;<a class="el" href="ipc_2src_2ipc_2jsobject_8h_source.html">ipc/jsobject.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="sysinfo_8h_source.html">sysinfo/sysinfo.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="md5_8h_source.html">md5.h</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="pthreadutil_8h_source.html">pthreadutil.h</a>&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for crypt.cpp:</div>
<div class="dyncontent">
<div class="center"><img src="crypt_8cpp__incl.png" border="0" usemap="#sdi_2src_2crypt_8cpp" alt=""/></div>
<map name="sdi_2src_2crypt_8cpp" id="sdi_2src_2crypt_8cpp">
<area shape="rect" title=" " alt="" coords="873,5,1001,32"/>
<area shape="rect" title=" " alt="" coords="5,304,72,331"/>
<area shape="rect" href="crypt_8h.html" title=" " alt="" coords="1132,80,1199,107"/>
<area shape="rect" href="libsec_8h.html" title="ADK Security Service API." alt="" coords="437,80,536,107"/>
<area shape="rect" title=" " alt="" coords="777,304,839,331"/>
<area shape="rect" title=" " alt="" coords="971,304,1029,331"/>
<area shape="rect" href="ipc_2src_2ipc_2jsobject_8h.html" title=" " alt="" coords="854,229,962,256"/>
<area shape="rect" href="sys_8h.html" title=" " alt="" coords="1223,80,1279,107"/>
<area shape="rect" href="__logf_8h.html" title=" " alt="" coords="1303,80,1369,107"/>
<area shape="rect" href="sysinfo_8h.html" title=" " alt="" coords="975,80,1107,107"/>
<area shape="rect" href="md5_8h.html" title=" " alt="" coords="73,229,135,256"/>
<area shape="rect" href="pthreadutil_8h.html" title=" " alt="" coords="1451,80,1557,107"/>
<area shape="rect" href="sec2_8h.html" title="ADK Security Definitions." alt="" coords="160,229,224,256"/>
<area shape="rect" href="_c_transaction_data_8h.html" title="ADK Security Service Transaction Data." alt="" coords="475,155,623,181"/>
<area shape="rect" title=" " alt="" coords="693,304,744,331"/>
<area shape="rect" href="sec_error_8h.html" title="ADK Security Service Error Codes." alt="" coords="299,229,386,256"/>
<area shape="rect" title=" " alt="" coords="101,304,171,331"/>
<area shape="rect" title=" " alt="" coords="512,229,587,256"/>
<area shape="rect" title=" " alt="" coords="611,229,677,256"/>
<area shape="rect" title=" " alt="" coords="873,304,943,331"/>
<area shape="rect" title=" " alt="" coords="601,304,669,331"/>
<area shape="rect" title=" " alt="" coords="195,304,266,331"/>
<area shape="rect" title=" " alt="" coords="290,304,379,331"/>
<area shape="rect" title=" " alt="" coords="404,304,481,331"/>
<area shape="rect" title=" " alt="" coords="506,304,577,331"/>
<area shape="rect" title=" " alt="" coords="1242,155,1345,181"/>
<area shape="rect" title=" " alt="" coords="1369,155,1497,181"/>
<area shape="rect" href="dllspec_8h.html" title=" " alt="" coords="975,155,1055,181"/>
<area shape="rect" href="syserror_8h.html" title=" " alt="" coords="1079,155,1166,181"/>
<area shape="rect" title=" " alt="" coords="1522,155,1606,181"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_auth.html">Auth</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_auth_sec.html">AuthSec</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a38dadd06badcc5b7cca444a551604399"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt_8cpp.html#a38dadd06badcc5b7cca444a551604399">FALL_THROUGH</a></td></tr>
<tr class="separator:a38dadd06badcc5b7cca444a551604399"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa132af50976d028410ad9789f5ec5aab"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt_8cpp.html#aa132af50976d028410ad9789f5ec5aab">check_AuthScript</a> ()</td></tr>
<tr class="separator:aa132af50976d028410ad9789f5ec5aab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a853e613db30d5f21771dd5b5ba76b989"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt_8cpp.html#a853e613db30d5f21771dd5b5ba76b989">system_Auth</a> (enum <a class="el" href="crypt_8h.html#ab97c53cf460f4280eb94c660cb5e357d">AuthStep</a> as, unsigned char *in, unsigned short in_size, unsigned char *out, unsigned short *out_size)</td></tr>
<tr class="separator:a853e613db30d5f21771dd5b5ba76b989"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affad0aaba09298a627562b262e523d93"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt_8cpp.html#affad0aaba09298a627562b262e523d93">calculate_CMAC</a> (<a class="el" href="crypt_8h.html#adcc10b90a6f6d8e58954648e01763711">Inputype</a> type, const char *fileToMAC, unsigned char *dataToMAC, unsigned dataSize, unsigned char *MAC)</td></tr>
<tr class="separator:affad0aaba09298a627562b262e523d93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3242ff53cdc315266c6a352f86359c70"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt_8cpp.html#a3242ff53cdc315266c6a352f86359c70">check_CMAC</a> (<a class="el" href="crypt_8h.html#adcc10b90a6f6d8e58954648e01763711">Inputype</a> type, const char *filename, unsigned char *data, unsigned dataSize, unsigned char *MAC)</td></tr>
<tr class="separator:a3242ff53cdc315266c6a352f86359c70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e77c714fd81df4137cfc32dc7af3584"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt_8cpp.html#a7e77c714fd81df4137cfc32dc7af3584">encrypt_Data</a> (unsigned char *data, unsigned long dataSize, unsigned char *encryptedData, unsigned long *encryptedDataSize)</td></tr>
<tr class="separator:a7e77c714fd81df4137cfc32dc7af3584"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab52056b7a75e86920c5b03cf2d3730ad"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt_8cpp.html#ab52056b7a75e86920c5b03cf2d3730ad">decrypt_Data</a> (unsigned char *data, unsigned long dataSize, unsigned char *decryptedData, unsigned long *decryptedDataSize)</td></tr>
<tr class="separator:ab52056b7a75e86920c5b03cf2d3730ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d396bd846d00eab3b94e9c2763236cc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="crypt_8cpp.html#a9d396bd846d00eab3b94e9c2763236cc">calculate_MD5</a> (const char *file, unsigned char *checkSum)</td></tr>
<tr class="separator:a9d396bd846d00eab3b94e9c2763236cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a38dadd06badcc5b7cca444a551604399"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38dadd06badcc5b7cca444a551604399">&#9670;&nbsp;</a></span>FALL_THROUGH</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FALL_THROUGH</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="affad0aaba09298a627562b262e523d93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affad0aaba09298a627562b262e523d93">&#9670;&nbsp;</a></span>calculate_CMAC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int calculate_CMAC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypt_8h.html#adcc10b90a6f6d8e58954648e01763711">Inputype</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fileToMAC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>dataToMAC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>dataSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>MAC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Calculate the CMAC value for the given data </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>input type. can be a file or a data buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">fileToMAC</td><td>file name (when input type is INPUT_TYPE_FILE) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dataToMAC</td><td>pointer to input message buffer (when input type is INPUT_TYPE_BUFFER) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dataSize</td><td>size of the input message (when input type is INPUT_TYPE_BUFFER) </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">MAC</td><td>pointer to the MAC value buffer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>RESULT_OK on success otherwise RESULT_FAIL </dd></dl>

</div>
</div>
<a id="a9d396bd846d00eab3b94e9c2763236cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d396bd846d00eab3b94e9c2763236cc">&#9670;&nbsp;</a></span>calculate_MD5()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int calculate_MD5 </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>file</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>checkSum</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Compute and MD5 digest of file <code>file</code> </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">file</td><td>file of which MD5 checksum shall be calculated </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">checkSum</td><td>output buffer for calculated MD5 checksum, buffer must have at least 16 bytes </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>1 for success, else 0 for error (e.g. file does not exist) </dd></dl>

</div>
</div>
<a id="aa132af50976d028410ad9789f5ec5aab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa132af50976d028410ad9789f5ec5aab">&#9670;&nbsp;</a></span>check_AuthScript()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int check_AuthScript </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>checks the status of VSS script used for SDI message integrity check (message MAC) and SDI message encryption </p><dl class="section return"><dt>Returns</dt><dd>RESULT_OK for success, else RESULT_FAIL for failure </dd></dl>

</div>
</div>
<a id="a3242ff53cdc315266c6a352f86359c70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3242ff53cdc315266c6a352f86359c70">&#9670;&nbsp;</a></span>check_CMAC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int check_CMAC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="crypt_8h.html#adcc10b90a6f6d8e58954648e01763711">Inputype</a>&#160;</td>
          <td class="paramname"><em>type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>dataSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>MAC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Check the CMAC value of the given data </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">type</td><td>input type. can be a file or a data buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>file name (when input type is INPUT_TYPE_FILE) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>pointer to input message buffer (when input type is INPUT_TYPE_BUFFER) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dataSize</td><td>size of the input message (when input type is INPUT_TYPE_BUFFER) </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">MAC</td><td>pointer to the MAC value buffer </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>RESULT_OK on success otherwise RESULT_FAIL </dd></dl>

</div>
</div>
<a id="ab52056b7a75e86920c5b03cf2d3730ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab52056b7a75e86920c5b03cf2d3730ad">&#9670;&nbsp;</a></span>decrypt_Data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int decrypt_Data </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>dataSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>decryptedData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>decryptedDataSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Decrypt the given data </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>pointer to input message buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dataSize</td><td>size of the input message </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">decryptedData</td><td>pointer to decrypted data buffer </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">decryptedDataSize</td><td>pointer to decrypted data buffer size </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>RESULT_OK on success otherwise RESULT_FAIL </dd></dl>

</div>
</div>
<a id="a7e77c714fd81df4137cfc32dc7af3584"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e77c714fd81df4137cfc32dc7af3584">&#9670;&nbsp;</a></span>encrypt_Data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int encrypt_Data </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>dataSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>encryptedData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned long *&#160;</td>
          <td class="paramname"><em>encryptedDataSize</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Encrypt the given data </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>pointer to input message buffer </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dataSize</td><td>size of the input message </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">encryptedData</td><td>pointer to encrypted data buffer </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">encryptedDataSize</td><td>pointer to encrypted data buffer size </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>RESULT_OK on success otherwise RESULT_FAIL </dd></dl>

</div>
</div>
<a id="a853e613db30d5f21771dd5b5ba76b989"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a853e613db30d5f21771dd5b5ba76b989">&#9670;&nbsp;</a></span>system_Auth()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int system_Auth </td>
          <td>(</td>
          <td class="paramtype">enum <a class="el" href="crypt_8h.html#ab97c53cf460f4280eb94c660cb5e357d">AuthStep</a>&#160;</td>
          <td class="paramname"><em>as</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short&#160;</td>
          <td class="paramname"><em>in_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>out</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned short *&#160;</td>
          <td class="paramname"><em>out_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Process System Authentication step 1 or 2. With success of step 2, the SDI client (Server) is successfully authenticated against SDI server (E105). In addition, the session key (SK) was stored to vault successfully. This is the prerequisite that other functions <a class="el" href="crypt_8h.html#affad0aaba09298a627562b262e523d93">calculate_CMAC()</a>, <a class="el" href="crypt_8h.html#a3242ff53cdc315266c6a352f86359c70">check_CMAC()</a>, <a class="el" href="crypt_8h.html#a7e77c714fd81df4137cfc32dc7af3584">encrypt_Data()</a> and <a class="el" href="crypt_8h.html#ab52056b7a75e86920c5b03cf2d3730ad">decrypt_Data()</a> will work, since these functions use the session key (SK). </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">as</td><td>For System Authentication Step 1: AuthStep_1 For System Authentication Step 2: AuthStep_2 Input and output data of this function depend on this parameter (see below). </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">in</td><td>pointer to input data buffer For AuthStep_1 (16 bytes): 16 bytes (Server random, plain) For AuthStep_2 (32 bytes): [16 bytes (E105 token) + 16 bytes (Server token)] SK encrypted </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">in_size</td><td>size of input buffer (depend on auth. step, see parameter <code>in</code>) </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">out</td><td>pointer to output buffer For AuthStep_1 (42 bytes): [16 bytes (E105 token) + 16 bytes (E105 token)] DUKPT encrypted + 10 bytes (KSN) For AuthStep_2 (32 bytes): [16 bytes (Server token) + 16 bytes (E105 serial number)] SK encrypted </td></tr>
    <tr><td class="paramdir">[in,out]</td><td class="paramname">out_size</td><td>in: size of output buffer out: size of output buffer data (depend on auth. step, see parameter <code>out</code>) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>RESULT_OK for success, else RESULT_FAIL for failure </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_44d926a17fc606d3c25449ba60427c63.html">sdi</a></li><li class="navelem"><a class="el" href="dir_048f823fee1bfb22502a8732b9a001aa.html">src</a></li><li class="navelem"><a class="el" href="crypt_8cpp.html">crypt.cpp</a></li>
    <li class="footer">Generated on Mon Jun 16 2025 16:03:57 for ADK-Programmers-Guides by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
