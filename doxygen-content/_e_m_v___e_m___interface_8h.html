<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ADK-Programmers-Guides: emv/EMV_Encryption_Manager/export/EMV_EM_Interface.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="verifone.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="verifonelogo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ADK-Programmers-Guides
   &#160;<span id="projectnumber">5.0.3-CD1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_e_m_v___e_m___interface_8h.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#enum-members">Enumerations</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">EMV_EM_Interface.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Interface of EMV Encryption Manager.  
<a href="#details">More...</a></p>

<p><a href="_e_m_v___e_m___interface_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ab4b56537f29043b46d36de284e28fbb4"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_e_m_v___e_m___interface_8h.html#ab4b56537f29043b46d36de284e28fbb4">DLL_EMC</a>&#160;&#160;&#160;<a class="el" href="_v_h_q__vfisyspm__wrapper_8cpp.html#a9e4fa62755aeaea9c141cacda826fbcd">__attribute__</a>((visibility (&quot;default&quot;)))</td></tr>
<tr class="separator:ab4b56537f29043b46d36de284e28fbb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afba641b27a765441e711a5911be28237"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_e_m_v___e_m___interface_8h.html#afba641b27a765441e711a5911be28237">EMV_ENCRYPTION_MANAGER_VERSION</a>&#160;&#160;&#160;&quot;0.0.1-developer&quot;</td></tr>
<tr class="memdesc:afba641b27a765441e711a5911be28237"><td class="mdescLeft">&#160;</td><td class="mdescRight">Version of EMV Encryption Manager.  <a href="_e_m_v___e_m___interface_8h.html#afba641b27a765441e711a5911be28237">More...</a><br /></td></tr>
<tr class="separator:afba641b27a765441e711a5911be28237"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a90750ca20d2ab2da21d35aacf916d864"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_e_m_v___e_m___interface_8h.html#a90750ca20d2ab2da21d35aacf916d864">ENCRYPTION_MANAGER_TAGS_BASE</a>&#160;&#160;&#160;0xDFD900</td></tr>
<tr class="memdesc:a90750ca20d2ab2da21d35aacf916d864"><td class="mdescLeft">&#160;</td><td class="mdescRight">starting TLV tag for special information exchange between application and ecryption manager  <a href="_e_m_v___e_m___interface_8h.html#a90750ca20d2ab2da21d35aacf916d864">More...</a><br /></td></tr>
<tr class="separator:a90750ca20d2ab2da21d35aacf916d864"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a70b4dff05b0d45f6f5a6eea201885405"><td class="memItemLeft" align="right" valign="top">typedef enum <a class="el" href="_e_m_v___e_m___interface_8h.html#a78c621aa7637de09eabc74b9ac450cba">EMV_EM_OUTCOME</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_e_m_v___e_m___interface_8h.html#a70b4dff05b0d45f6f5a6eea201885405">EMV_EM_OUTCOME_TYPE</a></td></tr>
<tr class="memdesc:a70b4dff05b0d45f6f5a6eea201885405"><td class="mdescLeft">&#160;</td><td class="mdescRight">possible returns of the Encryption Manager  <a href="_e_m_v___e_m___interface_8h.html#a70b4dff05b0d45f6f5a6eea201885405">More...</a><br /></td></tr>
<tr class="separator:a70b4dff05b0d45f6f5a6eea201885405"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="enum-members"></a>
Enumerations</h2></td></tr>
<tr class="memitem:a78c621aa7637de09eabc74b9ac450cba"><td class="memItemLeft" align="right" valign="top">enum &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_e_m_v___e_m___interface_8h.html#a78c621aa7637de09eabc74b9ac450cba">EMV_EM_OUTCOME</a> { <br />
&#160;&#160;<a class="el" href="_e_m_v___e_m___interface_8h.html#a78c621aa7637de09eabc74b9ac450cbaa8881632fec5d793d9b3381c8d8ee803a">EM_BLOCKED</a> = 13, 
<a class="el" href="_e_m_v___e_m___interface_8h.html#a78c621aa7637de09eabc74b9ac450cbaa404f17f09840048050093143b0643215">EM_SENSTIVE_ENCRYPTED</a> = 12, 
<a class="el" href="_e_m_v___e_m___interface_8h.html#a78c621aa7637de09eabc74b9ac450cbaabe3a18a6a1d33197e354173f8c9716b0">EM_SENSTIVE_FORMAT_PRESERVING</a> = 11, 
<a class="el" href="_e_m_v___e_m___interface_8h.html#a78c621aa7637de09eabc74b9ac450cbaa7387a993b4f9b352214e93c348be1f5a">EM_NOT_SENSITIVE</a> = 10, 
<br />
&#160;&#160;<a class="el" href="_e_m_v___e_m___interface_8h.html#a78c621aa7637de09eabc74b9ac450cbaacf249f526bf4db771494db24ca476e74">EM_ATTRIBUTE</a> = 9, 
<a class="el" href="_e_m_v___e_m___interface_8h.html#a78c621aa7637de09eabc74b9ac450cbaa1d721c0d6412a32e0908f41ea4bab010">EM_OK</a> = 0, 
<a class="el" href="_e_m_v___e_m___interface_8h.html#a78c621aa7637de09eabc74b9ac450cbaa1a0929da5fdea29667f453392453afb7">EM_PARAM_ERROR</a> = -1, 
<a class="el" href="_e_m_v___e_m___interface_8h.html#a78c621aa7637de09eabc74b9ac450cbaa84750ccc2863a3b3f8af1f12cf4dc26a">EM_FAILURE</a> = -2
<br />
 }</td></tr>
<tr class="memdesc:a78c621aa7637de09eabc74b9ac450cba"><td class="mdescLeft">&#160;</td><td class="mdescRight">possible returns of the Encryption Manager  <a href="_e_m_v___e_m___interface_8h.html#a78c621aa7637de09eabc74b9ac450cba">More...</a><br /></td></tr>
<tr class="separator:a78c621aa7637de09eabc74b9ac450cba"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa69f5a8c3d14299eb6e9f33afe67e28f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_e_m_v___e_m___interface_8h.html#ab4b56537f29043b46d36de284e28fbb4">DLL_EMC</a> int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_e_m_v___e_m___interface_8h.html#aa69f5a8c3d14299eb6e9f33afe67e28f">EMV_EM_Init</a> (const unsigned char *TxnRelatedData, unsigned dataLen)</td></tr>
<tr class="memdesc:aa69f5a8c3d14299eb6e9f33afe67e28f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize the Encryption Manager.  <a href="_e_m_v___e_m___interface_8h.html#aa69f5a8c3d14299eb6e9f33afe67e28f">More...</a><br /></td></tr>
<tr class="separator:aa69f5a8c3d14299eb6e9f33afe67e28f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6574cd195d6f49fdcbe75150b8ddc338"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_e_m_v___e_m___interface_8h.html#ab4b56537f29043b46d36de284e28fbb4">DLL_EMC</a> int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_e_m_v___e_m___interface_8h.html#a6574cd195d6f49fdcbe75150b8ddc338">EMV_EM_IsTagSensitive</a> (unsigned long RequestedTag, const unsigned long **Mapping, unsigned *LengthMapping)</td></tr>
<tr class="memdesc:a6574cd195d6f49fdcbe75150b8ddc338"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find out if a tag is considered sensitive in the payment system environment.  <a href="_e_m_v___e_m___interface_8h.html#a6574cd195d6f49fdcbe75150b8ddc338">More...</a><br /></td></tr>
<tr class="separator:a6574cd195d6f49fdcbe75150b8ddc338"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4721c2e04324b076f9e44afd810b09b6"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="_e_m_v___e_m___interface_8h.html#ab4b56537f29043b46d36de284e28fbb4">DLL_EMC</a> unsigned char *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_e_m_v___e_m___interface_8h.html#a4721c2e04324b076f9e44afd810b09b6">EMV_EM_Encrypt</a> (unsigned long RequestedTag, const unsigned char *DataIn, unsigned DataInLength, unsigned *DataOutLength)</td></tr>
<tr class="memdesc:a4721c2e04324b076f9e44afd810b09b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Encrypt a sensitive tag.  <a href="_e_m_v___e_m___interface_8h.html#a4721c2e04324b076f9e44afd810b09b6">More...</a><br /></td></tr>
<tr class="separator:a4721c2e04324b076f9e44afd810b09b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Interface of EMV Encryption Manager. </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="ab4b56537f29043b46d36de284e28fbb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab4b56537f29043b46d36de284e28fbb4">&#9670;&nbsp;</a></span>DLL_EMC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DLL_EMC&#160;&#160;&#160;<a class="el" href="_v_h_q__vfisyspm__wrapper_8cpp.html#a9e4fa62755aeaea9c141cacda826fbcd">__attribute__</a>((visibility (&quot;default&quot;)))</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="afba641b27a765441e711a5911be28237"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afba641b27a765441e711a5911be28237">&#9670;&nbsp;</a></span>EMV_ENCRYPTION_MANAGER_VERSION</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EMV_ENCRYPTION_MANAGER_VERSION&#160;&#160;&#160;&quot;0.0.1-developer&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Version of EMV Encryption Manager. </p>

</div>
</div>
<a id="a90750ca20d2ab2da21d35aacf916d864"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a90750ca20d2ab2da21d35aacf916d864">&#9670;&nbsp;</a></span>ENCRYPTION_MANAGER_TAGS_BASE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENCRYPTION_MANAGER_TAGS_BASE&#160;&#160;&#160;0xDFD900</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>starting TLV tag for special information exchange between application and ecryption manager </p>

</div>
</div>
<h2 class="groupheader">Typedef Documentation</h2>
<a id="a70b4dff05b0d45f6f5a6eea201885405"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70b4dff05b0d45f6f5a6eea201885405">&#9670;&nbsp;</a></span>EMV_EM_OUTCOME_TYPE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef enum <a class="el" href="_e_m_v___e_m___interface_8h.html#a78c621aa7637de09eabc74b9ac450cba">EMV_EM_OUTCOME</a> <a class="el" href="_e_m_v___e_m___interface_8h.html#a70b4dff05b0d45f6f5a6eea201885405">EMV_EM_OUTCOME_TYPE</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>possible returns of the Encryption Manager </p>

</div>
</div>
<h2 class="groupheader">Enumeration Type Documentation</h2>
<a id="a78c621aa7637de09eabc74b9ac450cba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a78c621aa7637de09eabc74b9ac450cba">&#9670;&nbsp;</a></span>EMV_EM_OUTCOME</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">enum <a class="el" href="_e_m_v___e_m___interface_8h.html#a78c621aa7637de09eabc74b9ac450cba">EMV_EM_OUTCOME</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>possible returns of the Encryption Manager </p>
<table class="fieldtable">
<tr><th colspan="2">Enumerator</th></tr><tr><td class="fieldname"><a id="a78c621aa7637de09eabc74b9ac450cbaa8881632fec5d793d9b3381c8d8ee803a"></a>EM_BLOCKED&#160;</td><td class="fielddoc"><p>Requested tag is blocked and must not be delivered at the API. </p>
</td></tr>
<tr><td class="fieldname"><a id="a78c621aa7637de09eabc74b9ac450cbaa404f17f09840048050093143b0643215"></a>EM_SENSTIVE_ENCRYPTED&#160;</td><td class="fielddoc"><p>Requested tag is considered sensitive, not format pre-serving. </p>
</td></tr>
<tr><td class="fieldname"><a id="a78c621aa7637de09eabc74b9ac450cbaabe3a18a6a1d33197e354173f8c9716b0"></a>EM_SENSTIVE_FORMAT_PRESERVING&#160;</td><td class="fielddoc"><p>Requested tag is considered sensitive but format pre-serving, e.g. tokenization. </p>
</td></tr>
<tr><td class="fieldname"><a id="a78c621aa7637de09eabc74b9ac450cbaa7387a993b4f9b352214e93c348be1f5a"></a>EM_NOT_SENSITIVE&#160;</td><td class="fielddoc"><p>Requested tag is NOT considered sensitive. </p>
</td></tr>
<tr><td class="fieldname"><a id="a78c621aa7637de09eabc74b9ac450cbaacf249f526bf4db771494db24ca476e74"></a>EM_ATTRIBUTE&#160;</td><td class="fielddoc"><p>Requested tag is an EM owned attribue/meta data like KSN for DUKPT. </p>
</td></tr>
<tr><td class="fieldname"><a id="a78c621aa7637de09eabc74b9ac450cbaa1d721c0d6412a32e0908f41ea4bab010"></a>EM_OK&#160;</td><td class="fielddoc"><p>Command successfully executed. </p>
</td></tr>
<tr><td class="fieldname"><a id="a78c621aa7637de09eabc74b9ac450cbaa1a0929da5fdea29667f453392453afb7"></a>EM_PARAM_ERROR&#160;</td><td class="fielddoc"><p>Bad arguments. </p>
</td></tr>
<tr><td class="fieldname"><a id="a78c621aa7637de09eabc74b9ac450cbaa84750ccc2863a3b3f8af1f12cf4dc26a"></a>EM_FAILURE&#160;</td><td class="fielddoc"><p>Failure reported by underlaying encryption system. </p>
</td></tr>
</table>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a4721c2e04324b076f9e44afd810b09b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4721c2e04324b076f9e44afd810b09b6">&#9670;&nbsp;</a></span>EMV_EM_Encrypt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="_e_m_v___e_m___interface_8h.html#ab4b56537f29043b46d36de284e28fbb4">DLL_EMC</a> unsigned char* EMV_EM_Encrypt </td>
          <td>(</td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>RequestedTag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>DataIn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>DataInLength</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname"><em>DataOutLength</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Encrypt a sensitive tag. </p>
<p>This function encrpyts any sensitive data provided if the tag (or template) is sensitive by the means of the encryption engine It returns a pointer to the encrypted data. If the requested tag or template is not sensitive it returns a pointer to the unencrypted data. If the data can not be encrypted by the underlying encrpytion engine it returns a NULL pointer. The encryption itself, the key injection for the encryption engine and the configuration of the encryption engine (RSA/DES/DUPKT/TOKENS, tags to be considered sensitive, scheme specific checks) is out of scope of the Encryption Manager interface. This configuration interface needs to be provided by the underlying encryption engine.</p>
<dl class="section author"><dt>Author</dt><dd>GSS R&amp;D Germany</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">RequestedTag</td><td>tag or template to be encrypted </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DataIn</td><td>data to encrypted </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">DataInLength</td><td>length of data to encrypted </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">DataOutLength</td><td>length of encrypted data</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>pointer to encrypted or tokenized or plain data, NULL if encryption engine fails to encrypt the data </dd></dl>

</div>
</div>
<a id="aa69f5a8c3d14299eb6e9f33afe67e28f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa69f5a8c3d14299eb6e9f33afe67e28f">&#9670;&nbsp;</a></span>EMV_EM_Init()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_e_m_v___e_m___interface_8h.html#ab4b56537f29043b46d36de284e28fbb4">DLL_EMC</a> int EMV_EM_Init </td>
          <td>(</td>
          <td class="paramtype">const unsigned char *&#160;</td>
          <td class="paramname"><em>TxnRelatedData</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>dataLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize the Encryption Manager. </p>
<p>The Encryption manager needs to be intialized for each transaction You need to pass transaction related data here if there is a need of scheme specific encryption or if there is a need for BIN Range checking for example. This data is evaluated during any subsequent encryption process and based on the decision of the transaction data any requested EMV tag is considered to be sensitive or not. This transaction specfifc configuration allows to activate exceptions in the encryption/tokenization of sensitive data. Use Case 1: 5F24 (Expiry Date) is considered to be sensitive per default, for American Express it shall be available for the customer app. Adding the AID to the Init allows to differ in between the schemes. Use Case 2: track 2 data of fleetcards are allowed to be forwarded to the application. Adding the PAN of the current transaction allows to check if the BIN table in the security module to check this. Example for AID and PAN: TxnRelatedData = 9F 06 07 A0 00 00 00 00 03 10 10 5A 08 40 00 50 00 60 00 70 00 (VISA AID and PAN) All configuration data is forwarded in EMV TLV format (EMV book 3, Annex B), e.g. 5F240221220 or 5A0Axxxxxxxxxxxxxxxxxxxx</p>
<dl class="section author"><dt>Author</dt><dd>GSS R&amp;D Germany</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">TxnRelatedData</td><td>transaction related data for specific encryption evaluation </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">dataLen</td><td>valid data length of TxnRelatedData</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="_e_m_v___e_m___interface_8h.html#a78c621aa7637de09eabc74b9ac450cbaa1d721c0d6412a32e0908f41ea4bab010" title="Command successfully executed.">EM_OK</a>, <a class="el" href="_e_m_v___e_m___interface_8h.html#a78c621aa7637de09eabc74b9ac450cbaa1a0929da5fdea29667f453392453afb7" title="Bad arguments.">EM_PARAM_ERROR</a> </dd></dl>

</div>
</div>
<a id="a6574cd195d6f49fdcbe75150b8ddc338"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6574cd195d6f49fdcbe75150b8ddc338">&#9670;&nbsp;</a></span>EMV_EM_IsTagSensitive()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="_e_m_v___e_m___interface_8h.html#ab4b56537f29043b46d36de284e28fbb4">DLL_EMC</a> int EMV_EM_IsTagSensitive </td>
          <td>(</td>
          <td class="paramtype">unsigned long&#160;</td>
          <td class="paramname"><em>RequestedTag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned long **&#160;</td>
          <td class="paramname"><em>Mapping</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned *&#160;</td>
          <td class="paramname"><em>LengthMapping</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find out if a tag is considered sensitive in the payment system environment. </p>
<p>The Encryption Manager hands over the information of the encryption engine considers a specific tag (or template) as sensitive data. If transaction spefific data have been configured during the intialization process of the Encryption manager this data is part of the evaluation. This allows scheme specific and BIN range specific encryption information. There are 3 possible outcomes: tag not sensitive, tag is senstive but format-preserving (e.g. tokenization) or tag is senstive encrypted (e.g. DUKPT encrypted) The out parameter is either NULL (this is used if a tag holds the plain, encrypted or tokenized data itself), a different tag (this is used if a tag shall be mapped to another tag, e.g. if an encryption is not format preserving) or a tag list (this is used if the requested tag represents a specifc template, e.g. BMP 55 template, which includes multiple sensitive data encrypted in a template). Example 1: requested tag 57 is senstive but format pre-serving (tokeneized for example): requested tag 57, return: EM_SENSTIVE_FORMAT_PRESERVING, mapped tags(s): NULL Example 2: requested tag DF8357 is senstive not format preserving and includes the original tag 57 encrypted, return: EM_SENSTIVE_ENCRYPTED, mapped tag(s): 57</p>
<dl class="section author"><dt>Author</dt><dd>GSS R&amp;D Germany</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">RequestedTag</td><td>tag to be checked if seinsitvie or not </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">Mapping</td><td>mapping of this tag to another tag or a tag list </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">LengthMapping</td><td>length of the mapping info stream</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="_e_m_v___e_m___interface_8h.html#a78c621aa7637de09eabc74b9ac450cbaa404f17f09840048050093143b0643215" title="Requested tag is considered sensitive, not format pre-serving.">EM_SENSTIVE_ENCRYPTED</a>, <a class="el" href="_e_m_v___e_m___interface_8h.html#a78c621aa7637de09eabc74b9ac450cbaabe3a18a6a1d33197e354173f8c9716b0" title="Requested tag is considered sensitive but format pre-serving, e.g. tokenization.">EM_SENSTIVE_FORMAT_PRESERVING</a>, <a class="el" href="_e_m_v___e_m___interface_8h.html#a78c621aa7637de09eabc74b9ac450cbaa7387a993b4f9b352214e93c348be1f5a" title="Requested tag is NOT considered sensitive.">EM_NOT_SENSITIVE</a> </dd></dl>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_f2a776acea245b054b8e462971041f2d.html">emv</a></li><li class="navelem"><a class="el" href="dir_e6af11fce173b57b34845a2d306ca53e.html">EMV_Encryption_Manager</a></li><li class="navelem"><a class="el" href="dir_f0c9ed5f160ef6f1ad42b356fd5a33eb.html">export</a></li><li class="navelem"><a class="el" href="_e_m_v___e_m___interface_8h.html">EMV_EM_Interface.h</a></li>
    <li class="footer">Generated on Mon Jun 16 2025 16:03:57 for ADK-Programmers-Guides by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
