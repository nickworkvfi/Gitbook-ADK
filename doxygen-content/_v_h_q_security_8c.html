<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ADK-Programmers-Guides: tmsagt/src/VHQSecurity/VHQSecurity.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="verifone.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="verifonelogo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ADK-Programmers-Guides
   &#160;<span id="projectnumber">5.0.3-CD1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_v_h_q_security_8c.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">VHQSecurity.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;fcntl.h&gt;</code><br />
<code>#include &lt;memory.h&gt;</code><br />
<code>#include &lt;pwd.h&gt;</code><br />
<code>#include &lt;svcsec.h&gt;</code><br />
<code>#include &lt;unistd.h&gt;</code><br />
<code>#include &lt;openssl/bio.h&gt;</code><br />
<code>#include &lt;openssl/err.h&gt;</code><br />
<code>#include &lt;openssl/evp.h&gt;</code><br />
<code>#include &lt;openssl/pem.h&gt;</code><br />
<code>#include &lt;openssl/rsa.h&gt;</code><br />
<code>#include &lt;openssl/sha.h&gt;</code><br />
<code>#include &lt;openssl/x509.h&gt;</code><br />
<code>#include &lt;openssl/x509v3.h&gt;</code><br />
<code>#include &lt;stdio.h&gt;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
<code>#include &lt;sys/stat.h&gt;</code><br />
<code>#include &quot;VHQConfig.h&quot;</code><br />
<code>#include &quot;VHQDebug.h&quot;</code><br />
<code>#include &quot;VHQFileNames.h&quot;</code><br />
<code>#include &quot;VHQSecurity.h&quot;</code><br />
<code>#include &quot;VHQTypes.h&quot;</code><br />
<code>#include &quot;VHQUtils.h&quot;</code><br />
<code>#include &quot;VHQManager.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for VHQSecurity.c:</div>
<div class="dyncontent">
<div class="center"><img src="_v_h_q_security_8c__incl.png" border="0" usemap="#tmsagt_2src_2_v_h_q_security_2_v_h_q_security_8c" alt=""/></div>
<map name="tmsagt_2src_2_v_h_q_security_2_v_h_q_security_8c" id="tmsagt_2src_2_v_h_q_security_2_v_h_q_security_8c">
<area shape="rect" title=" " alt="" coords="1269,5,1447,47"/>
<area shape="rect" title=" " alt="" coords="5,95,68,121"/>
<area shape="rect" title=" " alt="" coords="92,95,179,121"/>
<area shape="rect" title=" " alt="" coords="203,95,265,121"/>
<area shape="rect" title=" " alt="" coords="289,95,368,121"/>
<area shape="rect" title=" " alt="" coords="393,95,467,121"/>
<area shape="rect" title=" " alt="" coords="492,95,600,121"/>
<area shape="rect" title=" " alt="" coords="624,95,729,121"/>
<area shape="rect" title=" " alt="" coords="753,95,865,121"/>
<area shape="rect" title=" " alt="" coords="889,95,1006,121"/>
<area shape="rect" title=" " alt="" coords="1031,95,1139,121"/>
<area shape="rect" title=" " alt="" coords="1163,95,1273,121"/>
<area shape="rect" title=" " alt="" coords="1298,95,1418,121"/>
<area shape="rect" title=" " alt="" coords="1442,95,1578,121"/>
<area shape="rect" title=" " alt="" coords="1602,95,1669,121"/>
<area shape="rect" title=" " alt="" coords="1693,95,1789,121"/>
<area shape="rect" title=" " alt="" coords="1813,95,1898,121"/>
<area shape="rect" title=" " alt="" coords="1922,95,2026,121"/>
<area shape="rect" title=" " alt="" coords="2051,95,2156,121"/>
<area shape="rect" title=" " alt="" coords="2180,95,2312,121"/>
<area shape="rect" title=" " alt="" coords="2337,95,2451,121"/>
<area shape="rect" title=" " alt="" coords="2476,95,2576,121"/>
<area shape="rect" title=" " alt="" coords="2601,95,2694,121"/>
<area shape="rect" title=" " alt="" coords="2719,95,2837,121"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:ad9d20261502cc111f476db968c3b0239"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#ad9d20261502cc111f476db968c3b0239">OPENSSL_NO_SHA256</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ad9d20261502cc111f476db968c3b0239"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d258f5cdc07ec2863a7e4e38c88c751"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#a2d258f5cdc07ec2863a7e4e38c88c751">VALIDATE_AGENT_PUB_KEY_CERTFILE</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a2d258f5cdc07ec2863a7e4e38c88c751"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5366e6bcd1d6f0d68372274755b70d47"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#a5366e6bcd1d6f0d68372274755b70d47">USE_X509_V3_EXTENSIONS</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a5366e6bcd1d6f0d68372274755b70d47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae42fe99dabf6cd6620e61e9d09e34735"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#ae42fe99dabf6cd6620e61e9d09e34735">CONFFileName1_</a>(x)&#160;&#160;&#160;#x</td></tr>
<tr class="separator:ae42fe99dabf6cd6620e61e9d09e34735"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06c7015ad1745241ce08a77f3daee997"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#a06c7015ad1745241ce08a77f3daee997">CONFFileName_</a>(x)&#160;&#160;&#160;<a class="el" href="_v_h_q_security_8c.html#ae42fe99dabf6cd6620e61e9d09e34735">CONFFileName1_</a>(x)</td></tr>
<tr class="separator:a06c7015ad1745241ce08a77f3daee997"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08ab33c14f0263471a0cbe2fd1140a82"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#a08ab33c14f0263471a0cbe2fd1140a82">CONFFileName</a>&#160;&#160;&#160;<a class="el" href="_v_h_q_security_8c.html#a06c7015ad1745241ce08a77f3daee997">CONFFileName_</a>(OPENSSL_CNF_FILE_NAME)</td></tr>
<tr class="separator:a08ab33c14f0263471a0cbe2fd1140a82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97977865819e7ccdc8c66e3c361ca86b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#a97977865819e7ccdc8c66e3c361ca86b">lib_VfiSecCrypto</a>&#160;&#160;&#160;&quot;libvfiVaultapi.so&quot;</td></tr>
<tr class="separator:a97977865819e7ccdc8c66e3c361ca86b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36c739d091f7274750d6009f7d9bc4e0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#a36c739d091f7274750d6009f7d9bc4e0">vfiSecCryptoReadFn</a>&#160;&#160;&#160;&quot;vfiSec_CwkRead&quot;</td></tr>
<tr class="separator:a36c739d091f7274750d6009f7d9bc4e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a088ffbf48ee2fd8f15ab7d19bc139b4b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#a088ffbf48ee2fd8f15ab7d19bc139b4b">vfiSecCryptoWriteFn</a>&#160;&#160;&#160;&quot;vfiSec_CwkWrite&quot;</td></tr>
<tr class="separator:a088ffbf48ee2fd8f15ab7d19bc139b4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade5d472b300abf17cf9facf13476778f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#ade5d472b300abf17cf9facf13476778f">DEBUG_AES_CMAC</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:ade5d472b300abf17cf9facf13476778f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab80d9463e945f22fd4d1f0b3209866c1"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#ab80d9463e945f22fd4d1f0b3209866c1">ENABLE_CRYPTO_RD_WR</a></td></tr>
<tr class="separator:ab80d9463e945f22fd4d1f0b3209866c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10e7e94564a62b7e1c397c46ee623540"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#a10e7e94564a62b7e1c397c46ee623540">SUBJ_KEY_ID_OBJ</a>&#160;&#160;&#160;&quot;X509v3 Subject Key Identifier&quot;</td></tr>
<tr class="separator:a10e7e94564a62b7e1c397c46ee623540"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a20899b937a16ba58997d8cdbec863384"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#a20899b937a16ba58997d8cdbec863384">JULY_30_2012</a>&#160;&#160;&#160;1343606400</td></tr>
<tr class="separator:a20899b937a16ba58997d8cdbec863384"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53a1c71ba07478eabafdad7a656e6a9b"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#a53a1c71ba07478eabafdad7a656e6a9b">SHA256_SIGNATURE</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a53a1c71ba07478eabafdad7a656e6a9b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a93c5f2f47e24553e52a40852c7c25c93"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#a93c5f2f47e24553e52a40852c7c25c93">MAX_MALLOC_SIZE</a>&#160;&#160;&#160;(1024 * 1024)</td></tr>
<tr class="separator:a93c5f2f47e24553e52a40852c7c25c93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4e38cf09cb23cb7050c5f3da52acf7a"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#aa4e38cf09cb23cb7050c5f3da52acf7a">COMMON_NAME_START_STR</a>&#160;&#160;&#160;&quot;/CN=&quot;</td></tr>
<tr class="separator:aa4e38cf09cb23cb7050c5f3da52acf7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06f99151643941d71f64109eef683d33"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#a06f99151643941d71f64109eef683d33">HOST_NAME_START_STR</a>&#160;&#160;&#160;&quot;://&quot;</td></tr>
<tr class="separator:a06f99151643941d71f64109eef683d33"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:accb8cb96a63c3b2481eca771daa53ac2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#accb8cb96a63c3b2481eca771daa53ac2">GetCertSerNum</a> (char *certfile, char *serial_num, int serial_num_len)</td></tr>
<tr class="separator:accb8cb96a63c3b2481eca771daa53ac2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14ec216733eca01b5c40973c918780e9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#a14ec216733eca01b5c40973c918780e9">GetPubKeyID</a> (char *certfile, char *pubkey_id, int pubkey_id_len)</td></tr>
<tr class="separator:a14ec216733eca01b5c40973c918780e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a139be7a11cb7f35aef619c2fadd815"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#a7a139be7a11cb7f35aef619c2fadd815">rand_serial</a> (BIGNUM *b, ASN1_INTEGER *ai)</td></tr>
<tr class="separator:a7a139be7a11cb7f35aef619c2fadd815"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afdbfc885d0ca6d5e2c3324e2d2359f0c"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#afdbfc885d0ca6d5e2c3324e2d2359f0c">AgentKeysExist</a> (void)</td></tr>
<tr class="separator:afdbfc885d0ca6d5e2c3324e2d2359f0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b595be14dc0e1de14ded83c24ccad74"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#a8b595be14dc0e1de14ded83c24ccad74">ReadPubKeyCertfile</a> (char **CertFile)</td></tr>
<tr class="separator:a8b595be14dc0e1de14ded83c24ccad74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99e1a9f115f523eb7aeed8870d44e3f9"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#a99e1a9f115f523eb7aeed8870d44e3f9">EncryptAgentKeys</a> (int flen, char *input, char *output, char *signature)</td></tr>
<tr class="separator:a99e1a9f115f523eb7aeed8870d44e3f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4537714f1bbccdacdc63078efebcc20"><td class="memItemLeft" align="right" valign="top">vhq_result_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#ad4537714f1bbccdacdc63078efebcc20">GenerateAgentKeys</a> (char *CertFile)</td></tr>
<tr class="separator:ad4537714f1bbccdacdc63078efebcc20"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0804e67f8294f16a0af8a1b6a813a944"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#a0804e67f8294f16a0af8a1b6a813a944">RemoveAgentKeys</a> (void)</td></tr>
<tr class="separator:a0804e67f8294f16a0af8a1b6a813a944"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f293f39a49114ef1324ca50fb833982"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#a8f293f39a49114ef1324ca50fb833982">VHQSecurityInit</a> (void)</td></tr>
<tr class="separator:a8f293f39a49114ef1324ca50fb833982"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afda52c9fc3f7bddeaaed44fa0a70096d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#afda52c9fc3f7bddeaaed44fa0a70096d">VHQSecurityReloadKeys</a> (void)</td></tr>
<tr class="separator:afda52c9fc3f7bddeaaed44fa0a70096d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2c6389474751089c72aedc6b9b40b12"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#ab2c6389474751089c72aedc6b9b40b12">VHQSecurityGenSig</a> (unsigned char *data_p, int data_len, unsigned char *sigbuf, int sigbuf_size)</td></tr>
<tr class="separator:ab2c6389474751089c72aedc6b9b40b12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4cdb8eb49d106c170959556d8fcad443"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#a4cdb8eb49d106c170959556d8fcad443">VHQSecurtiyVerifySignatureKey</a> (char *signing_key_id)</td></tr>
<tr class="separator:a4cdb8eb49d106c170959556d8fcad443"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8859f97bec0deda0341882499529c7a4"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#a8859f97bec0deda0341882499529c7a4">VHQSecurtiyGetSignatureKeyID</a> (char *signing_key_id, int signing_key_id_len)</td></tr>
<tr class="separator:a8859f97bec0deda0341882499529c7a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3e831287d87f19b9df01c0f2ed5dfbc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#ae3e831287d87f19b9df01c0f2ed5dfbc">VHQSecurityCalculateFileHash</a> (const char *pszFileName, dl_file_hash_algo_t eHashAlgo, unsigned char *pszFileHash, int pszFileHashSize, int *genHashLen)</td></tr>
<tr class="separator:ae3e831287d87f19b9df01c0f2ed5dfbc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08495d01c4b9fba2e2ab46519fa9dd0a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#a08495d01c4b9fba2e2ab46519fa9dd0a">VHQSecurityVerifyFileSignature</a> (const char *pszFileName, dl_file_hash_algo_t eHashAlgo, char *pszHash)</td></tr>
<tr class="separator:a08495d01c4b9fba2e2ab46519fa9dd0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92f023d88017b65d3dcfe9068d8c72a5"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#a92f023d88017b65d3dcfe9068d8c72a5">VHQSecurityGenSha1</a> (const char *filename, unsigned char *sha1_digest)</td></tr>
<tr class="separator:a92f023d88017b65d3dcfe9068d8c72a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ae81cce94b4abcbfdc4add0354c5d8a"><td class="memItemLeft" align="right" valign="top">time_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#a8ae81cce94b4abcbfdc4add0354c5d8a">GetCertExpiration</a> (char *file)</td></tr>
<tr class="separator:a8ae81cce94b4abcbfdc4add0354c5d8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ab2b922388c5c14e747c1236bdcc6a9ca"><td class="memItemLeft" align="right" valign="top">vhq_key_data_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#ab2b922388c5c14e747c1236bdcc6a9ca">VHQKeyData</a></td></tr>
<tr class="separator:ab2b922388c5c14e747c1236bdcc6a9ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace61880349f2723138198c40d828e2da"><td class="memItemLeft" align="right" valign="top">pthread_mutex_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_v_h_q_security_8c.html#ace61880349f2723138198c40d828e2da">securityMutex</a> = PTHREAD_MUTEX_INITIALIZER</td></tr>
<tr class="separator:ace61880349f2723138198c40d828e2da"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The VHQ security module for: Generating Keys Generating Signatures Validating Signatures </p>
</div><h2 class="groupheader">Macro Definition Documentation</h2>
<a id="aa4e38cf09cb23cb7050c5f3da52acf7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4e38cf09cb23cb7050c5f3da52acf7a">&#9670;&nbsp;</a></span>COMMON_NAME_START_STR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define COMMON_NAME_START_STR&#160;&#160;&#160;&quot;/CN=&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a08ab33c14f0263471a0cbe2fd1140a82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08ab33c14f0263471a0cbe2fd1140a82">&#9670;&nbsp;</a></span>CONFFileName</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONFFileName&#160;&#160;&#160;<a class="el" href="_v_h_q_security_8c.html#a06c7015ad1745241ce08a77f3daee997">CONFFileName_</a>(OPENSSL_CNF_FILE_NAME)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ae42fe99dabf6cd6620e61e9d09e34735"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae42fe99dabf6cd6620e61e9d09e34735">&#9670;&nbsp;</a></span>CONFFileName1_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONFFileName1_</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;#x</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a06c7015ad1745241ce08a77f3daee997"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06c7015ad1745241ce08a77f3daee997">&#9670;&nbsp;</a></span>CONFFileName_</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CONFFileName_</td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname">x</td><td>)</td>
          <td>&#160;&#160;&#160;<a class="el" href="_v_h_q_security_8c.html#ae42fe99dabf6cd6620e61e9d09e34735">CONFFileName1_</a>(x)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ade5d472b300abf17cf9facf13476778f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade5d472b300abf17cf9facf13476778f">&#9670;&nbsp;</a></span>DEBUG_AES_CMAC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DEBUG_AES_CMAC&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab80d9463e945f22fd4d1f0b3209866c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab80d9463e945f22fd4d1f0b3209866c1">&#9670;&nbsp;</a></span>ENABLE_CRYPTO_RD_WR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define ENABLE_CRYPTO_RD_WR</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a06f99151643941d71f64109eef683d33"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06f99151643941d71f64109eef683d33">&#9670;&nbsp;</a></span>HOST_NAME_START_STR</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define HOST_NAME_START_STR&#160;&#160;&#160;&quot;://&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a20899b937a16ba58997d8cdbec863384"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a20899b937a16ba58997d8cdbec863384">&#9670;&nbsp;</a></span>JULY_30_2012</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define JULY_30_2012&#160;&#160;&#160;1343606400</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a97977865819e7ccdc8c66e3c361ca86b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97977865819e7ccdc8c66e3c361ca86b">&#9670;&nbsp;</a></span>lib_VfiSecCrypto</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define lib_VfiSecCrypto&#160;&#160;&#160;&quot;libvfiVaultapi.so&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a93c5f2f47e24553e52a40852c7c25c93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a93c5f2f47e24553e52a40852c7c25c93">&#9670;&nbsp;</a></span>MAX_MALLOC_SIZE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define MAX_MALLOC_SIZE&#160;&#160;&#160;(1024 * 1024)</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad9d20261502cc111f476db968c3b0239"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9d20261502cc111f476db968c3b0239">&#9670;&nbsp;</a></span>OPENSSL_NO_SHA256</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OPENSSL_NO_SHA256&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a53a1c71ba07478eabafdad7a656e6a9b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53a1c71ba07478eabafdad7a656e6a9b">&#9670;&nbsp;</a></span>SHA256_SIGNATURE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SHA256_SIGNATURE&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a10e7e94564a62b7e1c397c46ee623540"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10e7e94564a62b7e1c397c46ee623540">&#9670;&nbsp;</a></span>SUBJ_KEY_ID_OBJ</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define SUBJ_KEY_ID_OBJ&#160;&#160;&#160;&quot;X509v3 Subject Key Identifier&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a5366e6bcd1d6f0d68372274755b70d47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5366e6bcd1d6f0d68372274755b70d47">&#9670;&nbsp;</a></span>USE_X509_V3_EXTENSIONS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define USE_X509_V3_EXTENSIONS&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a2d258f5cdc07ec2863a7e4e38c88c751"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d258f5cdc07ec2863a7e4e38c88c751">&#9670;&nbsp;</a></span>VALIDATE_AGENT_PUB_KEY_CERTFILE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define VALIDATE_AGENT_PUB_KEY_CERTFILE&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a36c739d091f7274750d6009f7d9bc4e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a36c739d091f7274750d6009f7d9bc4e0">&#9670;&nbsp;</a></span>vfiSecCryptoReadFn</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define vfiSecCryptoReadFn&#160;&#160;&#160;&quot;vfiSec_CwkRead&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a088ffbf48ee2fd8f15ab7d19bc139b4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a088ffbf48ee2fd8f15ab7d19bc139b4b">&#9670;&nbsp;</a></span>vfiSecCryptoWriteFn</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define vfiSecCryptoWriteFn&#160;&#160;&#160;&quot;vfiSec_CwkWrite&quot;</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="afdbfc885d0ca6d5e2c3324e2d2359f0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afdbfc885d0ca6d5e2c3324e2d2359f0c">&#9670;&nbsp;</a></span>AgentKeysExist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool AgentKeysExist </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function checks if agent keys exists in memory or not. </p><dl class="section return"><dt>Returns</dt><dd>void. </dd></dl>

</div>
</div>
<a id="a99e1a9f115f523eb7aeed8870d44e3f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99e1a9f115f523eb7aeed8870d44e3f9">&#9670;&nbsp;</a></span>EncryptAgentKeys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool EncryptAgentKeys </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>input</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>output</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>signature</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function encrypts agent keys to be send to server. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">flen</td><td>= length of agent key buffer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">input</td><td>= agent keys buffer. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">output</td><td>= encrypted keys. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signature</td><td>= signature from file.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE, if keys encrypted. </dd></dl>

</div>
</div>
<a id="ad4537714f1bbccdacdc63078efebcc20"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4537714f1bbccdacdc63078efebcc20">&#9670;&nbsp;</a></span>GenerateAgentKeys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vhq_result_t GenerateAgentKeys </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>CertFile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function generates agent keys and loads the keys into memory. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Certificate</td><td>file </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE, if keys generated. </dd></dl>

</div>
</div>
<a id="a8ae81cce94b4abcbfdc4add0354c5d8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ae81cce94b4abcbfdc4add0354c5d8a">&#9670;&nbsp;</a></span>GetCertExpiration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">time_t GetCertExpiration </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>file</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function gets the certificate expiration time to send to server. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">file</td><td>= filename</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>expiration time. </dd></dl>

</div>
</div>
<a id="accb8cb96a63c3b2481eca771daa53ac2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accb8cb96a63c3b2481eca771daa53ac2">&#9670;&nbsp;</a></span>GetCertSerNum()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool GetCertSerNum </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>certfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>serial_num</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>serial_num_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function gets serial number from a certificate. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">certfile</td><td>= file name </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">serial_num</td><td>= serial number. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">serial_num_len</td><td>= length of serial number buffer.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE, if serial number found. </dd></dl>

</div>
</div>
<a id="a14ec216733eca01b5c40973c918780e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14ec216733eca01b5c40973c918780e9">&#9670;&nbsp;</a></span>GetPubKeyID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool GetPubKeyID </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>certfile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>pubkey_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pubkey_id_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function gets the public key ID to send to server. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">certfile</td><td>= file name. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pubkey_id</td><td>= public key ID buffer. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pubkey_id_len</td><td>= public key ID buffer length.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE, if key found. </dd></dl>

</div>
</div>
<a id="a7a139be7a11cb7f35aef619c2fadd815"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a139be7a11cb7f35aef619c2fadd815">&#9670;&nbsp;</a></span>rand_serial()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int rand_serial </td>
          <td>(</td>
          <td class="paramtype">BIGNUM *&#160;</td>
          <td class="paramname"><em>b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">ASN1_INTEGER *&#160;</td>
          <td class="paramname"><em>ai</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8b595be14dc0e1de14ded83c24ccad74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b595be14dc0e1de14ded83c24ccad74">&#9670;&nbsp;</a></span>ReadPubKeyCertfile()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int ReadPubKeyCertfile </td>
          <td>(</td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>CertFile</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function reads the public key certificate from file to be sent to server. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">CertFile</td><td>= pointer to public key read.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>number of objects read from public key file, if success. </dd></dl>

</div>
</div>
<a id="a0804e67f8294f16a0af8a1b6a813a944"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0804e67f8294f16a0af8a1b6a813a944">&#9670;&nbsp;</a></span>RemoveAgentKeys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void RemoveAgentKeys </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function removes the agent keys from memory and request for re-registration if required.</p>
<dl class="section return"><dt>Returns</dt><dd>void. </dd></dl>

</div>
</div>
<a id="ae3e831287d87f19b9df01c0f2ed5dfbc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3e831287d87f19b9df01c0f2ed5dfbc">&#9670;&nbsp;</a></span>VHQSecurityCalculateFileHash()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VHQSecurityCalculateFileHash </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pszFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dl_file_hash_algo_t&#160;</td>
          <td class="paramname"><em>eHashAlgo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>pszFileHash</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>pszFileHashSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int *&#160;</td>
          <td class="paramname"><em>genHashLen</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function computes the SHA1 hash for a file. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pszFileName</td><td>= file name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eHashAlgo</td><td>= hash algorithm type </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">pszFileHash</td><td>= calculated hash </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pszFileHashSize</td><td>= expected calculated file hash size. </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">genHashLen</td><td>= calculated hash length.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="a92f023d88017b65d3dcfe9068d8c72a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92f023d88017b65d3dcfe9068d8c72a5">&#9670;&nbsp;</a></span>VHQSecurityGenSha1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool VHQSecurityGenSha1 </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>sha1_digest</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function computes the SHA1 message digest for data in a file. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">filename</td><td>= file name </td></tr>
    <tr><td class="paramdir">[out]</td><td class="paramname">sha1_digest</td><td>= sha1 message.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE ,if success </dd></dl>

</div>
</div>
<a id="ab2c6389474751089c72aedc6b9b40b12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2c6389474751089c72aedc6b9b40b12">&#9670;&nbsp;</a></span>VHQSecurityGenSig()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool VHQSecurityGenSig </td>
          <td>(</td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>data_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>data_len</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned char *&#160;</td>
          <td class="paramname"><em>sigbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>sigbuf_size</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function generates the signature. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data_p</td><td>= input string </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">data_len</td><td>= length of data_p </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sigbuf</td><td>= buffer to store signature data into </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">sigbuf_size</td><td>= size of signature data buffer</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE, if success; FALSE, otherwise </dd></dl>

</div>
</div>
<a id="a8f293f39a49114ef1324ca50fb833982"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f293f39a49114ef1324ca50fb833982">&#9670;&nbsp;</a></span>VHQSecurityInit()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VHQSecurityInit </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function removes the agent keys and reloads it if the device is tampered. </p><dl class="section return"><dt>Returns</dt><dd>void. </dd></dl>

</div>
</div>
<a id="afda52c9fc3f7bddeaaed44fa0a70096d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afda52c9fc3f7bddeaaed44fa0a70096d">&#9670;&nbsp;</a></span>VHQSecurityReloadKeys()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void VHQSecurityReloadKeys </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function reloads all the agent keys. </p><dl class="section return"><dt>Returns</dt><dd>void </dd></dl>

</div>
</div>
<a id="a08495d01c4b9fba2e2ab46519fa9dd0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08495d01c4b9fba2e2ab46519fa9dd0a">&#9670;&nbsp;</a></span>VHQSecurityVerifyFileSignature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool VHQSecurityVerifyFileSignature </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>pszFileName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">dl_file_hash_algo_t&#160;</td>
          <td class="paramname"><em>eHashAlgo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>pszHash</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function compares the the SHA1 message digest for file and the hash received from server. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">pszFileName</td><td>= file name. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">eHashAlgo</td><td>= hash algorithm type </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">pszHash</td><td>= received hash value from server.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE ,if hash matched. </dd></dl>

</div>
</div>
<a id="a8859f97bec0deda0341882499529c7a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8859f97bec0deda0341882499529c7a4">&#9670;&nbsp;</a></span>VHQSecurtiyGetSignatureKeyID()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool VHQSecurtiyGetSignatureKeyID </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>signing_key_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>signing_key_id_len</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function gets the signature key ID to send to server. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">signing_key_id</td><td>= signing key ID found. </td></tr>
    <tr><td class="paramdir">[in]</td><td class="paramname">signing_key_id_len</td><td>= expected length of signing key id.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE, if found. </dd></dl>

</div>
</div>
<a id="a4cdb8eb49d106c170959556d8fcad443"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4cdb8eb49d106c170959556d8fcad443">&#9670;&nbsp;</a></span>VHQSecurtiyVerifySignatureKey()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool VHQSecurtiyVerifySignatureKey </td>
          <td>(</td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>signing_key_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function compares the signature key received from server with expected key. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">signing_key_id</td><td>= signature recieved.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>TRUE, if signature matches. </dd></dl>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ace61880349f2723138198c40d828e2da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace61880349f2723138198c40d828e2da">&#9670;&nbsp;</a></span>securityMutex</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pthread_mutex_t securityMutex = PTHREAD_MUTEX_INITIALIZER</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab2b922388c5c14e747c1236bdcc6a9ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2b922388c5c14e747c1236bdcc6a9ca">&#9670;&nbsp;</a></span>VHQKeyData</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vhq_key_data_t VHQKeyData</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_30aba3d9bf6279a25d84abe4015711f7.html">tmsagt</a></li><li class="navelem"><a class="el" href="dir_f7a957c8f5c8e80b5a8d4b37f193d419.html">src</a></li><li class="navelem"><a class="el" href="dir_7446380d78c4ab06b0f88c68276c07b1.html">VHQSecurity</a></li><li class="navelem"><a class="el" href="_v_h_q_security_8c.html">VHQSecurity.c</a></li>
    <li class="footer">Generated on Mon Jun 16 2025 16:03:57 for ADK-Programmers-Guides by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
