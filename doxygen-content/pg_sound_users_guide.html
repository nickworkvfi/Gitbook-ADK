<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ADK-Programmers-Guides: ADK-SOUND Programmers Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="verifone.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="verifonelogo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ADK-Programmers-Guides
   &#160;<span id="projectnumber">5.0.3-CD1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('pg_sound_users_guide.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">ADK-SOUND Programmers Guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="snd_preface"></a>
Preface</h1>
<p>This document is for programmers and developers who want to understand and use the ADK-Sound framework.</p>
<h2><a class="anchor" id="snd_audience"></a>
Audience</h2>
<p>This guide provides information on the usage of the ADK-Sound system.</p>
<h2><a class="anchor" id="snd_organization"></a>
Organization</h2>
<p><a class="el" href="pg_sound_users_guide.html#snd_introduction">Chapter 1: Introduction</a></p>
<p><a class="el" href="pg_sound_users_guide.html#snd_hw_support">Chapter 2: Supported Hardware</a></p>
<p><a class="el" href="pg_sound_users_guide.html#snd_getting_started">Chapter 3: Getting Started</a></p>
<p><a class="el" href="pg_sound_users_guide.html#snd_programming">Chapter 4: Programming</a></p>
<p><a class="el" href="pg_sound_users_guide.html#snd_setup">Chapter 5: System Setup and Requirements</a></p>
<h1><a class="anchor" id="snd_introduction"></a>
Introduction</h1>
<p>ADK-Sound allows simple playback of MP3 and WAV files. Playback can be started and stopped and the playback position within the file may be updated.</p>
<h1><a class="anchor" id="snd_hw_support"></a>
Supported Hardware</h1>
<p>VOS and VOS2 terminals with speaker are supported. Currently Verix terminals are not supported.</p>
<h1><a class="anchor" id="snd_getting_started"></a>
Getting Started</h1>
<p>The following minimal program shows how to play a sound in a loop</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="sound_8h.html">sound/sound.h</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> cb(<span class="keywordtype">void</span> *data, <a class="code" href="sound_8h.html#a520814ffd85c7975c652a3bb5500430b">SND</a> *handle, <span class="keyword">enum</span> <a class="code" href="sound_8h.html#a2a29b5498b5650f52341ae534f4c7df6">SNDError</a> reason)</div>
<div class="line">{</div>
<div class="line">   <span class="keywordflow">if</span>(reason!=<a class="code" href="sound_8h.html#a2a29b5498b5650f52341ae534f4c7df6a390962805c51d9a4e0352bf1c8d132ca">SND_OK</a>) <span class="keywordflow">return</span>;</div>
<div class="line">   <a class="code" href="sound_8h.html#a8f0945ea304cff2a5b223186b73087f7">sndSeek</a>(handle,0,SEEK_SET); <span class="comment">// rewind to start</span></div>
<div class="line">   <a class="code" href="sound_8h.html#a6074c9bf1534c6e8e10ed0e3c72897cf">sndStart</a>(handle);           <span class="comment">// start playback again</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>()</div>
<div class="line">{</div>
<div class="line">   <a class="code" href="sound_8h.html#a520814ffd85c7975c652a3bb5500430b">SND</a> *handle=<a class="code" href="sound_8h.html#a2e0076124852060867cc4039c1719646">sndOpenFile</a>(<span class="stringliteral">&quot;sound.mp3&quot;</span>);</div>
<div class="line">   <a class="code" href="sound_8h.html#a7964d1213f6f330b9cf1a16dd4973826">sndSetCallback</a>(handle,cb,0); <span class="comment">// callback gets invoked when the sound stopped</span></div>
<div class="line">   <a class="code" href="sound_8h.html#a6074c9bf1534c6e8e10ed0e3c72897cf">sndStart</a>(handle); <span class="comment">// start playback</span></div>
<div class="line">   <span class="keywordflow">while</span>(1) sleep(100000); <span class="comment">// do nothing, sound plays in background</span></div>
<div class="line">}</div>
</div><!-- fragment --><h1><a class="anchor" id="snd_programming"></a>
Programming</h1>
<h2><a class="anchor" id="snd_open_close"></a>
Opening and Closing files</h2>
<p>To play a sound the file needs to be opened using <a class="el" href="sound_8h.html#a2e0076124852060867cc4039c1719646">sndOpenFile()</a>. In case of success a handle is returned, that needs to be provided to the other functions. The handle needs to be closed using <a class="el" href="sound_8h.html#aac877336c270fa31b7396dd9e01a0ee5">sndClose()</a> when done to release the allocated resources. When closing the handle, sound playback is stopped automatically, when still playing.</p>
<h2><a class="anchor" id="snd_start_stop"></a>
Starting and Stopping playback</h2>
<p><a class="el" href="sound_8h.html#a6074c9bf1534c6e8e10ed0e3c72897cf">sndStart()</a> starts playback at the current position. When the file has just been opened, this is the start of the file. The position can be updated anytime using <a class="el" href="sound_8h.html#a8f0945ea304cff2a5b223186b73087f7">sndSeek()</a>. <a class="el" href="sound_8h.html#a3fbd83f5f49d41b445b1e9dd8bc82c0f">sndStop()</a> is used to stop playback. Stopping playback does not reset the current position to the start of the file so that <a class="el" href="sound_8h.html#a6074c9bf1534c6e8e10ed0e3c72897cf">sndStart()</a> can be used to resume playback at the position it was stopped.</p>
<h2><a class="anchor" id="snd_mist"></a>
Miscellaneous functions</h2>
<p>The current position can be read using <a class="el" href="sound_8h.html#a701ee6a24c4fcffacf3ec555c92caf97">sndTell()</a>. The position is given in seconds from the start of the file.</p>
<p><a class="el" href="sound_8h.html#ae7e8fbfe734a79cf6648515fb7758f12">sndLength()</a> returns the estimated length of the file. Note that the estimated length may differ from the real length since for MP3 files it may not be possible to determine the real length without scanning the whole file, which may be slow.</p>
<p>If an application needs to know the real length, it can use <a class="el" href="sound_8h.html#a8f0945ea304cff2a5b223186b73087f7">sndSeek()</a> to seek to the end of the file and use <a class="el" href="sound_8h.html#a701ee6a24c4fcffacf3ec555c92caf97">sndTell()</a> to obtain the position.</p>
<h2><a class="anchor" id="snd_setup"></a>
System Setup and Requirements</h2>
<p>ADK-Sound uses ALSA for sound output. Therefore, the terminal needs to have ALSA support. By default concurrent playback of several sound sources is not supported. To enable concurrent playback, the ALSA dmix plugin must have been set up as default output device. This plugin mixes several sound sources into one stream that is sent to the sound hardware.</p>
<p>There are two ways of setting up the ALSA dmix plugin:</p><ul>
<li>global configuration in /etc/asound.conf</li>
<li>local configuration in ~/.asoundrc</li>
</ul>
<p>The global configuration needs to be provided by the OS and affects all programs on the terminal. The local configuration can be provided by any application but affects only applications run by the same user. However, if one user still uses the default output and not dmix, this user will use the sound output exclusively.</p>
<p>A starting point for an ALSA configuration looks like this:</p>
<pre class="fragment">pcm.snd_card {
        type hw
        card 0
        device 0
}

ctl.snd_card {
        type hw
        card 0
        device 0
}

# Define dmix-Plugin
pcm.dmixer {
    type dmix
    ipc_key 1024
    ipc_perm 0666       # Allow other users to use dmix
    slave.pcm "snd_card"
}

pcm.dsnooper {
    type dsnoop
    ipc_key 2048
    ipc_perm 0666
    slave.pcm "snd_card"
}

pcm.duplex {
    type asym
    playback.pcm "dmixer"
    capture.pcm "dsnooper"
}

pcm.!default {
    type plug
    slave.pcm "duplex"
}
</pre><p>For more information check the ALSA documentation. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<div class="ttc" id="asound_8h_html_a2a29b5498b5650f52341ae534f4c7df6"><div class="ttname"><a href="sound_8h.html#a2a29b5498b5650f52341ae534f4c7df6">SNDError</a></div><div class="ttdeci">SNDError</div><div class="ttdef"><b>Definition:</b> sound.h:38</div></div>
<div class="ttc" id="asound_8h_html_a520814ffd85c7975c652a3bb5500430b"><div class="ttname"><a href="sound_8h.html#a520814ffd85c7975c652a3bb5500430b">SND</a></div><div class="ttdeci">struct SND SND</div><div class="ttdef"><b>Definition:</b> sound.h:35</div></div>
<div class="ttc" id="asound_8h_html_a8f0945ea304cff2a5b223186b73087f7"><div class="ttname"><a href="sound_8h.html#a8f0945ea304cff2a5b223186b73087f7">sndSeek</a></div><div class="ttdeci">DllSpec enum SNDError sndSeek(struct SND *handle, double pos, int whence)</div></div>
<div class="ttc" id="asound_8h_html_a2a29b5498b5650f52341ae534f4c7df6a390962805c51d9a4e0352bf1c8d132ca"><div class="ttname"><a href="sound_8h.html#a2a29b5498b5650f52341ae534f4c7df6a390962805c51d9a4e0352bf1c8d132ca">SND_OK</a></div><div class="ttdeci">@ SND_OK</div><div class="ttdef"><b>Definition:</b> sound.h:39</div></div>
<div class="ttc" id="asound_8h_html_a7964d1213f6f330b9cf1a16dd4973826"><div class="ttname"><a href="sound_8h.html#a7964d1213f6f330b9cf1a16dd4973826">sndSetCallback</a></div><div class="ttdeci">DllSpec void sndSetCallback(struct SND *handle, SNDCallback cb, void *data)</div></div>
<div class="ttc" id="asound_8h_html_a6074c9bf1534c6e8e10ed0e3c72897cf"><div class="ttname"><a href="sound_8h.html#a6074c9bf1534c6e8e10ed0e3c72897cf">sndStart</a></div><div class="ttdeci">DllSpec enum SNDError sndStart(struct SND *handle)</div></div>
<div class="ttc" id="asound_8h_html_a2e0076124852060867cc4039c1719646"><div class="ttname"><a href="sound_8h.html#a2e0076124852060867cc4039c1719646">sndOpenFile</a></div><div class="ttdeci">DllSpec struct SND * sndOpenFile(const char *filename)</div></div>
<div class="ttc" id="asound_8h_html"><div class="ttname"><a href="sound_8h.html">sound.h</a></div></div>
<div class="ttc" id="amain_8cpp_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="main_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> main.cpp:1237</div></div>
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">Application Development Kit (ADK)</a></li><li class="navelem"><a class="el" href="system_overview.html">System Overview</a></li><li class="navelem"><a class="el" href="pg_all_components.html">ADK Components</a></li>
    <li class="footer">Generated on Mon Jun 16 2025 16:04:02 for ADK-Programmers-Guides by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
