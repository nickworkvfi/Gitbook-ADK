<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ADK-Programmers-Guides: ADK-AST Programmers Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="verifone.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="verifonelogo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ADK-Programmers-Guides
   &#160;<span id="projectnumber">5.0.3-CD1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('pg_ast_users_guide.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">ADK-AST Programmers Guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="Preface"></a>
Preface</h1>
<p>This guide provides information of the functionality and usage of ADK Anti Skimming Tool (AST) application.</p>
<h2><a class="anchor" id="subsec_ast_audience"></a>
Audience</h2>
<p>This document is meant for programmers who want to understand and use ADK Anti Skimming Tool application.</p>
<h2><a class="anchor" id="subsec_ast_organization"></a>
Organization</h2>
<p>This guide is organized as follows:</p>
<p><a class="el" href="pg_ast_users_guide.html#sec_ast_introduction">Chapter 1, Introduction</a>: Introduction to ADK-AST.</p>
<p><a class="el" href="pg_ast_users_guide.html#sec_ast_getting_started">Chapter 2, Getting Started</a>: Explains concept.</p>
<p><a class="el" href="pg_ast_users_guide.html#sec_ast_programming">Chapter 3, Programming</a>: Presents common uses.</p>
<p><a class="el" href="pg_ast_users_guide.html#sec_ast_compile">Chapter 4, System Setup and Requirements</a>: Environment setup, installation and dependencies to other components.</p>
<p><a class="el" href="pg_ast_users_guide.html#sec_ast_troubleshooting">Chapter 5, Troubleshooting</a>: Solutions for possible issues.</p>
<p><a class="el" href="pg_systools_timezone_change.html#sec_ast_glossary">Appendix: Glossary</a>: Listing and definitions of various acronyms and terms</p>
<h1><a class="anchor" id="sec_ast_introduction"></a>
Introduction</h1>
<p>Anti-Skimming device is implemented to perform distance measurment between card reader slot and surface of keypad to detect overlay that may occur in case of abuse of the terminal.</p>
<h1><a class="anchor" id="sec_ast_getting_started"></a>
Getting Started</h1>
<h2><a class="anchor" id="sec_ast_concepts"></a>
Concepts</h2>
<p>AST (Anti-Skimming Tool) is an ADK application which interacts with anti-skimming detection device. Anti-Skimming device is realised as a Probe (card) that can be inserted in card reader. Anti-Skimming tool is supported by Engage multi-line devices (e.g. Mx925, Mx915, M440, M425, M400) and can be delivered as:</p><ul>
<li>AST - as ADK component</li>
<li>or ASTS - Standalone version (by loading Anti Skimming Tool Standalone (ASTS) signed application and VHQ Agent).</li>
</ul>
<p>An operator (a person who checks terminals with AST Probe) initiates Anti-Skimming test application on the terminal and inserts the Probe. This Probe checks card slot thickness and reports a result to the terminal. Terminal saves every test result in a separate json encoded report file. Report file is stored in /home/sys13/logs/ast folder. File name is identical to timestamp. File example: /home/sys13/logs/ast/7001076.txt Only last twenty reports will be stored on filesytem. After test execution, created log files are sent to VHQ/VeriCare system. An Estate Owner (person who reviews reports from Anti-Skimming Tool), has an acces to VHQ/VeriCare dashboard of anti-skimming checks.</p>
<p>The Probe has built-in LED indicators that provides a result of test status:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Led color </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">white </td><td class="markdownTableBodyNone">Power  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">green </td><td class="markdownTableBodyNone">Pass test  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">red </td><td class="markdownTableBodyNone">Fail test  </td></tr>
</table>
<h3><a class="anchor" id="subsubsec_log_file_content"></a>
Log file content</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Field </th><th class="markdownTableHeadNone">Type </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">description </td><td class="markdownTableBodyNone">string </td><td class="markdownTableBodyNone">Status description  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">probe_sn </td><td class="markdownTableBodyNone">string </td><td class="markdownTableBodyNone">Anti skimming device serial number  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">return_code </td><td class="markdownTableBodyNone">int </td><td class="markdownTableBodyNone">Code returned by libCR-Skimmer  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">status </td><td class="markdownTableBodyNone">int </td><td class="markdownTableBodyNone">Error code  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">terminal_sn </td><td class="markdownTableBodyNone">string </td><td class="markdownTableBodyNone">Terminal serial number  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">timestamp </td><td class="markdownTableBodyNone">int </td><td class="markdownTableBodyNone">Unix timestamp  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">vhq_status </td><td class="markdownTableBodyNone">int </td><td class="markdownTableBodyNone">Need to clarify  </td></tr>
</table>
<h3><a class="anchor" id="subsubsec_test_result_status"></a>
Test result status</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Status </th><th class="markdownTableHeadNone">Description </th><th class="markdownTableHeadNone">Anti-Skimming device led color  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">0 </td><td class="markdownTableBodyNone">No overlay detected </td><td class="markdownTableBodyNone">Green  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">1 </td><td class="markdownTableBodyNone">Probe is not detected </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2 </td><td class="markdownTableBodyNone">Probe communication error </td><td class="markdownTableBodyNone"></td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">3 </td><td class="markdownTableBodyNone">Overlay detected </td><td class="markdownTableBodyNone">Red  </td></tr>
</table>
<h3><a class="anchor" id="subsubsec_return_code_values"></a>
Return_code values</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Code </th><th class="markdownTableHeadNone">Value </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">SKIMRC_Success </td><td class="markdownTableBodyNone">0 </td><td class="markdownTableBodyNone">Operation was successful  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SKIMRC_Failure </td><td class="markdownTableBodyNone">1 </td><td class="markdownTableBodyNone">Operation failed  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">SKIMRC_Error_Power_Action </td><td class="markdownTableBodyNone">2 </td><td class="markdownTableBodyNone">Power-Up operation failed  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SKIMRC_Error_Not_Supported </td><td class="markdownTableBodyNone">3 </td><td class="markdownTableBodyNone">Skimmer probe type not supported  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">SKIMRC_Error_BadParam </td><td class="markdownTableBodyNone">4 </td><td class="markdownTableBodyNone">A function parameter is invalid  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">SKIMRC_Error_Protocol </td><td class="markdownTableBodyNone">5 </td><td class="markdownTableBodyNone">Communication error with skimmer probe  </td></tr>
</table>
<h3><a class="anchor" id="subsubsec_report_file_example"></a>
Report file example</h3>
<div class="fragment"><div class="line">{<span class="stringliteral">&quot;description&quot;</span>:<span class="stringliteral">&quot;No overlay detected&quot;</span>,<span class="stringliteral">&quot;probe_sn&quot;</span>:<span class="stringliteral">&quot;A01E900714241000317C57A000A0000019&quot;</span>,<span class="stringliteral">&quot;return_code&quot;</span>:0,<span class="stringliteral">&quot;status&quot;</span>:0,<span class="stringliteral">&quot;terminal_sn&quot;</span>:<span class="stringliteral">&quot;275-159-718&quot;</span>,<span class="stringliteral">&quot;timestamp&quot;</span>:1597099642,<span class="stringliteral">&quot;vhq_status&quot;</span>:5010} </div>
</div><!-- fragment --><h3><a class="anchor" id="subsubsec_container_diagram"></a>
Container diagram for Anti-Skimming Tool</h3>
<div class="image">
<img src="ast_top_level_context_diagram.png" alt=""/>
<div class="caption">
MAC desktop</div></div>
 <h3><a class="anchor" id="subsubsec_top_level_context_diagram"></a>
Top level Context diagram for Anti-Skimming Tool</h3>
<div class="image">
<img src="ast_container_diagram.png" alt=""/>
</div>
 <h3><a class="anchor" id="subsubsec_component_diagram"></a>
Component diagram for Anti-Skimming test Application</h3>
<div class="image">
<img src="ast_component_diagram_test_tool_app.png" alt=""/>
</div>
 <h2><a class="anchor" id="subsec_ast_upload_to_vhq_server"></a>
Upload to VHQ Server</h2>
<p>Anti-Skimming application calls VHQ Agent API, after the Anti-Skimming device interaction log file is generated. VHQ Agent generates a new event message, based on the data passed by the Anti-Skimming test application and send it to the server. VHQ Server receives the event message, parse it and display in the VHQ UI.</p>
<div class="image">
<img src="ast_upload_to_vhq_server.png" alt=""/>
</div>
 <h1><a class="anchor" id="sec_ast_compile"></a>
Environment setup, installation and dependencies to other components</h1>
<h2><a class="anchor" id="subsec_ast_setup"></a>
Setup and installation</h2>
<p>AST release consists of multiple packages:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Package name </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">dl.ast-3.71.6.tgz </td><td class="markdownTableBodyNone">AST application (ADK environment)  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">dl.asts-3.71.6.tgz </td><td class="markdownTableBodyNone">AST application (standalone)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">dl.ast-remove-3.71.6.tgz </td><td class="markdownTableBodyNone">AST removal package  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">dl.asts-remove-3.71.6.tgz </td><td class="markdownTableBodyNone">AST removal package  </td></tr>
</table>
<dl class="section note"><dt>Note</dt><dd>Removal packages are not needed for regular use. They are needed only if you need to downgrade AST version</dd></dl>
<p>AST requires ADK. Available as part of these ADK deliveries - ADK-4.4.23, ADK-4.6.12, ADK-4.7.5.</p>
<p>Supported AST languages:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Language </th><th class="markdownTableHeadCenter">Catalogue File  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter">English </td><td class="markdownTableBodyCenter">en-US.ctlg  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyCenter">French </td><td class="markdownTableBodyCenter">fr-FR.ctlg  </td></tr>
</table>
<p>The default AST language is English.</p>
<p>At the first launch, AST will request to select language after installation. AST memorise this selection for the following usage and don't ask for language again. To change the language one more time need reinstall the AST bundle.</p>
<h2><a class="anchor" id="subsec_ast_vs_asts"></a>
AST comparison with ASTS:</h2>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">AST </th><th class="markdownTableHeadNone">ASTS  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">GUI interface </td><td class="markdownTableBodyNone">No GUI interface  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Runs as system user (sys13) </td><td class="markdownTableBodyNone">Runs as system user (sys12)  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Cleaner approach to killing applications </td><td class="markdownTableBodyNone">No cleaner approach to Killing applications  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">All dependencies are already included in ADK release </td><td class="markdownTableBodyNone">Very limited dependencies to V/OS APIs  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Available as part of ADK </td><td class="markdownTableBodyNone">Does not require ADK, can run on old V/OS releases  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Does not require VHQ agent update </td><td class="markdownTableBodyNone">Requires VHQ agent update  </td></tr>
</table>
<p><b>AST</b> <b>dependencies:</b> </p><ul>
<li>GUI interface</li>
<li>MAC</li>
<li>VHQ Agent</li>
</ul>
<p><b>ASTS</b> <b>dependencies:</b> </p><ul>
<li>VHQ currently supports two release lines that support ASTS:<ul>
<li>version 2.17.20 and up</li>
<li>version 3.2.6 and up</li>
</ul>
</li>
<li>CR-Skimmer library (dl.skimmerdetect-1.0.2-4)</li>
</ul>
<h1><a class="anchor" id="sec_ast_programming"></a>
Programming</h1>
<h2><a class="anchor" id="subsec_common_uses"></a>
Common uses</h2>
<h3><a class="anchor" id="subsubsec_ast_common_uses"></a>
AST usage in ADK environment</h3>
<ul>
<li>Press X+3 to get to ADK desktop</li>
<li>Press AST icon on ADK desktop</li>
<li>ADK will stop running payment applications and initiate communication with probe</li>
<li>AST app will wait for probe for 30 seconds</li>
<li>If probe is inserted AST will generate a report and store it on file system in /home/sys13/logs/ast folder.</li>
<li>It will also pass same report to VHQ agent</li>
<li>After that ADK applications will be restarted</li>
</ul>
<h3><a class="anchor" id="subsubsec_asts_common_uses"></a>
ASTS usage</h3>
<ul>
<li>ASTS boots at system startup. It sits in a background and awaits for specific key combination - X + 0 + 2 (Red key + Green key + 2).</li>
<li>When user presses this combination, ASTS will start sysmode, which results in stopping payment application.</li>
<li>Then ASTS will initiate communication with the probe.</li>
<li>If probe is inserted AST will generate a report and store it on file system in /home/sys12/logs/asts folder.</li>
<li>It will also pass same report to VHQ agent.</li>
<li>After that it will restart applications.</li>
</ul>
<h1><a class="anchor" id="sec_ast_troubleshooting"></a>
Troubleshooting</h1>
<h2><a class="anchor" id="subsec_ast_FAQ"></a>
FAQ</h2>
<p>Q: What is the difference between AST and ASTS?</p>
<p>A: AST application is designed to work in ADK environment. ASTS - is stand alone version, which doesn't require ADK.</p>
<h2><a class="anchor" id="subsec_ast_logging"></a>
Logging</h2>
<p>AST is using ADK-LOG component for logging. Please refer to the ADK-LOG documentation for details. Used logging channels:</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Logging channel </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">AST </td><td class="markdownTableBodyNone"><a class="el" href="pg_ast_users_guide.html#sec_ast_concepts">AST application logs</a>  </td></tr>
</table>
<h2><a class="anchor" id="Debugging"></a>
Debugging</h2>
<h1><a class="anchor" id="sec_ast_glossary"></a>
Appendix: Glossary</h1>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Term </th><th class="markdownTableHeadNone">Description  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ADK </td><td class="markdownTableBodyNone">Application Development Kit  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">API </td><td class="markdownTableBodyNone">Application Program Interface  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">AST </td><td class="markdownTableBodyNone">Anti-Skimming Tool  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ASTS </td><td class="markdownTableBodyNone">Anti-Skimming Stand alone Application  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">GUI </td><td class="markdownTableBodyNone">Graphical User Interface  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">UI </td><td class="markdownTableBodyNone">User Interface  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">OS </td><td class="markdownTableBodyNone">Operating System  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">HTML </td><td class="markdownTableBodyNone">Hypertext Markup Language  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">JSON </td><td class="markdownTableBodyNone">JavaScript object notation  </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">HW </td><td class="markdownTableBodyNone">Hardware  </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Sysmode </td><td class="markdownTableBodyNone">V/OS system application.  </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">Application Development Kit (ADK)</a></li><li class="navelem"><a class="el" href="pg_system_tools.html">System Tools</a></li>
    <li class="footer">Generated on Mon Jun 16 2025 16:04:00 for ADK-Programmers-Guides by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
