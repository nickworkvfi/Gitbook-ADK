<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ADK-Programmers-Guides: GDA Programmers Guide</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="verifone.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="verifonelogo.jpg"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ADK-Programmers-Guides
   &#160;<span id="projectnumber">5.0.3-CD1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('pg_gda_users_guide.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">GDA Programmers Guide </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="sec_gda_introduction"></a>
Introduction</h1>
<h2><a class="anchor" id="subsec_gda_preface"></a>
Purpose</h2>
<p>This guide provides information on the usage of the Diagnostic Application.</p>
<h2><a class="anchor" id="subsubsec_gda_hardware_support"></a>
Hardware Support</h2>
<p>The Diagnostic application is currently supported on Engage devices - V200c, V400M, V240M.</p>
<h2><a class="anchor" id="subsec_gda_organization"></a>
Organization</h2>
<p>This guide is organized as follows: </p><dl class="section user"><dt></dt><dd><a class="el" href="pg_gda_users_guide.html#sec_gda_overview">Chapter 1, Overview</a>: Provides an overview of the Diagnostic application. </dd></dl>
<dl class="section user"><dt></dt><dd><a class="el" href="pg_gda_users_guide.html#sec_gda_HelpInfo">Chapter 2, Help and Tamper Information</a>: Guides in populating the help information. </dd></dl>
<dl class="section user"><dt></dt><dd><a class="el" href="pg_gda_users_guide.html#sec_gda_usinggda">Chapter 3, Using the Diagnostic application by payment application</a>: Gives list of APIs that the payment application can use to display diagnostics.</dd></dl>
<h1><a class="anchor" id="sec_gda_overview"></a>
Overview</h1>
<p>This chapter presents a short introduction to the Diagnostic application</p>
<h2><a class="anchor" id="sec_gda_overview_main_screen"></a>
Diagnostic Main Screen</h2>
<p>The Diagnostic application is a tool which provides basic diagnosis of componenents. This application can be invoked from the MAC screen and also by any payment application.</p>
<p>The landing page or the Main screen consists of the traffic light status indications for different componenents. Currently, the diagnostic application supports only Battery and Memory Components. This page also consists of the Battery temperature and charge level along with number of Contact,Contactless and MSR transactions performed on the terminal. Below is the sample landing page.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter"></th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><div class="image">
<img src="LandingPage.png" alt=""/>
</div>
      </td></tr>
</table>
<p>In case Device is tampered, the landing page will contain a QR code with useful URLs. Below is the sample landing page in case device is tampered.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter"></th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><div class="image">
<img src="Tampered.png" alt=""/>
</div>
      </td></tr>
</table>
<p>The detail diagnostics can be navigated from the landing page on Enter button. The detail diagnostics contains widgets for each component information. Below are the screenshots for some of the widgets.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter">Summary </th><th class="markdownTableHeadCenter">Device </th><th class="markdownTableHeadCenter">Battery </th><th class="markdownTableHeadCenter">Memory </th><th class="markdownTableHeadCenter">Help  </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><div class="image">
<img src="Summary.png" alt=""/>
</div>
     </td><td class="markdownTableBodyCenter"><div class="image">
<img src="Device.png" alt=""/>
</div>
     </td><td class="markdownTableBodyCenter"><div class="image">
<img src="Battery.png" alt=""/>
</div>
     </td><td class="markdownTableBodyCenter"><div class="image">
<img src="Memory.png" alt=""/>
</div>
     </td><td class="markdownTableBodyCenter"><div class="image">
<img src="Help.png" alt=""/>
</div>
      </td></tr>
</table>
<p>In case of QR generated screens, like Tamper and Help screens, there is a provision to enlarge the QR code for better scanning. Use * and # keys to magnify and close respectively. Below is the sample magnified QR code screen for the Tamper QR.</p>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadCenter"></th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyCenter"><div class="image">
<img src="TamperPopout.png" alt=""/>
</div>
      </td></tr>
</table>
<p>The default language supported is English. There is no multi-language support currently.</p>
<h2><a class="anchor" id="sec_gda_overview_config_menu"></a>
Configuration for determining the component status.</h2>
<p>We use the following default configuration for determining the status. The configuration is available in the gda-config.json file which will be packaged along with the diagnostic application. Note that these values cannot be modified by the payment application.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="stringliteral">&quot;DetailMenuEnabled&quot;</span>: 1,                         <span class="comment">//To enable/disable detailed diagnostics. Not used currently</span></div>
<div class="line">    <span class="stringliteral">&quot;IdleTimeout&quot;</span>: 30,                              <span class="comment">//Time out to refresh the screens</span></div>
<div class="line">    <span class="stringliteral">&quot;widgets&quot;</span>: [ </div>
<div class="line">                {</div>
<div class="line">                    <span class="stringliteral">&quot;name&quot;</span>: <span class="stringliteral">&quot;summary&quot;</span>,              <span class="comment">//Summary widget</span></div>
<div class="line">                    <span class="stringliteral">&quot;Enabled&quot;</span>: 1,                   <span class="comment">//Enable/Disable summary widget. Not used currently</span></div>
<div class="line">                    <span class="stringliteral">&quot;id&quot;</span>:0,</div>
<div class="line">                },</div>
<div class="line">                {</div>
<div class="line">                    <span class="stringliteral">&quot;name&quot;</span>: <span class="stringliteral">&quot;device&quot;</span>,                <span class="comment">//Device Details widget</span></div>
<div class="line">                    <span class="stringliteral">&quot;Enabled&quot;</span>: 1,</div>
<div class="line">                    <span class="stringliteral">&quot;id&quot;</span>:1,</div>
<div class="line">                },</div>
<div class="line">                {</div>
<div class="line">                    <span class="stringliteral">&quot;name&quot;</span>: <span class="stringliteral">&quot;battery&quot;</span>,              <span class="comment">//Battery widget</span></div>
<div class="line">                    <span class="stringliteral">&quot;Enabled&quot;</span>: 1,</div>
<div class="line">                    <span class="stringliteral">&quot;id&quot;</span>:2,</div>
<div class="line">                    <span class="stringliteral">&quot;statusThresholdValues&quot;</span>: {</div>
<div class="line">                        <span class="stringliteral">&quot;lowThresholdPercent&quot;</span>: 10,  <span class="comment">// Less than the lowThresholdPercent - Display red  </span></div>
<div class="line">                        <span class="stringliteral">&quot;medThresholdPercent&quot;</span>: 60,  <span class="comment">// Less than the medThresholdPercent - Display amber     </span></div>
<div class="line">                        <span class="stringliteral">&quot;highThresholdPercent&quot;</span>: 100 <span class="comment">// greater than the medThresholdPercent - Display green     </span></div>
<div class="line">                    }</div>
<div class="line">                },</div>
<div class="line">                {</div>
<div class="line">                    <span class="stringliteral">&quot;name&quot;</span>: <span class="stringliteral">&quot;memory&quot;</span>,               <span class="comment">//Memory widget</span></div>
<div class="line">                    <span class="stringliteral">&quot;Enabled&quot;</span>: 0,</div>
<div class="line">                    <span class="stringliteral">&quot;id&quot;</span>:3,</div>
<div class="line">                    <span class="stringliteral">&quot;statusThresholdValues&quot;</span>: {</div>
<div class="line">                        <span class="stringliteral">&quot;lowThresholdPercent&quot;</span>: 10,</div>
<div class="line">                        <span class="stringliteral">&quot;medThresholdPercent&quot;</span>: 60,</div>
<div class="line">                        <span class="stringliteral">&quot;highThresholdPercent&quot;</span>: 100</div>
<div class="line">                    }</div>
<div class="line">                },</div>
<div class="line">                {</div>
<div class="line">                    <span class="stringliteral">&quot;name&quot;</span>: <span class="stringliteral">&quot;help&quot;</span>,</div>
<div class="line">                    <span class="stringliteral">&quot;Enabled&quot;</span>: 1,</div>
<div class="line">                    <span class="stringliteral">&quot;id&quot;</span>:4,</div>
<div class="line">                },</div>
<div class="line">                {</div>
<div class="line">                    <span class="stringliteral">&quot;name&quot;</span>: <span class="stringliteral">&quot;ethernet&quot;</span>,</div>
<div class="line">                    <span class="stringliteral">&quot;Enabled&quot;</span>: 1,</div>
<div class="line">                    <span class="stringliteral">&quot;id&quot;</span>:5,</div>
<div class="line">                },</div>
<div class="line">                {</div>
<div class="line">                    <span class="stringliteral">&quot;name&quot;</span>: <span class="stringliteral">&quot;wifi&quot;</span>,</div>
<div class="line">                    <span class="stringliteral">&quot;Enabled&quot;</span>: 1,</div>
<div class="line">                    <span class="stringliteral">&quot;id&quot;</span>:6,</div>
<div class="line">                },</div>
<div class="line">                {</div>
<div class="line">                    <span class="stringliteral">&quot;name&quot;</span>: <span class="stringliteral">&quot;gsm&quot;</span>,</div>
<div class="line">                    <span class="stringliteral">&quot;Enabled&quot;</span>: 1,</div>
<div class="line">                    <span class="stringliteral">&quot;id&quot;</span>:7,</div>
<div class="line">                }</div>
<div class="line">        ]</div>
<div class="line">}</div>
</div><!-- fragment --><h3><a class="anchor" id="component_battery"></a>
Battery</h3>
<p>The battery status is determined by battery charge level. The default values are </p><table class="doxtable">
<tr>
<td>0-9%  </td><td>Red  </td></tr>
<tr>
<td>10-59%  </td><td>Amber  </td></tr>
<tr>
<td>60-100%  </td><td>Green  </td></tr>
</table>
<p>Also the coin cell (internal battery) status is determined. The most severity level of Internal and Rechargeable batteries are considered for status. Suppose Internal battery is red status and the Rechargeable battery is green status, we will consider the Battery status as Red.</p>
<h3><a class="anchor" id="component_memory"></a>
Memory</h3>
<p>The memory status is determined by the free RAM and Flash available. The default values are <br  />
</p><table class="doxtable">
<tr>
<td>0-9%  </td><td>Red  </td></tr>
<tr>
<td>10-59%  </td><td>Amber  </td></tr>
<tr>
<td>60-100%  </td><td>Green  </td></tr>
</table>
<p>The most severity level of RAM and Flash are considered for status.</p>
<h1><a class="anchor" id="sec_gda_HelpInfo"></a>
Help and Tamper information</h1>
<p>In case device is tampered, the diagnostic application auto launches and displays the tamper information in form of a QR code on the landing page. The QR code can be scanned by Verifone app or any other mobile app and useful URLs can be retrieved from the QR code.</p>
<p>There is a help widget in the detail menu screens. In this help widget, useful URLs are embeded in to the QR code. The data to display the QR codes and other help information is configured in the below file gda-helpinfo.json. This file can also be provided by any payment application in the path /mnt/flash/etc/config/gda If the file is not provided by the payment application, then the default values will be used.</p>
<div class="fragment"><div class="line">{</div>
<div class="line">    <span class="stringliteral">&quot;widget_details&quot;</span>:[</div>
<div class="line">    {   </div>
<div class="line">        <span class="stringliteral">&quot;id&quot;</span>:4,                <span class="comment">//Id should not be changed. It reflects HelpInformation</span></div>
<div class="line">        <span class="stringliteral">&quot;icon&quot;</span>:<span class="stringliteral">&quot;color.png&quot;</span>,</div>
<div class="line">        <span class="stringliteral">&quot;title&quot;</span>:<span class="stringliteral">&quot;help_info&quot;</span>,</div>
<div class="line">        <span class="stringliteral">&quot;qr_code_data&quot;</span>: [<span class="stringliteral">&quot;http://help.verifonehq.net/faqs/220-troubleshooting/low-battery&quot;</span>, <span class="stringliteral">&quot;http://help.verifonehq.net/faqs/223-troubleshooting/low-memory&quot;</span>],</div>
<div class="line">        <span class="stringliteral">&quot;dynamic_details&quot;</span>:[</div>
<div class="line">            {<span class="stringliteral">&quot;phone_number&quot;</span>: <span class="stringliteral">&quot;12345678&quot;</span>},</div>
<div class="line">            {<span class="stringliteral">&quot;support_email&quot;</span>: <span class="stringliteral">&quot;abc@verifone.com&quot;</span>},</div>
<div class="line">            {<span class="stringliteral">&quot;suggestion_email&quot;</span>: <span class="stringliteral">&quot;xyz@verifone.com&quot;</span>}</div>
<div class="line">        ]   </div>
<div class="line">    },</div>
<div class="line">    {</div>
<div class="line">        <span class="stringliteral">&quot;id&quot;</span>:8,                   <span class="comment">//Id should not be changed. It reflects TamperInformation</span></div>
<div class="line">        <span class="stringliteral">&quot;icon&quot;</span>:<span class="stringliteral">&quot;color.png&quot;</span>,       <span class="comment">//Not used</span></div>
<div class="line">        <span class="stringliteral">&quot;title&quot;</span>:<span class="stringliteral">&quot;tamper_info&quot;</span>,    <span class="comment">//Not used</span></div>
<div class="line">        <span class="stringliteral">&quot;qr_code_data&quot;</span>: [<span class="stringliteral">&quot;http://help.verifonehq.net/faqs/222-troubleshooting/tampered-device&quot;</span>],  <span class="comment">//Tamper information URLs needs to be given here</span></div>
<div class="line">        <span class="stringliteral">&quot;dynamic_details&quot;</span>:[ </div>
<div class="line">            {<span class="stringliteral">&quot;contact&quot;</span>: <span class="stringliteral">&quot;12345678&quot;</span>}</div>
<div class="line">        ]</div>
<div class="line">    }</div>
<div class="line">    ]</div>
<div class="line">}</div>
</div><!-- fragment --><p>The "qr_code_data" needs to be configured by the payment application with all the URLs to be retrieved. The "dynamic_details" of Help Information consists of all the helpinfo like email and phone number. If payment application requires, more entries can be added to this section.</p>
<p>Note that, for tamper, we can display only "contact" information.</p>
<h1><a class="anchor" id="sec_gda_usinggda"></a>
Using the Diagnostic application by payment application</h1>
<p>The payment application can load the diagnostic shared library and invoke APIs to display the diagnostics. The following code snippet will help in understanding on how to invoke the APIs. Also note that the payment application needs to backup the GUI settings like ctlg information, font, resource path before invoking diagnostics and restore after. Based on the GUI region used, payment application may need to invoke <a class="el" href="namespacevfigui.html#a63902ad7b3ac76cb853b5a136a4c37bb">vfigui::uiEnterRegion()</a> and <a class="el" href="namespacevfigui.html#ab3d02556e61ec80ef434358669b6f585">vfigui::uiLeaveRegion()</a> APIs of ADK-GUI.</p>
<div class="fragment"><div class="line"><span class="keyword">const</span> std::string diagLibraryPath = <span class="stringliteral">&quot;/home/sys13/lib/libdiag.so&quot;</span>;</div>
<div class="line"><span class="keywordtype">void</span> *handle = dlopen(diagLibraryPath.c_str(), RTLD_LAZY);</div>
<div class="line"><span class="keywordflow">if</span> (!handle)</div>
<div class="line">{</div>
<div class="line">    <span class="comment">//Error</span></div>
<div class="line">} <span class="keywordflow">else</span></div>
<div class="line">{</div>
<div class="line">    </div>
<div class="line">    <span class="keyword">typedef</span> int (*diag_show)();</div>
<div class="line">    <span class="keyword">typedef</span> bool (*isdeviceSupported)();</div>
<div class="line">    </div>
<div class="line">    diag_show diagSym;</div>
<div class="line">    isdeviceSupported modelSupports;</div>
<div class="line"> </div>
<div class="line">    modelSupports = (isdeviceSupported) dlsym(handle, <span class="stringliteral">&quot;isdeviceSupported&quot;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (modelSupports &amp;&amp; modelSupports())</div>
<div class="line">    {</div>
<div class="line">        <span class="comment">//&quot;Device is Supported for Diagnostic App&quot;;</span></div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        <span class="comment">//&quot;Cannot load the symbol - isdeviceSupported&quot;;</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    diagSym = (diag_show) dlsym(handle, <span class="stringliteral">&quot;display_diagnostics&quot;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (diagSym)</div>
<div class="line">    {</div>
<div class="line">        diagSym();</div>
<div class="line">    } <span class="keywordflow">else</span></div>
<div class="line">    {</div>
<div class="line">        <span class="comment">//&quot;Cannot load the symbol - display_diagnostics&quot;;</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    dlclose(handle); <span class="comment">// close the library</span></div>
<div class="line">    </div>
<div class="line">}</div>
</div><!-- fragment --><p><br  />
 <br  />
 </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">Application Development Kit (ADK)</a></li><li class="navelem"><a class="el" href="pg_system_diagnosis_and_troubleshooting.html">System Diagnosis and Troubleshooting</a></li>
    <li class="footer">Generated on Mon Jun 16 2025 16:04:01 for ADK-Programmers-Guides by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
