<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="969px" preserveAspectRatio="none" style="width:594px;height:969px;" version="1.1" viewBox="0 0 594 969" width="594px" zoomAndPan="magnify"><defs><filter height="300%" id="f4clm6e86n2sh" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#FFFFFF" filter="url(#f4clm6e86n2sh)" height="133.6641" style="stroke: #000000; stroke-width: 2.0;" width="465" x="106" y="88.4297"/><rect fill="#FFFFFF" filter="url(#f4clm6e86n2sh)" height="138.7969" style="stroke: #000000; stroke-width: 2.0;" width="509" x="62" y="388.625"/><rect fill="#FFFFFF" filter="url(#f4clm6e86n2sh)" height="164.7969" style="stroke: #000000; stroke-width: 2.0;" width="485" x="96" y="656.8203"/><rect fill="#FFFFFF" filter="url(#f4clm6e86n2sh)" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="465" x="106" y="739.2188"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="82" x2="82" y1="38.2969" y2="229.0938"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="82" x2="82" y1="229.0938" y2="257.0938"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="82" x2="82" y1="257.0938" y2="592.6875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="82" x2="82" y1="592.6875" y2="620.6875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="82" x2="82" y1="620.6875" y2="890.8828"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="82" x2="82" y1="890.8828" y2="918.8828"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="82" x2="82" y1="918.8828" y2="928.8828"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="159" x2="159" y1="38.2969" y2="229.0938"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="159" x2="159" y1="229.0938" y2="257.0938"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="159" x2="159" y1="257.0938" y2="592.6875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="159" x2="159" y1="592.6875" y2="620.6875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="159" x2="159" y1="620.6875" y2="890.8828"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="159" x2="159" y1="890.8828" y2="918.8828"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="159" x2="159" y1="918.8828" y2="928.8828"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="516" x2="516" y1="38.2969" y2="229.0938"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="516" x2="516" y1="229.0938" y2="257.0938"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="516" x2="516" y1="257.0938" y2="592.6875"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="516" x2="516" y1="592.6875" y2="620.6875"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="516" x2="516" y1="620.6875" y2="890.8828"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="516" x2="516" y1="890.8828" y2="918.8828"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="516" x2="516" y1="918.8828" y2="928.8828"/><rect fill="#FEFECE" filter="url(#f4clm6e86n2sh)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="43" x="59" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="66" y="22.9951">ECR</text><rect fill="#FEFECE" filter="url(#f4clm6e86n2sh)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="43" x="59" y="927.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="29" x="66" y="947.8779">ECR</text><rect fill="#FEFECE" filter="url(#f4clm6e86n2sh)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="116" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="123" y="22.9951">SDI PlugIn</text><rect fill="#FEFECE" filter="url(#f4clm6e86n2sh)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="83" x="116" y="927.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="69" x="123" y="947.8779">SDI PlugIn</text><rect fill="#FEFECE" filter="url(#f4clm6e86n2sh)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="85" x="472" y="3"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="71" x="479" y="22.9951">SDI Server</text><rect fill="#FEFECE" filter="url(#f4clm6e86n2sh)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="85" x="472" y="927.8828"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="71" x="479" y="947.8779">SDI Server</text><rect fill="#FBFB77" filter="url(#f4clm6e86n2sh)" height="23" style="stroke: #A80036; stroke-width: 1.0;" width="56" x="488" y="53.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="48" x="492" y="69.3638">Startup</text><path d="M106,88.4297 L176,88.4297 L176,95.4297 L166,105.4297 L106,105.4297 L106,88.4297 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="133.6641" style="stroke: #000000; stroke-width: 2.0;" width="465" x="106" y="88.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="121" y="101.4966">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90" x="191" y="100.6401">[VCL enabled]</text><polygon fill="#A80036" points="170.5,122.6953,160.5,126.6953,170.5,130.6953,166.5,126.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="164.5" x2="515.5" y1="126.6953" y2="126.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="201" x="176.5" y="121.6294">openExtension(int ext_number)</text><polygon fill="#A80036" points="504.5,151.8281,514.5,155.8281,504.5,159.8281,508.5,155.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="159.5" x2="510.5" y1="155.8281" y2="155.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="166.5" y="150.7622">Response(Function pointer)</text><polygon fill="#A80036" points="170.5,180.9609,160.5,184.9609,170.5,188.9609,166.5,184.9609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="164.5" x2="515.5" y1="184.9609" y2="184.9609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="329" x="176.5" y="179.895">Function pointer(register Vcl_Encryption_Callback())</text><polygon fill="#A80036" points="504.5,210.0938,514.5,214.0938,504.5,218.0938,508.5,214.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="159.5" x2="510.5" y1="214.0938" y2="214.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="72" x="166.5" y="209.0278">Response()</text><rect fill="#FBFB77" filter="url(#f4clm6e86n2sh)" height="23" style="stroke: #A80036; stroke-width: 1.0;" width="149" x="8" y="262.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="12" y="278.1606">External Data entered</text><polygon fill="#A80036" points="504.5,307.3594,514.5,311.3594,504.5,315.3594,508.5,311.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="82.5" x2="510.5" y1="311.3594" y2="311.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="299" x="89.5" y="306.2935">Plugin Interface (26xx) PAN, Expiry Date[, CVV]</text><polygon fill="#A80036" points="170.5,336.4922,160.5,340.4922,170.5,344.4922,166.5,340.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="164.5" x2="515.5" y1="340.4922" y2="340.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="288" x="176.5" y="335.4263">processMessage(xx) PAN, Expiry Date[, CVV]</text><rect fill="#FBFB77" filter="url(#f4clm6e86n2sh)" height="23" style="stroke: #A80036; stroke-width: 1.0;" width="113" x="103" y="353.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="105" x="107" y="369.5591">Store clear Data</text><path d="M62,388.625 L132,388.625 L132,395.625 L122,405.625 L62,405.625 L62,388.625 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="138.7969" style="stroke: #000000; stroke-width: 2.0;" width="509" x="62" y="388.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="77" y="401.6919">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="229" x="147" y="400.8354">[VCL enabled (Callback registered)]</text><polygon fill="#A80036" points="504.5,438.0234,514.5,442.0234,504.5,446.0234,508.5,442.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="159.5" x2="510.5" y1="442.0234" y2="442.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="329" x="166.5" y="421.8247">Vcl_Encryption_Callback(data, size) to encrypt Data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="330" x="166.5" y="436.9575">{data: Data length, BER-TLV data, size: Buffer size}</text><polygon fill="#A80036" points="170.5,482.2891,160.5,486.2891,170.5,490.2891,166.5,486.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="164.5" x2="515.5" y1="486.2891" y2="486.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="121" x="176.5" y="466.0903">VCL enrypted Data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="333" x="176.5" y="481.2231">{data: SW1/SW2[, BER-TLV data], size: Data length}</text><rect fill="#FBFB77" filter="url(#f4clm6e86n2sh)" height="23" style="stroke: #A80036; stroke-width: 1.0;" width="175" x="72" y="499.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="167" x="76" y="515.356">Store VCL encrypted Data</text><polygon fill="#A80036" points="504.5,551.5547,514.5,555.5547,504.5,559.5547,508.5,555.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="159.5" x2="510.5" y1="555.5547" y2="555.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="173" x="166.5" y="550.4888">processMessage Response</text><polygon fill="#A80036" points="93.5,580.6875,83.5,584.6875,93.5,588.6875,89.5,584.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="87.5" x2="515.5" y1="584.6875" y2="584.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="96" x="99.5" y="579.6216">26xx Response</text><polygon fill="#A80036" points="504.5,637.8203,514.5,641.8203,504.5,645.8203,508.5,641.8203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="82.5" x2="510.5" y1="641.8203" y2="641.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="254" x="89.5" y="636.7544">fetchTrxTags(PAN[, Expiry Date][, CVV])</text><path d="M96,656.8203 L166,656.8203 L166,663.8203 L156,673.8203 L96,673.8203 L96,656.8203 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="164.7969" style="stroke: #000000; stroke-width: 2.0;" width="485" x="96" y="656.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="111" y="669.8872">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="174" x="181" y="669.0308">[No Data stored inside SDI]</text><polygon fill="#A80036" points="170.5,691.0859,160.5,695.0859,170.5,699.0859,166.5,695.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="164.5" x2="515.5" y1="695.0859" y2="695.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="277" x="176.5" y="690.02">processTrigger() [SDITrigger_ExtDataStore]</text><polygon fill="#A80036" points="504.5,720.2188,514.5,724.2188,504.5,728.2188,508.5,724.2188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="159.5" x2="510.5" y1="724.2188" y2="724.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="66" x="166.5" y="719.1528">clear Data</text><path d="M106,739.2188 L176,739.2188 L176,746.2188 L166,756.2188 L106,756.2188 L106,739.2188 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="465" x="106" y="739.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="121" y="752.2856">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90" x="191" y="751.4292">[VCL enabled]</text><polygon fill="#A80036" points="170.5,773.4844,160.5,777.4844,170.5,781.4844,166.5,777.4844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="164.5" x2="515.5" y1="777.4844" y2="777.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="272" x="176.5" y="772.4185">processTrigger() [SDITrigger_ExtDataStore</text><polygon fill="#A80036" points="504.5,802.6172,514.5,806.6172,504.5,810.6172,508.5,806.6172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="159.5" x2="510.5" y1="806.6172" y2="806.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="128" x="166.5" y="801.5513">VCL encrypted Data</text><rect fill="#FBFB77" filter="url(#f4clm6e86n2sh)" height="23" style="stroke: #A80036; stroke-width: 1.0;" width="134" x="449" y="833.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="126" x="453" y="849.6841">Filter sensitive Data</text><polygon fill="#A80036" points="93.5,878.8828,83.5,882.8828,93.5,886.8828,89.5,882.8828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="87.5" x2="515.5" y1="882.8828" y2="882.8828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="99.5" y="877.8169">fetchTrxTags Response</text><!--
@startuml
participant "ECR" order 10
participant "SDI PlugIn" order 20
participant "SDI Server" order 30
rnote over "SDI Server"
    Startup
endrnote
opt VCL enabled
    "SDI Server" -> "SDI PlugIn": openExtension(int ext_number)
    "SDI PlugIn" - -> "SDI Server": Response(Function pointer)
    "SDI Server" -> "SDI PlugIn": Function pointer(register Vcl_Encryption_Callback())
    "SDI PlugIn" - -> "SDI Server": Response()
end
...
rnote over "ECR"
    External Data entered
endrnote
"ECR"->"SDI Server": Plugin Interface (26xx) PAN, Expiry Date[, CVV]
"SDI Server" -> "SDI PlugIn": processMessage(xx) PAN, Expiry Date[, CVV]
rnote over "SDI PlugIn"
    Store clear Data
endrnote
opt VCL enabled (Callback registered)
    "SDI PlugIn" -> "SDI Server": Vcl_Encryption_Callback(data, size) to encrypt Data\n{data: Data length, BER-TLV data, size: Buffer size}
    "SDI Server" - -> "SDI PlugIn": VCL enrypted Data\n{data: SW1/SW2[, BER-TLV data], size: Data length}
    rnote over "SDI PlugIn"
        Store VCL encrypted Data
    endrnote
end
"SDI PlugIn" -> "SDI Server": processMessage Response
"SDI Server" - -> "ECR": 26xx Response
...
"ECR"-> "SDI Server": fetchTrxTags(PAN[, Expiry Date][, CVV])
opt No Data stored inside SDI
    "SDI Server" - -> "SDI PlugIn": processTrigger() [SDITrigger_ExtDataStore]
    "SDI PlugIn" - -> "SDI Server": clear Data
    opt VCL enabled
        "SDI Server" - -> "SDI PlugIn": processTrigger() [SDITrigger_ExtDataStore
        "SDI PlugIn" - -> "SDI Server": VCL encrypted Data
    end
end
rnote over "SDI Server"
    Filter sensitive Data
endrnote
"SDI Server" - -> "ECR": fetchTrxTags Response 
...
@enduml

PlantUML version 1.2019.03(Sun Mar 10 04:04:44 PDT 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 17.0.14+7-Ubuntu-120.04
Operating System: Linux
OS Version: 5.15.0-1082-azure
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>