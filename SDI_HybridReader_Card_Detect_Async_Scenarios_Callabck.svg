<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1363px" preserveAspectRatio="none" style="width:1096px;height:1363px;" version="1.1" viewBox="0 0 1096 1363" width="1096px" zoomAndPan="magnify"><defs><filter height="300%" id="fh3qv9xcshlj4" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="698" x="199.5" y="22.9951">SDI: Hybrid Cardreader Asynchronous Card Detection (23-03) scenarios (callback mode)</text><rect fill="#FFFFFF" filter="url(#fh3qv9xcshlj4)" height="1220.3359" style="stroke: #000000; stroke-width: 2.0;" width="1072" x="12" y="85.5938"/><rect fill="#FFFFFF" filter="url(#fh3qv9xcshlj4)" height="271" style="stroke: #000000; stroke-width: 2.0;" width="1052" x="22" y="293.3906"/><rect fill="#FFFFFF" height="224.7344" style="stroke: none; stroke-width: 1.0;" width="1052" x="22" y="339.6563"/><rect fill="#FFFFFF" height="386.6719" style="stroke: none; stroke-width: 1.0;" width="1072" x="12" y="599.3906"/><rect fill="#FFFFFF" filter="url(#fh3qv9xcshlj4)" height="146.2031" style="stroke: #000000; stroke-width: 2.0;" width="755.5" x="178" y="804.8594"/><rect fill="#FFFFFF" height="71.9375" style="stroke: none; stroke-width: 1.0;" width="755.5" x="178" y="879.125"/><rect fill="#FFFFFF" height="319.8672" style="stroke: none; stroke-width: 1.0;" width="1072" x="12" y="986.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242" x2="242" y1="68.5938" y2="160.9922"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="242" x2="242" y1="160.9922" y2="188.9922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242" x2="242" y1="188.9922" y2="571.3906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="242" x2="242" y1="571.3906" y2="599.3906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242" x2="242" y1="599.3906" y2="672.4609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="242" x2="242" y1="672.4609" y2="700.4609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242" x2="242" y1="700.4609" y2="851.125"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="242" x2="242" y1="851.125" y2="879.125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242" x2="242" y1="879.125" y2="923.0625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="242" x2="242" y1="923.0625" y2="951.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242" x2="242" y1="951.0625" y2="958.0625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="242" x2="242" y1="958.0625" y2="986.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242" x2="242" y1="986.0625" y2="1059.1328"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="242" x2="242" y1="1059.1328" y2="1087.1328"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242" x2="242" y1="1087.1328" y2="1277.9297"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="242" x2="242" y1="1277.9297" y2="1305.9297"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242" x2="242" y1="1305.9297" y2="1322.9297"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="878.5" x2="878.5" y1="68.5938" y2="160.9922"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="878.5" x2="878.5" y1="160.9922" y2="188.9922"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="878.5" x2="878.5" y1="188.9922" y2="571.3906"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="878.5" x2="878.5" y1="571.3906" y2="599.3906"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="878.5" x2="878.5" y1="599.3906" y2="672.4609"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="878.5" x2="878.5" y1="672.4609" y2="700.4609"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="878.5" x2="878.5" y1="700.4609" y2="851.125"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="878.5" x2="878.5" y1="851.125" y2="879.125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="878.5" x2="878.5" y1="879.125" y2="923.0625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="878.5" x2="878.5" y1="923.0625" y2="951.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="878.5" x2="878.5" y1="951.0625" y2="958.0625"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="878.5" x2="878.5" y1="958.0625" y2="986.0625"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="878.5" x2="878.5" y1="986.0625" y2="1059.1328"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="878.5" x2="878.5" y1="1059.1328" y2="1087.1328"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="878.5" x2="878.5" y1="1087.1328" y2="1277.9297"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="878.5" x2="878.5" y1="1277.9297" y2="1305.9297"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="878.5" x2="878.5" y1="1305.9297" y2="1322.9297"/><rect fill="#FEFECE" filter="url(#fh3qv9xcshlj4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="105" x="188" y="33.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="91" x="195" y="53.292">Payment App</text><rect fill="#FEFECE" filter="url(#fh3qv9xcshlj4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="105" x="188" y="1321.9297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="91" x="195" y="1341.9248">Payment App</text><rect fill="#FEFECE" filter="url(#fh3qv9xcshlj4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="86" x="833.5" y="33.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="840.5" y="53.292">SDI-Server</text><rect fill="#FEFECE" filter="url(#fh3qv9xcshlj4)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="86" x="833.5" y="1321.9297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="840.5" y="1341.9248">SDI-Server</text><path d="M12,85.5938 L76,85.5938 L76,92.5938 L66,102.5938 L12,102.5938 L12,85.5938 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1220.3359" style="stroke: #000000; stroke-width: 2.0;" width="1072" x="12" y="85.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="27" y="98.6606">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="473" x="91" y="97.8042">[Start Card Detection (23-03) with card technology chip and msr enabled]</text><polygon fill="#A80036" points="866.5,119.8594,876.5,123.8594,866.5,127.8594,870.5,123.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242.5" x2="872.5" y1="123.8594" y2="123.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="249.5" y="118.7935">Start Card Detection (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="208" x="390.5" y="118.7935">23-03 with tag DFA108 = 03</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="598.5" y="118.7935">)</text><polygon fill="#A80036" points="253.5,148.9922,243.5,152.9922,253.5,156.9922,249.5,152.9922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="247.5" x2="877.5" y1="152.9922" y2="152.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="204" x="259.5" y="147.9263">Start Card Detection response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="463.5" y="147.9263">90-00</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="504.5" y="147.9263">)</text><path d="M883,193.9922 L883,218.9922 L1055,218.9922 L1055,203.9922 L1045,193.9922 L883,193.9922 " fill="#FBFB77" filter="url(#fh3qv9xcshlj4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1045,193.9922 L1045,203.9922 L1055,203.9922 L1045,193.9922 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="889" y="211.0591">Customer card inserted</text><polygon fill="#A80036" points="253.5,245.2578,243.5,249.2578,253.5,253.2578,249.5,249.2578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="247.5" x2="877.5" y1="249.2578" y2="249.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="259.5" y="244.1919">Card Detected Callback 9E-02 (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="178" x="459.5" y="244.1919">90-00 with DFA108 = 01</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="637.5" y="244.1919">)</text><polygon fill="#A80036" points="866.5,274.3906,876.5,278.3906,866.5,282.3906,870.5,278.3906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242.5" x2="872.5" y1="278.3906" y2="278.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="249.5" y="273.3247">Smart Card Activate (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="388.5" y="273.3247">41-02</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="429.5" y="273.3247">)</text><path d="M22,293.3906 L86,293.3906 L86,300.3906 L76,310.3906 L22,310.3906 L22,293.3906 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="271" style="stroke: #000000; stroke-width: 2.0;" width="1052" x="22" y="293.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="37" y="306.4575">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="222" x="101" y="305.6011">[Chip card activation successfully]</text><polygon fill="#A80036" points="253.5,327.6563,243.5,331.6563,253.5,335.6563,249.5,331.6563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="247.5" x2="877.5" y1="331.6563" y2="331.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="259.5" y="326.5903">Smart Card Activate response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90" x="461.5" y="326.5903">90-00 + ATR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="551.5" y="326.5903">)</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="22" x2="1074" y1="340.6563" y2="340.6563"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="180" x="27" y="350.8667">[Chip card activation failed]</text><polygon fill="#A80036" points="253.5,371.5938,243.5,375.5938,253.5,379.5938,249.5,375.5938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="247.5" x2="877.5" y1="375.5938" y2="375.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="259.5" y="370.5278">Smart Card Activate response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="461.5" y="370.5278">94-03</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="502.5" y="370.5278">)</text><polygon fill="#A80036" points="866.5,400.7266,876.5,404.7266,866.5,408.7266,870.5,404.7266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242.5" x2="872.5" y1="404.7266" y2="404.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="73" x="249.5" y="399.6606">MSR Read (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="322.5" y="399.6606">21-01</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="363.5" y="399.6606">)</text><polygon fill="#A80036" points="253.5,429.8594,243.5,433.8594,253.5,437.8594,249.5,433.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="247.5" x2="877.5" y1="433.8594" y2="433.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="259.5" y="428.7935">Card Removal Callback (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="414.5" y="428.7935">9E-04</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="455.5" y="428.7935">)</text><path d="M32,446.8594 L32,486.8594 L233,486.8594 L233,456.8594 L223,446.8594 L32,446.8594 " fill="#FBFB77" filter="url(#fh3qv9xcshlj4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M223,446.8594 L223,456.8594 L233,456.8594 L223,446.8594 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="176" x="38" y="463.9263">Payment application should</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="38" y="479.0591">display remove card</text><path d="M883,501.125 L883,526.125 L1060,526.125 L1060,511.125 L1050,501.125 L883,501.125 " fill="#FBFB77" filter="url(#fh3qv9xcshlj4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1050,501.125 L1050,511.125 L1060,511.125 L1050,501.125 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="889" y="518.1919">Customer card removed</text><polygon fill="#A80036" points="253.5,552.3906,243.5,556.3906,253.5,560.3906,249.5,556.3906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="247.5" x2="877.5" y1="556.3906" y2="556.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="259.5" y="551.3247">MSR Read Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="200" x="398.5" y="551.3247">9000 with obfuscated data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="598.5" y="551.3247">)</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="12" x2="1084" y1="600.3906" y2="600.3906"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="449" x="17" y="610.6011">[Start Card Detection (23-03) with card technology chip enabled only]</text><polygon fill="#A80036" points="866.5,631.3281,876.5,635.3281,866.5,639.3281,870.5,635.3281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242.5" x2="872.5" y1="635.3281" y2="635.3281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="249.5" y="630.2622">Start Card Detection (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="208" x="390.5" y="630.2622">23-03 with tag DFA108 = 01</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="598.5" y="630.2622">)</text><polygon fill="#A80036" points="253.5,660.4609,243.5,664.4609,253.5,668.4609,249.5,664.4609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="247.5" x2="877.5" y1="664.4609" y2="664.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="204" x="259.5" y="659.395">Start Card Detection response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="463.5" y="659.395">90-00</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="504.5" y="659.395">)</text><path d="M883,705.4609 L883,730.4609 L1055,730.4609 L1055,715.4609 L1045,705.4609 L883,705.4609 " fill="#FBFB77" filter="url(#fh3qv9xcshlj4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1045,705.4609 L1045,715.4609 L1055,715.4609 L1045,705.4609 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="889" y="722.5278">Customer card inserted</text><polygon fill="#A80036" points="253.5,756.7266,243.5,760.7266,253.5,764.7266,249.5,760.7266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="247.5" x2="877.5" y1="760.7266" y2="760.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="259.5" y="755.6606">Card Detected Callback 9E-02 (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="178" x="459.5" y="755.6606">90-00 with DFA108 = 01</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="637.5" y="755.6606">)</text><polygon fill="#A80036" points="866.5,785.8594,876.5,789.8594,866.5,793.8594,870.5,789.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242.5" x2="872.5" y1="789.8594" y2="789.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="249.5" y="784.7935">Smart Card Activate (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="388.5" y="784.7935">41-02</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="429.5" y="784.7935">)</text><path d="M178,804.8594 L242,804.8594 L242,811.8594 L232,821.8594 L178,821.8594 L178,804.8594 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="146.2031" style="stroke: #000000; stroke-width: 2.0;" width="755.5" x="178" y="804.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="193" y="817.9263">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="222" x="257" y="817.0698">[Chip card activation successfully]</text><polygon fill="#A80036" points="253.5,839.125,243.5,843.125,253.5,847.125,249.5,843.125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="247.5" x2="877.5" y1="843.125" y2="843.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="259.5" y="838.0591">Smart Card Activate response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90" x="461.5" y="838.0591">90-00 + ATR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="551.5" y="838.0591">)</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="178" x2="933.5" y1="880.125" y2="880.125"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="180" x="183" y="890.3354">[Chip card activation failed]</text><polygon fill="#A80036" points="253.5,911.0625,243.5,915.0625,253.5,919.0625,249.5,915.0625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="247.5" x2="877.5" y1="915.0625" y2="915.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="259.5" y="909.9966">Smart Card Activate response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="461.5" y="909.9966">94-03</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="502.5" y="909.9966">)</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="12" x2="1084" y1="987.0625" y2="987.0625"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="445" x="17" y="997.2729">[Start Card Detection (23-03) with card technology msr enabled only]</text><polygon fill="#A80036" points="866.5,1018,876.5,1022,866.5,1026,870.5,1022" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242.5" x2="872.5" y1="1022" y2="1022"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="141" x="249.5" y="1016.9341">Start Card Detection (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="208" x="390.5" y="1016.9341">23-03 with tag DFA108 = 02</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="598.5" y="1016.9341">)</text><polygon fill="#A80036" points="253.5,1047.1328,243.5,1051.1328,253.5,1055.1328,249.5,1051.1328" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="247.5" x2="877.5" y1="1051.1328" y2="1051.1328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="204" x="259.5" y="1046.0669">Start Card Detection response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="463.5" y="1046.0669">90-00</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="504.5" y="1046.0669">)</text><path d="M883,1092.1328 L883,1117.1328 L1055,1117.1328 L1055,1102.1328 L1045,1092.1328 L883,1092.1328 " fill="#FBFB77" filter="url(#fh3qv9xcshlj4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1045,1092.1328 L1045,1102.1328 L1055,1102.1328 L1045,1092.1328 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="889" y="1109.1997">Customer card inserted</text><polygon fill="#A80036" points="253.5,1143.3984,243.5,1147.3984,253.5,1151.3984,249.5,1147.3984" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="247.5" x2="877.5" y1="1147.3984" y2="1147.3984"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="259.5" y="1142.3325">Card Removal Callback (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="414.5" y="1142.3325">9E-04</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="455.5" y="1142.3325">)</text><path d="M32,1160.3984 L32,1200.3984 L233,1200.3984 L233,1170.3984 L223,1160.3984 L32,1160.3984 " fill="#FBFB77" filter="url(#fh3qv9xcshlj4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M223,1160.3984 L223,1170.3984 L233,1170.3984 L223,1160.3984 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="176" x="38" y="1177.4653">Payment application should</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="38" y="1192.5981">display remove card</text><path d="M883,1214.6641 L883,1239.6641 L1060,1239.6641 L1060,1224.6641 L1050,1214.6641 L883,1214.6641 " fill="#FBFB77" filter="url(#fh3qv9xcshlj4)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1050,1214.6641 L1050,1224.6641 L1060,1224.6641 L1050,1214.6641 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="889" y="1231.731">Customer card removed</text><polygon fill="#A80036" points="253.5,1265.9297,243.5,1269.9297,253.5,1273.9297,249.5,1269.9297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="247.5" x2="877.5" y1="1269.9297" y2="1269.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="200" x="259.5" y="1264.8638">Card Detected Callback 9E-02 (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="407" x="459.5" y="1264.8638">90-00 with tag DFA108 = 02 and obfuscated card data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="866.5" y="1264.8638">)</text><!--
@startuml

title SDI: Hybrid Cardreader Asynchronous Card Detection (23-03) scenarios (callback mode)

participant "Payment App" order 10
participant "SDI-Server" order 20


alt Start Card Detection (23-03) with card technology chip and msr enabled
  "Payment App" -> "SDI-Server": Start Card Detection (<b>23-03 with tag DFA108 = 03</b>)
  "SDI-Server" -> "Payment App": Start Card Detection response (<b>90-00</b>)
  ...
  note right of "SDI-Server": Customer card inserted  
  "SDI-Server" -> "Payment App": Card Detected Callback 9E-02 (<b>90-00 with DFA108 = 01</b>) 
  "Payment App" -> "SDI-Server": Smart Card Activate (<b>41-02</b>)
  alt Chip card activation successfully
    "SDI-Server" -> "Payment App": Smart Card Activate response (<b>90-00 + ATR</b>)
  else Chip card activation failed
    "SDI-Server" -> "Payment App": Smart Card Activate response (<b>94-03</b>)
    "Payment App" -> "SDI-Server":  MSR Read (<b>21-01</b>)
    "SDI-Server" -> "Payment App":  Card Removal Callback (<b>9E-04</b>)
    note left of "Payment App" 
    Payment application should 
    display remove card
    end note 
    note right of "SDI-Server": Customer card removed
    "SDI-Server" -> "Payment App": MSR Read Response (<b>9000 with obfuscated data</b>)
  end
  ...
else Start Card Detection (23-03) with card technology chip enabled only
  "Payment App" -> "SDI-Server": Start Card Detection (<b>23-03 with tag DFA108 = 01</b>)
  "SDI-Server" -> "Payment App": Start Card Detection response (<b>90-00</b>)
  ...
  note right of "SDI-Server": Customer card inserted  
  "SDI-Server" -> "Payment App": Card Detected Callback 9E-02 (<b>90-00 with DFA108 = 01</b>)
  "Payment App" -> "SDI-Server": Smart Card Activate (<b>41-02</b>)
  alt Chip card activation successfully
    "SDI-Server" -> "Payment App": Smart Card Activate response (<b>90-00 + ATR</b>)
    ...
  else Chip card activation failed
    "SDI-Server" -> "Payment App": Smart Card Activate response (<b>94-03</b>)
    ...
  end
  ...
else Start Card Detection (23-03) with card technology msr enabled only
  "Payment App" -> "SDI-Server": Start Card Detection (<b>23-03 with tag DFA108 = 02</b>)
  "SDI-Server" -> "Payment App": Start Card Detection response (<b>90-00</b>)
  ...
  note right of "SDI-Server": Customer card inserted  
  "SDI-Server" -> "Payment App":  Card Removal Callback (<b>9E-04</b>)
  note left of "Payment App"
    Payment application should 
    display remove card
  end note  
  note right of "SDI-Server": Customer card removed
  "SDI-Server" -> "Payment App": Card Detected Callback 9E-02 (<b>90-00 with tag DFA108 = 02 and obfuscated card data</b>)
  ...
end

@enduml

PlantUML version 1.2019.03(Sun Mar 10 04:04:44 PDT 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 17.0.14+7-Ubuntu-120.04
Operating System: Linux
OS Version: 5.15.0-1082-azure
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>