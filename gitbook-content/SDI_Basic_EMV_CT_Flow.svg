<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="2732px" preserveAspectRatio="none" style="width:1038px;height:2732px;" version="1.1" viewBox="0 0 1038 2732" width="1038px" zoomAndPan="magnify"><defs><filter height="300%" id="f1kcnb4p0ztfkn" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="282" x="373.75" y="22.9951">SDI: EMV-CT Basic Transaction Flow</text><rect fill="#FFFFFF" filter="url(#f1kcnb4p0ztfkn)" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="538.5" x="23" y="230.125"/><rect fill="#FFFFFF" filter="url(#f1kcnb4p0ztfkn)" height="46.2656" style="stroke: #000000; stroke-width: 2.0;" width="406" x="451.5" y="406.9219"/><rect fill="#FFFFFF" filter="url(#f1kcnb4p0ztfkn)" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="538.5" x="23" y="568.5859"/><rect fill="#FFFFFF" filter="url(#f1kcnb4p0ztfkn)" height="46.2656" style="stroke: #000000; stroke-width: 2.0;" width="406" x="451.5" y="657.9844"/><rect fill="#FFFFFF" filter="url(#f1kcnb4p0ztfkn)" height="106.5313" style="stroke: #000000; stroke-width: 2.0;" width="558.5" x="13" y="776.5156"/><rect fill="#FFFFFF" filter="url(#f1kcnb4p0ztfkn)" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="538.5" x="23" y="800.6484"/><rect fill="#FFFFFF" filter="url(#f1kcnb4p0ztfkn)" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="538.5" x="23" y="897.0469"/><rect fill="#FFFFFF" filter="url(#f1kcnb4p0ztfkn)" height="46.2656" style="stroke: #000000; stroke-width: 2.0;" width="406" x="451.5" y="986.4453"/><rect fill="#FFFFFF" filter="url(#f1kcnb4p0ztfkn)" height="193.9297" style="stroke: #000000; stroke-width: 2.0;" width="558.5" x="13" y="1046.7109"/><rect fill="#FFFFFF" filter="url(#f1kcnb4p0ztfkn)" height="46.2656" style="stroke: #000000; stroke-width: 2.0;" width="538.5" x="23" y="1129.1094"/><rect fill="#FFFFFF" filter="url(#f1kcnb4p0ztfkn)" height="46.2656" style="stroke: #000000; stroke-width: 2.0;" width="394" x="451.5" y="1254.6406"/><rect fill="#FFFFFF" filter="url(#f1kcnb4p0ztfkn)" height="46.2656" style="stroke: #000000; stroke-width: 2.0;" width="413" x="451.5" y="1314.9063"/><rect fill="#FFFFFF" filter="url(#f1kcnb4p0ztfkn)" height="46.2656" style="stroke: #000000; stroke-width: 2.0;" width="406" x="451.5" y="1375.1719"/><rect fill="#FFFFFF" filter="url(#f1kcnb4p0ztfkn)" height="46.2656" style="stroke: #000000; stroke-width: 2.0;" width="401" x="451.5" y="1595.1016"/><rect fill="#FFFFFF" filter="url(#f1kcnb4p0ztfkn)" height="46.2656" style="stroke: #000000; stroke-width: 2.0;" width="401" x="451.5" y="2076.0938"/><rect fill="#FFFFFF" filter="url(#f1kcnb4p0ztfkn)" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="538.5" x="23" y="2208.625"/><rect fill="#FFFFFF" filter="url(#f1kcnb4p0ztfkn)" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="538.5" x="23" y="2356.2891"/><rect fill="#FFFFFF" filter="url(#f1kcnb4p0ztfkn)" height="85.3984" style="stroke: #000000; stroke-width: 2.0;" width="993.5" x="23" y="2488.8203"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="87" x2="87" y1="68.5938" y2="2692.6172"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="506.5" x2="506.5" y1="68.5938" y2="2692.6172"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="805.5" x2="805.5" y1="68.5938" y2="2692.6172"/><rect fill="#FEFECE" filter="url(#f1kcnb4p0ztfkn)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="105" x="33" y="33.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="91" x="40" y="53.292">Payment App</text><rect fill="#FEFECE" filter="url(#f1kcnb4p0ztfkn)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="105" x="33" y="2691.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="91" x="40" y="2711.6123">Payment App</text><rect fill="#FEFECE" filter="url(#f1kcnb4p0ztfkn)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="86" x="461.5" y="33.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="468.5" y="53.292">SDI-Server</text><rect fill="#FEFECE" filter="url(#f1kcnb4p0ztfkn)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="86" x="461.5" y="2691.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="468.5" y="2711.6123">SDI-Server</text><rect fill="#FEFECE" filter="url(#f1kcnb4p0ztfkn)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="775.5" y="33.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="782.5" y="53.292">PlugIn</text><rect fill="#FEFECE" filter="url(#f1kcnb4p0ztfkn)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="56" x="775.5" y="2691.6172"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="42" x="782.5" y="2711.6123">PlugIn</text><rect fill="#EEEEEE" filter="url(#f1kcnb4p0ztfkn)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1023.5" x="3" y="99.1602"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1026.5" y1="99.1602" y2="99.1602"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1026.5" y1="102.1602" y2="102.1602"/><rect fill="#EEEEEE" filter="url(#f1kcnb4p0ztfkn)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="228" x="400.75" y="88.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="209" x="406.75" y="104.6606">Initialize EMV CT Framework</text><polygon fill="#A80036" points="494.5,138.8594,504.5,142.8594,494.5,146.8594,498.5,142.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="87.5" x2="500.5" y1="142.8594" y2="142.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="234" x="94.5" y="137.7935">EMV_CT_Init_Framework Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="328.5" y="137.7935">39-00</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="369.5" y="137.7935">)</text><polygon fill="#A80036" points="98.5,167.9922,88.5,171.9922,98.5,175.9922,94.5,171.9922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="92.5" x2="505.5" y1="171.9922" y2="171.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="229" x="104.5" y="166.9263">EMV_CT_Init_Framework Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="333.5" y="166.9263">90-00</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="374.5" y="166.9263">)</text><rect fill="#EEEEEE" filter="url(#f1kcnb4p0ztfkn)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1023.5" x="3" y="200.5586"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1026.5" y1="200.5586" y2="200.5586"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1026.5" y1="203.5586" y2="203.5586"/><rect fill="#EEEEEE" filter="url(#f1kcnb4p0ztfkn)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="120" x="454.75" y="189.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="101" x="460.75" y="206.0591">Card Reading</text><path d="M23,230.125 L93,230.125 L93,237.125 L83,247.125 L23,247.125 L23,230.125 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="538.5" x="23" y="230.125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="38" y="243.1919">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="107" x="108" y="242.3354">[Standard Mode]</text><polygon fill="#A80036" points="494.5,264.3906,504.5,268.3906,494.5,272.3906,498.5,268.3906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="87.5" x2="500.5" y1="268.3906" y2="268.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="175" x="94.5" y="263.3247">Handle Display Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="269.5" y="263.3247">24-03</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="89" x="310.5" y="263.3247">) "Insert Card"</text><polygon fill="#A80036" points="98.5,293.5234,88.5,297.5234,98.5,301.5234,94.5,297.5234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="92.5" x2="505.5" y1="297.5234" y2="297.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="170" x="104.5" y="292.4575">Handle Display Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="274.5" y="292.4575">90-00</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="315.5" y="292.4575">)</text><polygon fill="#A80036" points="494.5,329.6563,504.5,333.6563,494.5,337.6563,498.5,333.6563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="87.5" x2="500.5" y1="333.6563" y2="333.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="176" x="94.5" y="328.5903">Card Detection Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="270.5" y="328.5903">23-01</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="311.5" y="328.5903">)</text><polygon fill="#A80036" points="98.5,358.7891,88.5,362.7891,98.5,366.7891,94.5,362.7891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="92.5" x2="505.5" y1="362.7891" y2="362.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="162" x="104.5" y="357.7231">Card Detection Response</text><polygon fill="#A80036" points="494.5,387.9219,504.5,391.9219,494.5,395.9219,498.5,391.9219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="87.5" x2="500.5" y1="391.9219" y2="391.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="94.5" y="386.856">Smart Card Activate Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="304.5" y="386.856">41-02</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="345.5" y="386.856">)</text><path d="M451.5,406.9219 L521.5,406.9219 L521.5,413.9219 L511.5,423.9219 L451.5,423.9219 L451.5,406.9219 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="46.2656" style="stroke: #000000; stroke-width: 2.0;" width="406" x="451.5" y="406.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="466.5" y="419.9888">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="316" x="536.5" y="419.1323">[If PlugIn for SDITrigger_ExtDataStore registered]</text><polygon fill="#A80036" points="793.5,441.1875,803.5,445.1875,793.5,449.1875,797.5,445.1875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="506.5" x2="799.5" y1="445.1875" y2="445.1875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="513.5" y="440.1216">processTrigger()</text><polygon fill="#A80036" points="98.5,477.3203,88.5,481.3203,98.5,485.3203,94.5,481.3203" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="92.5" x2="505.5" y1="481.3203" y2="481.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="104.5" y="476.2544">Smart Card Activate Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="28" x="309.5" y="476.2544">ATR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="337.5" y="476.2544">)</text><rect fill="#EEEEEE" filter="url(#f1kcnb4p0ztfkn)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1023.5" x="3" y="509.8867"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1026.5" y1="509.8867" y2="509.8867"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1026.5" y1="512.8867" y2="512.8867"/><rect fill="#EEEEEE" filter="url(#f1kcnb4p0ztfkn)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="164" x="432.75" y="499.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="145" x="438.75" y="515.3872">EMV CT Transaction</text><polygon fill="#A80036" points="494.5,549.5859,504.5,553.5859,494.5,557.5859,498.5,553.5859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="87.5" x2="500.5" y1="553.5859" y2="553.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="173" x="94.5" y="548.52">EMV_CT_StartTransaction (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="267.5" y="548.52">39-10</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="308.5" y="548.52">)</text><path d="M23,568.5859 L87,568.5859 L87,575.5859 L77,585.5859 L23,585.5859 L23,568.5859 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="538.5" x="23" y="568.5859"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="38" y="581.6528">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="108" x="102" y="580.7964">[Headless Mode]</text><polygon fill="#A80036" points="98.5,602.8516,88.5,606.8516,98.5,610.8516,94.5,606.8516" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="92.5" x2="505.5" y1="606.8516" y2="606.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="199" x="104.5" y="601.7856">Application Selection Callback (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="42" x="303.5" y="601.7856">BF-04</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="345.5" y="601.7856">)</text><polygon fill="#A80036" points="494.5,631.9844,504.5,635.9844,494.5,639.9844,498.5,635.9844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="87.5" x2="500.5" y1="635.9844" y2="635.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="130" x="94.5" y="630.9185">Selected Application</text><path d="M451.5,657.9844 L521.5,657.9844 L521.5,664.9844 L511.5,674.9844 L451.5,674.9844 L451.5,657.9844 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="46.2656" style="stroke: #000000; stroke-width: 2.0;" width="406" x="451.5" y="657.9844"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="466.5" y="671.0513">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="316" x="536.5" y="670.1948">[If PlugIn for SDITrigger_ExtDataStore registered]</text><polygon fill="#A80036" points="793.5,692.25,803.5,696.25,793.5,700.25,797.5,696.25" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="506.5" x2="799.5" y1="696.25" y2="696.25"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="513.5" y="691.1841">processTrigger()</text><polygon fill="#A80036" points="98.5,728.3828,88.5,732.3828,98.5,736.3828,94.5,732.3828" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="92.5" x2="505.5" y1="732.3828" y2="732.3828"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="239" x="104.5" y="727.3169">EMV_CT_StartTransaction Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="112" x="343.5" y="727.3169">Response Data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="455.5" y="727.3169">)</text><polygon fill="#A80036" points="494.5,757.5156,504.5,761.5156,494.5,765.5156,498.5,761.5156" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="87.5" x2="500.5" y1="761.5156" y2="761.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="235" x="94.5" y="756.4497">EMV_CT_ContinueOffline Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="329.5" y="756.4497">39-11</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="370.5" y="756.4497">)</text><path d="M13,776.5156 L90,776.5156 L90,783.5156 L80,793.5156 L13,793.5156 L13,776.5156 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="106.5313" style="stroke: #000000; stroke-width: 2.0;" width="558.5" x="13" y="776.5156"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="28" y="789.5825">loop</text><path d="M23,800.6484 L93,800.6484 L93,807.6484 L83,817.6484 L23,817.6484 L23,800.6484 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="538.5" x="23" y="800.6484"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="38" y="813.7153">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="108" x="108" y="812.8589">[Headless Mode]</text><polygon fill="#A80036" points="98.5,834.9141,88.5,838.9141,98.5,842.9141,94.5,838.9141" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="92.5" x2="505.5" y1="838.9141" y2="838.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="227" x="104.5" y="833.8481">Callbacks depending on EMV Config</text><polygon fill="#A80036" points="494.5,864.0469,504.5,868.0469,494.5,872.0469,498.5,868.0469" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="87.5" x2="500.5" y1="868.0469" y2="868.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="119" x="94.5" y="862.981">Callback Response</text><path d="M23,897.0469 L87,897.0469 L87,904.0469 L77,914.0469 L23,914.0469 L23,897.0469 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="538.5" x="23" y="897.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="38" y="910.1138">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="108" x="102" y="909.2573">[Headless Mode]</text><polygon fill="#A80036" points="98.5,931.3125,88.5,935.3125,98.5,939.3125,94.5,935.3125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="92.5" x2="505.5" y1="935.3125" y2="935.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="203" x="104.5" y="930.2466">Amount Confirmation Callback (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="42" x="307.5" y="930.2466">BF-02</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="349.5" y="930.2466">)</text><polygon fill="#A80036" points="494.5,960.4453,504.5,964.4453,494.5,968.4453,498.5,964.4453" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="87.5" x2="500.5" y1="964.4453" y2="964.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="82" x="94.5" y="959.3794">Confirmation</text><path d="M451.5,986.4453 L521.5,986.4453 L521.5,993.4453 L511.5,1003.4453 L451.5,1003.4453 L451.5,986.4453 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="46.2656" style="stroke: #000000; stroke-width: 2.0;" width="406" x="451.5" y="986.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="466.5" y="999.5122">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="316" x="536.5" y="998.6558">[If PlugIn for SDITrigger_ExtDataStore registered]</text><polygon fill="#A80036" points="793.5,1020.7109,803.5,1024.7109,793.5,1028.7109,797.5,1024.7109" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="506.5" x2="799.5" y1="1024.7109" y2="1024.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="513.5" y="1019.645">processTrigger()</text><path d="M13,1046.7109 L77,1046.7109 L77,1053.7109 L67,1063.7109 L13,1063.7109 L13,1046.7109 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="193.9297" style="stroke: #000000; stroke-width: 2.0;" width="558.5" x="13" y="1046.7109"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="28" y="1059.7778">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="108" x="92" y="1058.9214">[Headless Mode]</text><polygon fill="#A80036" points="98.5,1080.9766,88.5,1084.9766,98.5,1088.9766,94.5,1084.9766" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="92.5" x2="505.5" y1="1084.9766" y2="1084.9766"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="124" x="104.5" y="1079.9106">PIN Entry Callback (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="42" x="228.5" y="1079.9106">BF-08</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="270.5" y="1079.9106">)</text><polygon fill="#A80036" points="494.5,1110.1094,504.5,1114.1094,494.5,1118.1094,498.5,1114.1094" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="87.5" x2="500.5" y1="1114.1094" y2="1114.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="94.5" y="1109.0435">PED Get PIN Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="252.5" y="1109.0435">22-01</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="293.5" y="1109.0435">)</text><path d="M23,1129.1094 L100,1129.1094 L100,1136.1094 L90,1146.1094 L23,1146.1094 L23,1129.1094 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="46.2656" style="stroke: #000000; stroke-width: 2.0;" width="538.5" x="23" y="1129.1094"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="32" x="38" y="1142.1763">loop</text><polygon fill="#A80036" points="98.5,1163.375,88.5,1167.375,98.5,1171.375,94.5,1167.375" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="92.5" x2="505.5" y1="1167.375" y2="1167.375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="108" x="104.5" y="1162.3091">Status Callback (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="43" x="212.5" y="1162.3091">9F-XX</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="255.5" y="1162.3091">)</text><polygon fill="#A80036" points="98.5,1199.5078,88.5,1203.5078,98.5,1207.5078,94.5,1203.5078" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="92.5" x2="505.5" y1="1203.5078" y2="1203.5078"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="153" x="104.5" y="1198.4419">PED Get PIN Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="257.5" y="1198.4419">90-00</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="298.5" y="1198.4419">)</text><polygon fill="#A80036" points="494.5,1228.6406,504.5,1232.6406,494.5,1236.6406,498.5,1232.6406" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="87.5" x2="500.5" y1="1232.6406" y2="1232.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="101" x="94.5" y="1227.5747">PIN Entry Result</text><path d="M451.5,1254.6406 L521.5,1254.6406 L521.5,1261.6406 L511.5,1271.6406 L451.5,1271.6406 L451.5,1254.6406 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="46.2656" style="stroke: #000000; stroke-width: 2.0;" width="394" x="451.5" y="1254.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="466.5" y="1267.7075">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="274" x="536.5" y="1266.8511">[If PlugIn for SDITrigger_CardId registered]</text><polygon fill="#A80036" points="793.5,1288.9063,803.5,1292.9063,793.5,1296.9063,797.5,1292.9063" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="506.5" x2="799.5" y1="1292.9063" y2="1292.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="131" x="513.5" y="1287.8403">processTrigger(PAN)</text><path d="M451.5,1314.9063 L521.5,1314.9063 L521.5,1321.9063 L511.5,1331.9063 L451.5,1331.9063 L451.5,1314.9063 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="46.2656" style="stroke: #000000; stroke-width: 2.0;" width="413" x="451.5" y="1314.9063"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="466.5" y="1327.9731">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="323" x="536.5" y="1327.1167">[If PlugIn for SDITrigger_CardDataAvail registered]</text><polygon fill="#A80036" points="793.5,1349.1719,803.5,1353.1719,793.5,1357.1719,797.5,1353.1719" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="506.5" x2="799.5" y1="1353.1719" y2="1353.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="513.5" y="1348.106">processTrigger(Sensitive Data)</text><path d="M451.5,1375.1719 L521.5,1375.1719 L521.5,1382.1719 L511.5,1392.1719 L451.5,1392.1719 L451.5,1375.1719 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="46.2656" style="stroke: #000000; stroke-width: 2.0;" width="406" x="451.5" y="1375.1719"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="466.5" y="1388.2388">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="316" x="536.5" y="1387.3823">[If PlugIn for SDITrigger_ExtDataStore registered]</text><polygon fill="#A80036" points="793.5,1409.4375,803.5,1413.4375,793.5,1417.4375,797.5,1413.4375" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="506.5" x2="799.5" y1="1413.4375" y2="1413.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="513.5" y="1408.3716">processTrigger()</text><polygon fill="#A80036" points="98.5,1445.5703,88.5,1449.5703,98.5,1453.5703,94.5,1449.5703" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="92.5" x2="505.5" y1="1449.5703" y2="1449.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="104.5" y="1444.5044">EMV_CT_ContinueOffline Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="112" x="334.5" y="1444.5044">Response Data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="446.5" y="1444.5044">)</text><rect fill="#EEEEEE" filter="url(#f1kcnb4p0ztfkn)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1023.5" x="3" y="1478.1367"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1026.5" y1="1478.1367" y2="1478.1367"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1026.5" y1="1481.1367" y2="1481.1367"/><rect fill="#EEEEEE" filter="url(#f1kcnb4p0ztfkn)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="155" x="437.25" y="1467.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="136" x="443.25" y="1483.6372">Get Encrypted PIN</text><polygon fill="#A80036" points="494.5,1517.8359,504.5,1521.8359,494.5,1525.8359,498.5,1521.8359" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="87.5" x2="500.5" y1="1521.8359" y2="1521.8359"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="94.5" y="1516.77">Crypto Open Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="254.5" y="1516.77">70-00</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="295.5" y="1516.77">)</text><polygon fill="#A80036" points="98.5,1546.9688,88.5,1550.9688,98.5,1554.9688,94.5,1550.9688" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="92.5" x2="505.5" y1="1550.9688" y2="1550.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="104.5" y="1545.9028">Crypto Open Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="106" x="259.5" y="1545.9028">Crypto Handle</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="365.5" y="1545.9028">)</text><polygon fill="#A80036" points="494.5,1576.1016,504.5,1580.1016,494.5,1584.1016,498.5,1580.1016" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="87.5" x2="500.5" y1="1580.1016" y2="1580.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="240" x="94.5" y="1575.0356">Crypto Get encrypted Pin Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="334.5" y="1575.0356">70-08</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="375.5" y="1575.0356">)</text><path d="M451.5,1595.1016 L521.5,1595.1016 L521.5,1602.1016 L511.5,1612.1016 L451.5,1612.1016 L451.5,1595.1016 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="46.2656" style="stroke: #000000; stroke-width: 2.0;" width="401" x="451.5" y="1595.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="466.5" y="1608.1685">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="311" x="536.5" y="1607.312">[If PlugIn for SDITrigger_ExternalCSD registered]</text><polygon fill="#A80036" points="793.5,1629.3672,803.5,1633.3672,793.5,1637.3672,797.5,1633.3672" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="506.5" x2="799.5" y1="1633.3672" y2="1633.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="104" x="513.5" y="1628.3013">processTrigger()</text><polygon fill="#A80036" points="98.5,1665.5,88.5,1669.5,98.5,1673.5,94.5,1669.5" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="92.5" x2="505.5" y1="1669.5" y2="1669.5"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="235" x="104.5" y="1664.4341">Crypto Get encrypted Pin Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="150" x="339.5" y="1664.4341">Encrypted PIN block</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="494.5" y="1664.4341">)</text><polygon fill="#A80036" points="494.5,1694.6328,504.5,1698.6328,494.5,1702.6328,498.5,1698.6328" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="87.5" x2="500.5" y1="1698.6328" y2="1698.6328"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="94.5" y="1693.5669">Crypto Close Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="255.5" y="1693.5669">70-01</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="296.5" y="1693.5669">)</text><polygon fill="#A80036" points="98.5,1723.7656,88.5,1727.7656,98.5,1731.7656,94.5,1727.7656" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="92.5" x2="505.5" y1="1727.7656" y2="1727.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="104.5" y="1722.6997">Crypto Close Response</text><rect fill="#EEEEEE" filter="url(#f1kcnb4p0ztfkn)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1023.5" x="3" y="1756.332"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1026.5" y1="1756.332" y2="1756.332"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1026.5" y1="1759.332" y2="1759.332"/><rect fill="#EEEEEE" filter="url(#f1kcnb4p0ztfkn)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="304" x="362.75" y="1745.7656"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="285" x="368.75" y="1761.8325">Fetch None Sensitive Transaction Data</text><polygon fill="#A80036" points="494.5,1796.0313,504.5,1800.0313,494.5,1804.0313,498.5,1800.0313" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="87.5" x2="500.5" y1="1800.0313" y2="1800.0313"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="94.5" y="1794.9653">fetchTrxTags Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="255.5" y="1794.9653">29-02</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="296.5" y="1794.9653">)</text><polygon fill="#A80036" points="98.5,1825.1641,88.5,1829.1641,98.5,1833.1641,94.5,1829.1641" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="92.5" x2="505.5" y1="1829.1641" y2="1829.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="104.5" y="1824.0981">fetchTrxTags Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="225" x="260.5" y="1824.0981">None sensitive Response Tags</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="485.5" y="1824.0981">)</text><rect fill="#EEEEEE" filter="url(#f1kcnb4p0ztfkn)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1023.5" x="3" y="1857.7305"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1026.5" y1="1857.7305" y2="1857.7305"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1026.5" y1="1860.7305" y2="1860.7305"/><rect fill="#EEEEEE" filter="url(#f1kcnb4p0ztfkn)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="337" x="346.25" y="1847.1641"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="318" x="352.25" y="1863.231">Get encrypted (sensitive) Transaction Data</text><polygon fill="#A80036" points="494.5,1897.4297,504.5,1901.4297,494.5,1905.4297,498.5,1901.4297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="87.5" x2="500.5" y1="1901.4297" y2="1901.4297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="160" x="94.5" y="1896.3638">Crypto Open Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="254.5" y="1896.3638">70-00</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="295.5" y="1896.3638">)</text><polygon fill="#A80036" points="98.5,1926.5625,88.5,1930.5625,98.5,1934.5625,94.5,1930.5625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="92.5" x2="505.5" y1="1930.5625" y2="1930.5625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="104.5" y="1925.4966">Crypto Open Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="106" x="259.5" y="1925.4966">Crypto Handle</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="365.5" y="1925.4966">)</text><polygon fill="#A80036" points="494.5,1955.6953,504.5,1959.6953,494.5,1963.6953,498.5,1959.6953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="87.5" x2="500.5" y1="1959.6953" y2="1959.6953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="94.5" y="1954.6294">getEncData Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="249.5" y="1954.6294">29-00</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="290.5" y="1954.6294">)</text><polygon fill="#A80036" points="98.5,1984.8281,88.5,1988.8281,98.5,1992.8281,94.5,1988.8281" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="92.5" x2="505.5" y1="1988.8281" y2="1988.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="104.5" y="1983.7622">getEncData Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="115" x="254.5" y="1983.7622">Encrypted Data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="369.5" y="1983.7622">)</text><rect fill="#EEEEEE" filter="url(#f1kcnb4p0ztfkn)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1023.5" x="3" y="2017.3945"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1026.5" y1="2017.3945" y2="2017.3945"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1026.5" y1="2020.3945" y2="2020.3945"/><rect fill="#EEEEEE" filter="url(#f1kcnb4p0ztfkn)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="236" x="396.75" y="2006.8281"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="217" x="402.75" y="2022.895">Get encrypted Message Data</text><polygon fill="#A80036" points="494.5,2057.0938,504.5,2061.0938,494.5,2065.0938,498.5,2061.0938" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="87.5" x2="500.5" y1="2061.0938" y2="2061.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="181" x="94.5" y="2056.0278">getEncMsgData Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="275.5" y="2056.0278">29-01</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="316.5" y="2056.0278">)</text><path d="M451.5,2076.0938 L521.5,2076.0938 L521.5,2083.0938 L511.5,2093.0938 L451.5,2093.0938 L451.5,2076.0938 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="46.2656" style="stroke: #000000; stroke-width: 2.0;" width="401" x="451.5" y="2076.0938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="466.5" y="2089.1606">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="311" x="536.5" y="2088.3042">[If PlugIn for SDITrigger_MsgDataAvail registerd]</text><polygon fill="#A80036" points="793.5,2110.3594,803.5,2114.3594,793.5,2118.3594,797.5,2114.3594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="506.5" x2="799.5" y1="2114.3594" y2="2114.3594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="275" x="513.5" y="2109.2935">processTrigger(Message Data in clear text)</text><polygon fill="#A80036" points="98.5,2146.4922,88.5,2150.4922,98.5,2154.4922,94.5,2150.4922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="92.5" x2="505.5" y1="2150.4922" y2="2150.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="341" x="104.5" y="2145.4263">getEncMsgData Response (Encrypted Message Data)</text><rect fill="#EEEEEE" filter="url(#f1kcnb4p0ztfkn)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1023.5" x="3" y="2179.0586"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1026.5" y1="2179.0586" y2="2179.0586"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1026.5" y1="2182.0586" y2="2182.0586"/><rect fill="#EEEEEE" filter="url(#f1kcnb4p0ztfkn)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="192" x="418.75" y="2168.4922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="173" x="424.75" y="2184.5591">Get Message Signature</text><path d="M23,2208.625 L93,2208.625 L93,2215.625 L83,2225.625 L23,2225.625 L23,2208.625 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="538.5" x="23" y="2208.625"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="38" y="2221.6919">opt</text><polygon fill="#A80036" points="494.5,2242.8906,504.5,2246.8906,494.5,2250.8906,498.5,2246.8906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="87.5" x2="500.5" y1="2246.8906" y2="2246.8906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="189" x="94.5" y="2241.8247">getMsgSignature Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="283.5" y="2241.8247">29-04</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="324.5" y="2241.8247">)</text><polygon fill="#A80036" points="98.5,2272.0234,88.5,2276.0234,98.5,2280.0234,94.5,2276.0234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="92.5" x2="505.5" y1="2276.0234" y2="2276.0234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="184" x="104.5" y="2270.9575">getMsgSignature Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="142" x="288.5" y="2270.9575">Message Signature</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="430.5" y="2270.9575">)</text><polygon fill="#A80036" points="494.5,2308.1563,504.5,2312.1563,494.5,2316.1563,498.5,2312.1563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="87.5" x2="500.5" y1="2312.1563" y2="2312.1563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="161" x="94.5" y="2307.0903">Crypto Close Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="255.5" y="2307.0903">70-01</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="296.5" y="2307.0903">)</text><polygon fill="#A80036" points="98.5,2337.2891,88.5,2341.2891,98.5,2345.2891,94.5,2341.2891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="92.5" x2="505.5" y1="2341.2891" y2="2341.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="147" x="104.5" y="2336.2231">Crypto Close Response</text><path d="M23,2356.2891 L93,2356.2891 L93,2363.2891 L83,2373.2891 L23,2373.2891 L23,2356.2891 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="75.3984" style="stroke: #000000; stroke-width: 2.0;" width="538.5" x="23" y="2356.2891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="25" x="38" y="2369.356">opt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="364" x="108" y="2368.4995">[Depending on EMV CT Continue Offline Response Code]</text><polygon fill="#A80036" points="494.5,2390.5547,504.5,2394.5547,494.5,2398.5547,498.5,2394.5547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="87.5" x2="500.5" y1="2394.5547" y2="2394.5547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="235" x="94.5" y="2389.4888">EMV_CT_ContinueOnline Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="329.5" y="2389.4888">39-12</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="370.5" y="2389.4888">)</text><polygon fill="#A80036" points="98.5,2419.6875,88.5,2423.6875,98.5,2427.6875,94.5,2423.6875" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="92.5" x2="505.5" y1="2423.6875" y2="2423.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="230" x="104.5" y="2418.6216">EMV_CT_ContinueOnline Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="112" x="334.5" y="2418.6216">Response Data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="446.5" y="2418.6216">)</text><rect fill="#EEEEEE" filter="url(#f1kcnb4p0ztfkn)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1023.5" x="3" y="2459.2539"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1026.5" y1="2459.2539" y2="2459.2539"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1026.5" y1="2462.2539" y2="2462.2539"/><rect fill="#EEEEEE" filter="url(#f1kcnb4p0ztfkn)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="269" x="380.25" y="2448.6875"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="250" x="386.25" y="2464.7544">Clear (sensitive) Transaction Data</text><path d="M23,2488.8203 L147,2488.8203 L147,2495.8203 L137,2505.8203 L23,2505.8203 L23,2488.8203 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="85.3984" style="stroke: #000000; stroke-width: 2.0;" width="993.5" x="23" y="2488.8203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="79" x="38" y="2501.8872">Mandatory</text><polygon fill="#A80036" points="494.5,2528.0859,504.5,2532.0859,494.5,2536.0859,498.5,2532.0859" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="87.5" x2="500.5" y1="2532.0859" y2="2532.0859"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="177" x="94.5" y="2527.02">clearDataStore Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="271.5" y="2527.02">29-03</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="312.5" y="2527.02">)</text><path d="M511,2510.9531 L511,2535.9531 L997,2535.9531 L997,2520.9531 L987,2510.9531 L511,2510.9531 " fill="#FBFB77" filter="url(#f1kcnb4p0ztfkn)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M987,2510.9531 L987,2520.9531 L997,2520.9531 L987,2510.9531 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="465" x="517" y="2528.02">automatically cleaned after 8 minutes or with the begining of the next trx</text><polygon fill="#A80036" points="98.5,2562.2188,88.5,2566.2188,98.5,2570.2188,94.5,2566.2188" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="92.5" x2="505.5" y1="2566.2188" y2="2566.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="163" x="104.5" y="2561.1528">clearDataStore Response</text><rect fill="#EEEEEE" filter="url(#f1kcnb4p0ztfkn)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="1023.5" x="3" y="2601.7852"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1026.5" y1="2601.7852" y2="2601.7852"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="1026.5" y1="2604.7852" y2="2604.7852"/><rect fill="#EEEEEE" filter="url(#f1kcnb4p0ztfkn)" height="23.1328" style="stroke: #000000; stroke-width: 2.0;" width="194" x="417.75" y="2591.2188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="175" x="423.75" y="2607.2856">Exit EMV CT Framework</text><polygon fill="#A80036" points="494.5,2641.4844,504.5,2645.4844,494.5,2649.4844,498.5,2645.4844" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="87.5" x2="500.5" y1="2645.4844" y2="2645.4844"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="238" x="94.5" y="2640.4185">EMV_CT_Exit_Framework Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="332.5" y="2640.4185">39-00</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="373.5" y="2640.4185">)</text><polygon fill="#A80036" points="98.5,2670.6172,88.5,2674.6172,98.5,2678.6172,94.5,2674.6172" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="92.5" x2="505.5" y1="2674.6172" y2="2674.6172"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="233" x="104.5" y="2669.5513">EMV_CT_Exit_Framework Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="337.5" y="2669.5513">90-00</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="378.5" y="2669.5513">)</text><!--
@startuml

title SDI: EMV-CT Basic Transaction Flow

participant "Payment App" order 10
participant "SDI-Server" order 20
participant "PlugIn" order 30

== Initialize EMV CT Framework ==

"Payment App" -> "SDI-Server": EMV_CT_Init_Framework Command (<b>39-00</b>)
"SDI-Server" - -> "Payment App": EMV_CT_Init_Framework Response (<b>90-00</b>)

== Card Reading ==

opt Standard Mode
  "Payment App" -> "SDI-Server": Handle Display Command (<b>24-03</b>) "Insert Card"
  "SDI-Server" - -> "Payment App": Handle Display Response (<b>90-00</b>)
end

"Payment App" -> "SDI-Server": Card Detection Command (<b>23-01</b>)
"SDI-Server" - -> "Payment App": Card Detection Response

"Payment App" -> "SDI-Server": Smart Card Activate Command (<b>41-02</b>)
opt If PlugIn for SDITrigger_ExtDataStore registered
  "SDI-Server" -> "PlugIn": processTrigger()
end
"SDI-Server" - -> "Payment App": Smart Card Activate Response (<b>ATR</b>)

== EMV CT Transaction ==

"Payment App" -> "SDI-Server": EMV_CT_StartTransaction (<b>39-10</b>)

alt Headless Mode
  "SDI-Server" -> "Payment App": Application Selection Callback (<b>BF-04</b>)
  "Payment App" - -> "SDI-Server": Selected Application
end
opt If PlugIn for SDITrigger_ExtDataStore registered
  "SDI-Server" -> "PlugIn": processTrigger()
end
"SDI-Server" - -> "Payment App": EMV_CT_StartTransaction Response (<b>Response Data</b>)

"Payment App" -> "SDI-Server": EMV_CT_ContinueOffline Command (<b>39-11</b>)

loop
  opt Headless Mode
    "SDI-Server" -> "Payment App": Callbacks depending on EMV Config
    "Payment App" - -> "SDI-Server": Callback Response
  end
end

alt Headless Mode
  "SDI-Server" -> "Payment App": Amount Confirmation Callback (<b>BF-02</b>)
  "Payment App" - -> "SDI-Server": Confirmation
end

opt If PlugIn for SDITrigger_ExtDataStore registered
  "SDI-Server" -> "PlugIn": processTrigger()
end

alt Headless Mode
  "SDI-Server" -> "Payment App": PIN Entry Callback (<b>BF-08</b>)
  "Payment App" -> "SDI-Server": PED Get PIN Command (<b>22-01</b>)
  loop
    "SDI-Server" -> "Payment App": Status Callback (<b>9F-XX</b>)
  end
  "SDI-Server" - -> "Payment App": PED Get PIN Response (<b>90-00</b>)
  "Payment App" - -> "SDI-Server": PIN Entry Result
end

opt If PlugIn for SDITrigger_CardId registered
  "SDI-Server" -> "PlugIn": processTrigger(PAN)
end
opt If PlugIn for SDITrigger_CardDataAvail registered
  "SDI-Server" -> "PlugIn": processTrigger(Sensitive Data)
end
opt If PlugIn for SDITrigger_ExtDataStore registered
  "SDI-Server" -> "PlugIn": processTrigger()
end
"SDI-Server" - -> "Payment App": EMV_CT_ContinueOffline Response (<b>Response Data</b>)

== Get Encrypted PIN ==

"Payment App" -> "SDI-Server": Crypto Open Command (<b>70-00</b>)
"SDI-Server" - -> "Payment App": Crypto Open Response (<b>Crypto Handle</b>)

"Payment App" -> "SDI-Server": Crypto Get encrypted Pin Command (<b>70-08</b>)
opt If PlugIn for SDITrigger_ExternalCSD registered
  "SDI-Server" -> "PlugIn": processTrigger()
end
"SDI-Server" - -> "Payment App": Crypto Get encrypted Pin Response (<b>Encrypted PIN block </b>)

"Payment App" -> "SDI-Server": Crypto Close Command (<b>70-01</b>)
"SDI-Server" - -> "Payment App": Crypto Close Response

== Fetch None Sensitive Transaction Data ==

"Payment App" -> "SDI-Server": fetchTrxTags Command (<b>29-02</b>)
"SDI-Server" - -> "Payment App": fetchTrxTags Response (<b>None sensitive Response Tags</b>)

== Get encrypted (sensitive) Transaction Data ==

"Payment App" -> "SDI-Server": Crypto Open Command (<b>70-00</b>)
"SDI-Server" - -> "Payment App": Crypto Open Response (<b>Crypto Handle</b>)

"Payment App" -> "SDI-Server": getEncData Command (<b>29-00</b>)
"SDI-Server" - -> "Payment App": getEncData Response (<b>Encrypted Data</b>)

== Get encrypted Message Data ==

"Payment App" -> "SDI-Server": getEncMsgData Command (<b>29-01</b>)
opt If PlugIn for SDITrigger_MsgDataAvail registerd
  "SDI-Server" -> "PlugIn": processTrigger(Message Data in clear text)
end
"SDI-Server" - -> "Payment App": getEncMsgData Response (Encrypted Message Data)

== Get Message Signature ==

opt
 "Payment App" -> "SDI-Server": getMsgSignature Command (<b>29-04</b>)
 "SDI-Server" - -> "Payment App": getMsgSignature Response (<b>Message Signature</b>)
end

"Payment App" -> "SDI-Server": Crypto Close Command (<b>70-01</b>)
"SDI-Server" - -> "Payment App": Crypto Close Response

opt Depending on EMV CT Continue Offline Response Code
  "Payment App" -> "SDI-Server": EMV_CT_ContinueOnline Command (<b>39-12</b>)
  "SDI-Server" - -> "Payment App": EMV_CT_ContinueOnline Response (<b>Response Data</b>)
end

== Clear (sensitive) Transaction Data ==

group Mandatory
  "Payment App" -> "SDI-Server": clearDataStore Command (<b>29-03</b>)
  note right: automatically cleaned after 8 minutes or with the begining of the next trx
  "SDI-Server" - -> "Payment App": clearDataStore Response
end

== Exit EMV CT Framework ==

"Payment App" -> "SDI-Server": EMV_CT_Exit_Framework Command (<b>39-00</b>)
"SDI-Server" - -> "Payment App": EMV_CT_Exit_Framework Response (<b>90-00</b>)

@enduml

PlantUML version 1.2019.03(Sun Mar 10 04:04:44 PDT 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 17.0.15+6-Ubuntu-0ubuntu120.04
Operating System: Linux
OS Version: 5.15.0-1089-azure
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>