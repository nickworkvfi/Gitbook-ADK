<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1597px" preserveAspectRatio="none" style="width:1093px;height:1597px;" version="1.1" viewBox="0 0 1093 1597" width="1093px" zoomAndPan="magnify"><defs><filter height="300%" id="f3g52cduqnsqf" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="687" x="203.5" y="22.9951">SDI: Hybrid Cardreader Asynchronous Card Detection (23-03) scenarios (polling mode)</text><rect fill="#FFFFFF" filter="url(#f3g52cduqnsqf)" height="1454.5313" style="stroke: #000000; stroke-width: 2.0;" width="1069" x="12" y="85.5938"/><rect fill="#FFFFFF" filter="url(#f3g52cduqnsqf)" height="271" style="stroke: #000000; stroke-width: 2.0;" width="1049" x="22" y="380.7891"/><rect fill="#FFFFFF" height="224.7344" style="stroke: none; stroke-width: 1.0;" width="1049" x="22" y="427.0547"/><rect fill="#FFFFFF" height="418.0703" style="stroke: none; stroke-width: 1.0;" width="1069" x="12" y="686.7891"/><rect fill="#FFFFFF" filter="url(#f3g52cduqnsqf)" height="90.2031" style="stroke: #000000; stroke-width: 2.0;" width="752.5" x="178" y="979.6563"/><rect fill="#FFFFFF" height="43.9375" style="stroke: none; stroke-width: 1.0;" width="752.5" x="178" y="1025.9219"/><rect fill="#FFFFFF" height="435.2656" style="stroke: none; stroke-width: 1.0;" width="1069" x="12" y="1104.8594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242" x2="242" y1="68.5938" y2="219.2578"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="242" x2="242" y1="219.2578" y2="247.2578"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242" x2="242" y1="247.2578" y2="658.7891"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="242" x2="242" y1="658.7891" y2="686.7891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242" x2="242" y1="686.7891" y2="818.125"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="242" x2="242" y1="818.125" y2="846.125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242" x2="242" y1="846.125" y2="1076.8594"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="242" x2="242" y1="1076.8594" y2="1104.8594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242" x2="242" y1="1104.8594" y2="1236.1953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="242" x2="242" y1="1236.1953" y2="1264.1953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242" x2="242" y1="1264.1953" y2="1386.7266"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="242" x2="242" y1="1386.7266" y2="1414.7266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242" x2="242" y1="1414.7266" y2="1512.125"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="242" x2="242" y1="1512.125" y2="1540.125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242" x2="242" y1="1540.125" y2="1557.125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="875.5" x2="875.5" y1="68.5938" y2="219.2578"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="875.5" x2="875.5" y1="219.2578" y2="247.2578"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="875.5" x2="875.5" y1="247.2578" y2="658.7891"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="875.5" x2="875.5" y1="658.7891" y2="686.7891"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="875.5" x2="875.5" y1="686.7891" y2="818.125"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="875.5" x2="875.5" y1="818.125" y2="846.125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="875.5" x2="875.5" y1="846.125" y2="1076.8594"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="875.5" x2="875.5" y1="1076.8594" y2="1104.8594"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="875.5" x2="875.5" y1="1104.8594" y2="1236.1953"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="875.5" x2="875.5" y1="1236.1953" y2="1264.1953"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="875.5" x2="875.5" y1="1264.1953" y2="1386.7266"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="875.5" x2="875.5" y1="1386.7266" y2="1414.7266"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="875.5" x2="875.5" y1="1414.7266" y2="1512.125"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 1.0,4.0;" x1="875.5" x2="875.5" y1="1512.125" y2="1540.125"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="875.5" x2="875.5" y1="1540.125" y2="1557.125"/><rect fill="#FEFECE" filter="url(#f3g52cduqnsqf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="105" x="188" y="33.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="91" x="195" y="53.292">Payment App</text><rect fill="#FEFECE" filter="url(#f3g52cduqnsqf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="105" x="188" y="1556.125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="91" x="195" y="1576.1201">Payment App</text><rect fill="#FEFECE" filter="url(#f3g52cduqnsqf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="86" x="830.5" y="33.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="837.5" y="53.292">SDI-Server</text><rect fill="#FEFECE" filter="url(#f3g52cduqnsqf)" height="30.2969" style="stroke: #A80036; stroke-width: 1.5;" width="86" x="830.5" y="1556.125"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="72" x="837.5" y="1576.1201">SDI-Server</text><path d="M12,85.5938 L76,85.5938 L76,92.5938 L66,102.5938 L12,102.5938 L12,85.5938 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="1454.5313" style="stroke: #000000; stroke-width: 2.0;" width="1069" x="12" y="85.5938"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="27" y="98.6606">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="473" x="91" y="97.8042">[Start Card Detection (23-03) with card technology chip and msr enabled]</text><polygon fill="#A80036" points="863.5,119.8594,873.5,123.8594,863.5,127.8594,867.5,123.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242.5" x2="869.5" y1="123.8594" y2="123.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="212" x="249.5" y="118.7935">Start Card Detection Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="208" x="461.5" y="118.7935">23-03 with tag DFA108 = 03</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="669.5" y="118.7935">)</text><polygon fill="#A80036" points="253.5,148.9922,243.5,152.9922,253.5,156.9922,249.5,152.9922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="247.5" x2="874.5" y1="152.9922" y2="152.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="207" x="259.5" y="147.9263">Start Card Detection Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="466.5" y="147.9263">90-00</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="507.5" y="147.9263">)</text><polygon fill="#A80036" points="863.5,178.125,873.5,182.125,863.5,186.125,867.5,182.125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242.5" x2="869.5" y1="182.125" y2="182.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="249.5" y="177.0591">Poll Card Detection Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="451.5" y="177.0591">23-04</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="492.5" y="177.0591">)</text><polygon fill="#A80036" points="253.5,207.2578,243.5,211.2578,253.5,215.2578,249.5,211.2578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="247.5" x2="874.5" y1="211.2578" y2="211.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="259.5" y="206.1919">Poll Card Detection Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="178" x="456.5" y="206.1919">90-00 with DFA108 = 00</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="634.5" y="206.1919">)</text><path d="M880,252.2578 L880,277.2578 L1052,277.2578 L1052,262.2578 L1042,252.2578 L880,252.2578 " fill="#FBFB77" filter="url(#f3g52cduqnsqf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1042,252.2578 L1042,262.2578 L1052,262.2578 L1042,252.2578 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="886" y="269.3247">Customer card inserted</text><polygon fill="#A80036" points="863.5,303.5234,873.5,307.5234,863.5,311.5234,867.5,307.5234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242.5" x2="869.5" y1="307.5234" y2="307.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="249.5" y="302.4575">Poll Card Detection Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="451.5" y="302.4575">23-04</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="492.5" y="302.4575">)</text><polygon fill="#A80036" points="253.5,332.6563,243.5,336.6563,253.5,340.6563,249.5,336.6563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="247.5" x2="874.5" y1="336.6563" y2="336.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="259.5" y="331.5903">Poll Card Detection Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="178" x="456.5" y="331.5903">90-00 with DFA108 = 01</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="634.5" y="331.5903">)</text><polygon fill="#A80036" points="863.5,361.7891,873.5,365.7891,863.5,369.7891,867.5,365.7891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242.5" x2="869.5" y1="365.7891" y2="365.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="249.5" y="360.7231">Smart Card Activate Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="459.5" y="360.7231">41-02</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="500.5" y="360.7231">)</text><path d="M22,380.7891 L86,380.7891 L86,387.7891 L76,397.7891 L22,397.7891 L22,380.7891 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="271" style="stroke: #000000; stroke-width: 2.0;" width="1049" x="22" y="380.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="37" y="393.856">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="222" x="101" y="392.9995">[Chip card activation successfully]</text><polygon fill="#A80036" points="253.5,415.0547,243.5,419.0547,253.5,423.0547,249.5,419.0547" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="247.5" x2="874.5" y1="419.0547" y2="419.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="259.5" y="413.9888">Smart Card Activate Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90" x="464.5" y="413.9888">90-00 + ATR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="554.5" y="413.9888">)</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="22" x2="1071" y1="428.0547" y2="428.0547"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="180" x="27" y="438.2651">[Chip card activation failed]</text><polygon fill="#A80036" points="253.5,458.9922,243.5,462.9922,253.5,466.9922,249.5,462.9922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="247.5" x2="874.5" y1="462.9922" y2="462.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="259.5" y="457.9263">Smart Card Activate Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="464.5" y="457.9263">94-03</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="505.5" y="457.9263">)</text><polygon fill="#A80036" points="863.5,488.125,873.5,492.125,863.5,496.125,867.5,492.125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242.5" x2="869.5" y1="492.125" y2="492.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="144" x="249.5" y="487.0591">MSR Read Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="393.5" y="487.0591">21-01</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="434.5" y="487.0591">)</text><polygon fill="#A80036" points="253.5,517.2578,243.5,521.2578,253.5,525.2578,249.5,521.2578" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="247.5" x2="874.5" y1="521.2578" y2="521.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="259.5" y="516.1919">Card Removal Callback (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="414.5" y="516.1919">9E-04</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="455.5" y="516.1919">)</text><path d="M32,534.2578 L32,574.2578 L233,574.2578 L233,544.2578 L223,534.2578 L32,534.2578 " fill="#FBFB77" filter="url(#f3g52cduqnsqf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M223,534.2578 L223,544.2578 L233,544.2578 L223,534.2578 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="176" x="38" y="551.3247">Payment application should</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="38" y="566.4575">display remove card</text><path d="M880,588.5234 L880,613.5234 L1057,613.5234 L1057,598.5234 L1047,588.5234 L880,588.5234 " fill="#FBFB77" filter="url(#f3g52cduqnsqf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1047,588.5234 L1047,598.5234 L1057,598.5234 L1047,588.5234 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="886" y="605.5903">Customer card removed</text><polygon fill="#A80036" points="253.5,639.7891,243.5,643.7891,253.5,647.7891,249.5,643.7891" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="247.5" x2="874.5" y1="643.7891" y2="643.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="139" x="259.5" y="638.7231">MSR Read Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="205" x="398.5" y="638.7231">90-00 with obfuscated data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="603.5" y="638.7231">)</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="12" x2="1081" y1="687.7891" y2="687.7891"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="449" x="17" y="697.9995">[Start Card Detection (23-03) with card technology chip enabled only]</text><polygon fill="#A80036" points="863.5,718.7266,873.5,722.7266,863.5,726.7266,867.5,722.7266" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242.5" x2="869.5" y1="722.7266" y2="722.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="212" x="249.5" y="717.6606">Start Card Detection Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="208" x="461.5" y="717.6606">23-03 with tag DFA108 = 01</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="669.5" y="717.6606">)</text><polygon fill="#A80036" points="253.5,747.8594,243.5,751.8594,253.5,755.8594,249.5,751.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="247.5" x2="874.5" y1="751.8594" y2="751.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="207" x="259.5" y="746.7935">Start Card Detection Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="466.5" y="746.7935">90-00</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="507.5" y="746.7935">)</text><polygon fill="#A80036" points="863.5,776.9922,873.5,780.9922,863.5,784.9922,867.5,780.9922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242.5" x2="869.5" y1="780.9922" y2="780.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="249.5" y="775.9263">Poll Card Detection Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="451.5" y="775.9263">23-04</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="492.5" y="775.9263">)</text><polygon fill="#A80036" points="253.5,806.125,243.5,810.125,253.5,814.125,249.5,810.125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="247.5" x2="874.5" y1="810.125" y2="810.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="259.5" y="805.0591">Poll Card Detection Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="178" x="456.5" y="805.0591">90-00 with DFA108 = 00</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="634.5" y="805.0591">)</text><path d="M880,851.125 L880,876.125 L1052,876.125 L1052,861.125 L1042,851.125 L880,851.125 " fill="#FBFB77" filter="url(#f3g52cduqnsqf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1042,851.125 L1042,861.125 L1052,861.125 L1042,851.125 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="886" y="868.1919">Customer card inserted</text><polygon fill="#A80036" points="863.5,902.3906,873.5,906.3906,863.5,910.3906,867.5,906.3906" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242.5" x2="869.5" y1="906.3906" y2="906.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="249.5" y="901.3247">Poll Card Detection Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="451.5" y="901.3247">23-04</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="492.5" y="901.3247">)</text><polygon fill="#A80036" points="253.5,931.5234,243.5,935.5234,253.5,939.5234,249.5,935.5234" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="247.5" x2="874.5" y1="935.5234" y2="935.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="259.5" y="930.4575">Poll Card Detection Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="178" x="456.5" y="930.4575">90-00 with DFA108 = 01</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="634.5" y="930.4575">)</text><polygon fill="#A80036" points="863.5,960.6563,873.5,964.6563,863.5,968.6563,867.5,964.6563" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242.5" x2="869.5" y1="964.6563" y2="964.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="210" x="249.5" y="959.5903">Smart Card Activate Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="459.5" y="959.5903">41-02</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="500.5" y="959.5903">)</text><path d="M178,979.6563 L242,979.6563 L242,986.6563 L232,996.6563 L178,996.6563 L178,979.6563 " fill="#EEEEEE" style="stroke: #000000; stroke-width: 1.0;"/><rect fill="none" height="90.2031" style="stroke: #000000; stroke-width: 2.0;" width="752.5" x="178" y="979.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="19" x="193" y="992.7231">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="222" x="257" y="991.8667">[Chip card activation successfully]</text><polygon fill="#A80036" points="253.5,1013.9219,243.5,1017.9219,253.5,1021.9219,249.5,1017.9219" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="247.5" x2="874.5" y1="1017.9219" y2="1017.9219"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="259.5" y="1012.856">Smart Card Activate Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="90" x="464.5" y="1012.856">90-00 + ATR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="554.5" y="1012.856">)</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="178" x2="930.5" y1="1026.9219" y2="1026.9219"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="180" x="183" y="1037.1323">[Chip card activation failed]</text><polygon fill="#A80036" points="253.5,1057.8594,243.5,1061.8594,253.5,1065.8594,249.5,1061.8594" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="247.5" x2="874.5" y1="1061.8594" y2="1061.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="205" x="259.5" y="1056.7935">Smart Card Activate Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="464.5" y="1056.7935">94-03</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="505.5" y="1056.7935">)</text><line style="stroke: #000000; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="12" x2="1081" y1="1105.8594" y2="1105.8594"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="445" x="17" y="1116.0698">[Start Card Detection (23-03) with card technology msr enabled only]</text><polygon fill="#A80036" points="863.5,1136.7969,873.5,1140.7969,863.5,1144.7969,867.5,1140.7969" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242.5" x2="869.5" y1="1140.7969" y2="1140.7969"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="212" x="249.5" y="1135.731">Start Card Detection Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="208" x="461.5" y="1135.731">23-03 with tag DFA108 = 02</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="669.5" y="1135.731">)</text><polygon fill="#A80036" points="253.5,1165.9297,243.5,1169.9297,253.5,1173.9297,249.5,1169.9297" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="247.5" x2="874.5" y1="1169.9297" y2="1169.9297"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="207" x="259.5" y="1164.8638">Start Card Detection Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="466.5" y="1164.8638">90-00</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="507.5" y="1164.8638">)</text><polygon fill="#A80036" points="863.5,1195.0625,873.5,1199.0625,863.5,1203.0625,867.5,1199.0625" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242.5" x2="869.5" y1="1199.0625" y2="1199.0625"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="249.5" y="1193.9966">Poll Card Detection Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="451.5" y="1193.9966">23-04</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="492.5" y="1193.9966">)</text><polygon fill="#A80036" points="253.5,1224.1953,243.5,1228.1953,253.5,1232.1953,249.5,1228.1953" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="247.5" x2="874.5" y1="1228.1953" y2="1228.1953"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="259.5" y="1223.1294">Poll Card Detection Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="178" x="456.5" y="1223.1294">90-00 with DFA108 = 00</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="634.5" y="1223.1294">)</text><path d="M880,1269.1953 L880,1294.1953 L1052,1294.1953 L1052,1279.1953 L1042,1269.1953 L880,1269.1953 " fill="#FBFB77" filter="url(#f3g52cduqnsqf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1042,1269.1953 L1042,1279.1953 L1052,1279.1953 L1042,1269.1953 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="151" x="886" y="1286.2622">Customer card inserted</text><polygon fill="#A80036" points="253.5,1320.4609,243.5,1324.4609,253.5,1328.4609,249.5,1324.4609" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="247.5" x2="874.5" y1="1324.4609" y2="1324.4609"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="155" x="259.5" y="1319.395">Card Removal Callback (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="414.5" y="1319.395">9E-04</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="455.5" y="1319.395">)</text><path d="M32,1337.4609 L32,1377.4609 L233,1377.4609 L233,1347.4609 L223,1337.4609 L32,1337.4609 " fill="#FBFB77" filter="url(#f3g52cduqnsqf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M223,1337.4609 L223,1347.4609 L233,1347.4609 L223,1337.4609 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="176" x="38" y="1354.5278">Payment application should</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="129" x="38" y="1369.6606">display remove card</text><path d="M880,1419.7266 L880,1444.7266 L1057,1444.7266 L1057,1429.7266 L1047,1419.7266 L880,1419.7266 " fill="#FBFB77" filter="url(#f3g52cduqnsqf)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1047,1419.7266 L1047,1429.7266 L1057,1429.7266 L1047,1419.7266 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="156" x="886" y="1436.7935">Customer card removed</text><polygon fill="#A80036" points="863.5,1470.9922,873.5,1474.9922,863.5,1478.9922,867.5,1474.9922" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="242.5" x2="869.5" y1="1474.9922" y2="1474.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="202" x="249.5" y="1469.9263">Poll Card Detection Command (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="41" x="451.5" y="1469.9263">23-04</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="492.5" y="1469.9263">)</text><polygon fill="#A80036" points="253.5,1500.125,243.5,1504.125,253.5,1508.125,249.5,1504.125" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="247.5" x2="874.5" y1="1504.125" y2="1504.125"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="197" x="259.5" y="1499.0591">Poll Card Detection Response (</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="407" x="456.5" y="1499.0591">90-00 with tag DFA108 = 02 and obfuscated card data</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="5" x="863.5" y="1499.0591">)</text><!--
@startuml

title SDI: Hybrid Cardreader Asynchronous Card Detection (23-03) scenarios (polling mode)

participant "Payment App" order 10
participant "SDI-Server" order 20

alt Start Card Detection (23-03) with card technology chip and msr enabled
  "Payment App" -> "SDI-Server": Start Card Detection Command (<b>23-03 with tag DFA108 = 03</b>)
  "SDI-Server" - -> "Payment App": Start Card Detection Response (<b>90-00</b>)
  "Payment App" -> "SDI-Server": Poll Card Detection Command (<b>23-04</b>)
  "SDI-Server" - -> "Payment App": Poll Card Detection Response (<b>90-00 with DFA108 = 00</b>) 
  ...
  note right of "SDI-Server": Customer card inserted  
  "Payment App" -> "SDI-Server": Poll Card Detection Command (<b>23-04</b>)
  "SDI-Server" - -> "Payment App": Poll Card Detection Response (<b>90-00 with DFA108 = 01</b>) 
  "Payment App" -> "SDI-Server": Smart Card Activate Command (<b>41-02</b>)

  alt Chip card activation successfully
    "SDI-Server" - -> "Payment App": Smart Card Activate Response (<b>90-00 + ATR</b>)
  else Chip card activation failed
    "SDI-Server" - -> "Payment App": Smart Card Activate Response (<b>94-03</b>)
    "Payment App" -> "SDI-Server":  MSR Read Command (<b>21-01</b>)
    "SDI-Server" -> "Payment App":  Card Removal Callback (<b>9E-04</b>)
    note left of "Payment App" 
    Payment application should 
    display remove card
    end note 
    note right of "SDI-Server": Customer card removed
    "SDI-Server" - -> "Payment App": MSR Read Response (<b>90-00 with obfuscated data</b>)
  end
  ...
else Start Card Detection (23-03) with card technology chip enabled only
  "Payment App" -> "SDI-Server": Start Card Detection Command (<b>23-03 with tag DFA108 = 01</b>)
  "SDI-Server" - -> "Payment App": Start Card Detection Response (<b>90-00</b>)
  "Payment App" -> "SDI-Server": Poll Card Detection Command (<b>23-04</b>)
  "SDI-Server" - -> "Payment App": Poll Card Detection Response (<b>90-00 with DFA108 = 00</b>) 
  ...
    note right of "SDI-Server": Customer card inserted  
  "Payment App" -> "SDI-Server": Poll Card Detection Command (<b>23-04</b>)
  "SDI-Server" - -> "Payment App": Poll Card Detection Response (<b>90-00 with DFA108 = 01</b>) 
  "Payment App" -> "SDI-Server": Smart Card Activate Command (<b>41-02</b>)

  alt Chip card activation successfully
    "SDI-Server" - -> "Payment App": Smart Card Activate Response (<b>90-00 + ATR</b>)
  else Chip card activation failed
    "SDI-Server" - -> "Payment App": Smart Card Activate Response (<b>94-03</b>)
  end
  ...
else Start Card Detection (23-03) with card technology msr enabled only
  "Payment App" -> "SDI-Server": Start Card Detection Command (<b>23-03 with tag DFA108 = 02</b>)
  "SDI-Server" - -> "Payment App": Start Card Detection Response (<b>90-00</b>)
  "Payment App" -> "SDI-Server": Poll Card Detection Command (<b>23-04</b>)
  "SDI-Server" - -> "Payment App": Poll Card Detection Response (<b>90-00 with DFA108 = 00</b>) 
  ...
  note right of "SDI-Server": Customer card inserted
  "SDI-Server" -> "Payment App":  Card Removal Callback (<b>9E-04</b>)
  note left of "Payment App"
    Payment application should 
    display remove card
  end note 
  ... 
  note right of "SDI-Server": Customer card removed
  "Payment App" -> "SDI-Server": Poll Card Detection Command (<b>23-04</b>)
  "SDI-Server" - -> "Payment App": Poll Card Detection Response (<b>90-00 with tag DFA108 = 02 and obfuscated card data</b>) 
  ...
end

@enduml

PlantUML version 1.2019.03(Sun Mar 10 04:04:44 PDT 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 17.0.14+7-Ubuntu-120.04
Operating System: Linux
OS Version: 5.15.0-1082-azure
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>